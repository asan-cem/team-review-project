# 협업 후기 분석 결과 컬럼별 데이터 산출 공식 설명서

## 📋 개요
본 문서는 협업 후기 텍스트 분석 시스템에서 생성되는 각 컬럼의 데이터가 어떻게 계산되고 산출되는지를 비개발자도 이해할 수 있도록 상세히 설명합니다.

---

## 🛠️ 사용된 기술 및 도구

### 1. **Google Vertex AI - Gemini 2.0 Flash 모델**
- **역할**: 텍스트의 의미를 이해하고 감정, 키워드, 분류 등을 분석
- **특징**: 한국어 자연어 처리에 특화된 최신 AI 모델
- **동작 방식**: 사람이 텍스트를 읽고 이해하는 것처럼 AI가 문맥을 파악하여 분석

### 2. **Python 프로그래밍**
- **pandas**: 엑셀 데이터 처리 및 분석
- **ThreadPoolExecutor**: 여러 텍스트를 동시에 분석하여 처리 속도 향상
- **정규표현식**: 텍스트 패턴 인식 (실명, 호칭 등)

### 3. **통계적 검증 방법**
- **신뢰도 점수**: 분석 결과의 정확성을 수치로 평가
- **품질 검증**: 여러 기준으로 분석 결과의 타당성 검사

---

## 📊 컬럼별 데이터 산출 공식 및 설명

### 1. **협업 후기_감정분석 (감정 분류)**

#### 📌 **산출 방식**
```
AI 모델이 텍스트의 전체적인 감정 톤을 분석하여 3가지로 분류
```

#### 🔍 **분류 기준**
- **긍정**: 칭찬, 감사, 만족, 좋은 평가가 포함된 텍스트
- **부정**: 불만, 비판, 아쉬움, 개선 요구가 포함된 텍스트  
- **중립**: 단순 사실 서술, 감정적 색채가 약한 텍스트

#### 💡 **예시**
- "항상 친절하게 도움주셔서 감사합니다" → **긍정**
- "업무 처리가 너무 느려서 답답합니다" → **부정**
- "월요일에 회의가 있었습니다" → **중립**

---

### 2. **협업 후기_감정강도 (감정 강도)**

#### 📌 **산출 방식**
```
감정의 강한 정도를 1~10점 척도로 수치화
(1점: 매우 약함 ↔ 10점: 매우 강함)
```

#### 🔍 **계산 기준**
- **1-3점**: 미미한 감정 표현 ("조금 아쉽다", "괜찮다")
- **4-6점**: 보통 수준의 감정 표현 ("만족한다", "불편하다")  
- **7-8점**: 강한 감정 표현 ("매우 감사하다", "상당히 답답하다")
- **9-10점**: 극도로 강한 감정 표현 ("너무 화가 난다", "정말 훌륭하다")

#### 💡 **예시**
- "도움이 되었습니다" → **강도 5점**
- "정말 친절하셔서 감사합니다!" → **강도 8점**
- "완전히 실망했습니다" → **강도 9점**

---

### 3. **협업 후기_AI신뢰도 (AI 분석 신뢰도)**

#### 📌 **산출 방식**
```
AI가 자신의 분석 결과에 대해 얼마나 확신하는지를 1~10점으로 평가
(1점: 확신 없음 ↔ 10점: 매우 확신)
```

#### 🔍 **신뢰도 결정 요인**
- **텍스트 명확성**: 의미가 분명할수록 높은 점수
- **문맥 일관성**: 앞뒤 내용이 일치할수록 높은 점수
- **감정 표현 강도**: 감정이 명확할수록 높은 점수
- **언어 품질**: 문법적으로 올바를수록 높은 점수

#### 💡 **예시**
- "업무가 빨라서 좋습니다" → **신뢰도 9점** (명확한 표현)
- "뭔가 애매하고 그런 느낌?" → **신뢰도 3점** (모호한 표현)

---

### 4. **협업 후기_핵심키워드 (핵심 키워드)**

#### 📌 **산출 방식**
```
AI가 텍스트에서 가장 중요한 단어들을 3-5개 추출
한국어 불용어(조사, 접속사 등) 자동 제거
```

#### 🔍 **추출 기준**
- **명사 우선**: 구체적인 사물, 개념, 행동
- **감정 표현어**: 긍정/부정 감정을 나타내는 단어
- **업무 관련어**: 협업, 소통, 전문성 등 업무 맥락의 단어
- **빈도 및 중요도**: 텍스트에서 핵심적 역할을 하는 단어

#### 💡 **예시**
- "검사 일정 조정해주셔서 감사합니다" → **키워드**: ["검사", "일정", "조정", "감사"]
- "소통이 잘 안되어 답답합니다" → **키워드**: ["소통", "답답", "문제"]

---

### 5. **협업 후기_분류라벨 (분류 라벨)**

#### 📌 **산출 방식**
```
텍스트 내용을 5가지 협업 문제 유형으로 자동 분류
하나의 텍스트가 여러 라벨에 동시 해당 가능
```

#### 🔍 **분류 체계**
1. **"부서간 협업"**: 서로 다른 부서/팀 간의 업무 연계 문제
2. **"직원간 소통"**: 같은 부서/팀 내 동료 간의 소통 및 관계 문제  
3. **"전문성 부족"**: 개인의 업무 지식, 기술, 경험 부족 문제
4. **"업무 태도"**: 책임감, 적극성 등 업무를 대하는 자세 문제
5. **"상호 존중"**: 인격적 대우, 배려 등 관계에서의 예의 문제

#### 💡 **예시**
- "다른 팀과 연락이 안 됩니다" → **라벨**: ["부서간 협업"]
- "불친절하고 업무도 느려요" → **라벨**: ["상호 존중", "전문성 부족"]

---

### 6. **협업 후기_품질점수 (품질 점수)**

#### 📌 **산출 방식**
```
기본 신뢰도 점수에서 품질 문제 발견 시 점수 차감
최종 점수 = confidence_score - (품질 문제별 감점)
```

#### 🔍 **품질 검증 항목 및 감점**
1. **필수 필드 누락** → **-3점**
   - 감정, 강도, 라벨 등 주요 분석 결과 누락
   
2. **감정-강도 불일치** → **-2점**
   - 긍정 감정인데 강도가 낮거나, 부정 감정인데 강도가 높은 경우
   
3. **텍스트 길이 이상** → **-1~2점**
   - 정제된 텍스트가 너무 짧거나 너무 긴 경우
   
4. **키워드 추출 실패** → **-2점**
   - 의미있는 텍스트임에도 키워드가 추출되지 않은 경우
   
5. **비식별 처리 불완전** → **-3점**
   - 실명 제거가 필요한데 남아있는 경우

#### 💡 **최종 점수 범위**: 1~10점 (1점: 낮은 품질 ↔ 10점: 높은 품질)

---

### 7. **협업 후기_재검토필요 (재검토 필요 여부)**

#### 📌 **산출 방식**
```
if (품질점수 < 6점) 또는 (품질문제 개수 > 2개):
    needs_review = True
else:
    needs_review = False
```

#### 🔍 **재검토 기준**
- **품질 점수 6점 미만**: 분석 결과의 신뢰성이 떨어짐
- **품질 문제 3개 이상**: 여러 문제가 동시 발견됨

#### 💡 **활용 방안**
- `True`: 수동 검토 또는 재분석 필요
- `False`: 분석 결과 신뢰 가능

---

### 8. **협업 후기_품질문제 (품질 문제 목록)**

#### 📌 **산출 방식**
```
품질 검증 과정에서 발견된 모든 문제점을 텍스트로 나열
각 문제는 쉼표(,)로 구분하여 저장
```

#### 🔍 **기록되는 문제 유형**
- "감정 강도 불일치"
- "정제된 텍스트가 너무 짧음"  
- "정제된 텍스트가 너무 김"
- "키워드 추출 실패"
- "비식별 처리 불완전 - 실명 잔존"

#### 💡 **예시**
- 문제 없음: `""` (빈 문자열)
- 문제 있음: `"감정 강도 불일치, 키워드 추출 실패"`

---

## 🔄 전체 처리 흐름

```
1. 원본 텍스트 입력
   ↓
2. AI 모델 분석 (Gemini 2.0 Flash)
   ↓  
3. 8개 컬럼 데이터 생성
   ↓
4. 품질 검증 및 점수 계산
   ↓
5. 재검토 필요시 재분석
   ↓
6. 최종 결과 엑셀 저장
```

---

## 📈 데이터 활용 가이드

### **고품질 데이터 기준**
- `품질점수 >= 7점`
- `재검토필요 = False`
- `품질문제 = ""`

### **주의 깊게 검토할 데이터**
- `품질점수 < 6점`
- `재검토필요 = True`
- `품질문제`에 여러 문제 기록

### **감정 분석 신뢰도**
- `AI신뢰도 >= 8점`: 매우 신뢰할만함
- `AI신뢰도 5-7점`: 보통 수준
- `AI신뢰도 < 5점`: 추가 검토 권장

---

## ⚙️ 기술적 특징

### **배치 처리 시스템**
- 한 번에 10개씩 그룹으로 나누어 처리
- ThreadPoolExecutor로 병렬 처리하여 속도 향상 (약 90배 빨라짐)
- 데이터 순서 보장으로 원본-결과 정확한 매칭

### **품질 보증 시스템**  
- 2단계 품질 검증 (AI 신뢰도 + 시스템 검증)
- 자동 재분석으로 품질 개선
- 다중 검증 기준으로 데이터 신뢰성 확보

### **한국어 특화 처리**
- 한국어 실명 패턴 인식
- 한국어 불용어 제거
- 한국 직장 문화 맥락 반영
- 서울아산병원 의료서비스업 맥락 특화 (의료진간 협업, 환자 서비스, 부서간 연계 등)

---

*이 설명서는 협업 후기 분석 시스템 v2.0을 기준으로 작성되었습니다.*
*문의사항이 있으시면 시스템 관리자에게 연락 바랍니다.*