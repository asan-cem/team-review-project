# 📁 **파일별 역할 및 사용법 요약**

## 🚀 **핵심 실행 파일 2개**

### **1️⃣ main.py - 데이터 분석 프로그램**
```python
🎯 목적: 원본 엑셀 데이터 → AI 분석 → 처리된 엑셀 데이터
📥 입력: 설문조사_전처리데이터_20250620_0731.xlsx
📤 출력: 설문조사_전처리데이터_20250620_0731_processed.xlsx
⏱️ 소요시간: 10-30분 (데이터 양에 따라)
🔧 사용법: python main.py
```

**주요 기능:**
- 📊 엑셀 데이터 로드 및 전처리
- 🤖 AI 감정 분석 (긍정/부정/중립)
- 🔍 핵심 키워드 추출
- 📈 감정 강도 점수 계산
- 💾 분석 결과를 새 엑셀 파일로 저장

**언제 사용하나요?**
- ✅ 새로운 설문조사 데이터를 받았을 때
- ✅ AI 분석이 처음 필요할 때
- ✅ 기존 데이터에 새로운 분석을 추가할 때

---

### **2️⃣ build_dashboard_html_improved.py - 대시보드 생성 프로그램**
```python
🎯 목적: 처리된 엑셀 데이터 → 인터랙티브 웹 대시보드
📥 입력: 설문조사_전처리데이터_20250620_0731_processed.xlsx
📤 출력: 서울아산병원 협업평가 대시보드.html
⏱️ 소요시간: 10-15초
🔧 사용법: python build_dashboard_html_improved.py
```

**주요 기능:**
- 📊 다양한 시각화 차트 생성
- 🔄 인터랙티브 필터링 기능
- 📈 연도별, 부문별, 부서별 분석
- 🎨 반응형 웹 디자인
- 🔒 보안 강화 및 에러 처리

**언제 사용하나요?**
- ✅ 웹 브라우저에서 볼 수 있는 시각화가 필요할 때
- ✅ 프레젠테이션용 자료를 만들 때
- ✅ 상호작용 가능한 차트가 필요할 때

---

## 📋 **완전한 작업 순서**

### **🔄 일반적인 워크플로우**

```mermaid
graph LR
    A[새 엑셀 데이터] --> B[main.py 실행]
    B --> C[AI 분석 완료]
    C --> D[processed 파일 생성]
    D --> E[대시보드 생성 실행]
    E --> F[HTML 대시보드 완성]
```

#### **단계별 상세 설명:**

**1단계: 데이터 준비**
```bash
# 새 엑셀 파일을 프로젝트 폴더에 위치
설문조사_전처리데이터_YYYYMMDD_HHMM.xlsx
```

**2단계: AI 분석 실행**
```bash
python main.py
# 또는 더블클릭으로 실행
```
- 💡 **소요시간**: 10-30분
- 🔍 **확인사항**: `_processed.xlsx` 파일 생성 여부

**3단계: 대시보드 생성**
```bash
python build_dashboard_html_improved.py
# 또는 편의 스크립트 사용
./build_dashboard.sh
```
- 💡 **소요시간**: 10-15초
- 🔍 **확인사항**: `.html` 파일 생성 여부

**4단계: 결과 확인**
```bash
# 웹 브라우저에서 HTML 파일 열기
서울아산병원 협업평가 대시보드.html
```

---

## 🆚 **두 대시보드 버전 비교**

### **build_dashboard_html.py (기존 버전)**
```python
✅ 장점:
- 단일 파일로 간단
- 빠른 실행
- 검증된 안정성

❌ 단점:
- 1,144줄의 거대한 파일
- 보안 취약점
- 에러 디버깅 어려움
- 수정/확장 어려움
```

### **build_dashboard_html_improved.py (개선된 버전) ⭐ 권장**
```python
✅ 장점:
- 모듈화된 구조
- 보안 강화 (XSS 방지)
- 상세한 에러 처리
- 로깅 및 디버깅 지원
- 성능 최적화
- 테스트 코드 포함

❌ 단점:
- 여러 파일 관리 필요
- 약간의 학습 곡선
```

**🎯 권장사항**: 개선된 버전을 기본으로 사용하되, 문제 발생시 기존 버전을 백업으로 활용

---

## 🎛️ **편의 도구들**

### **build_dashboard.sh - 대화형 실행 스크립트**
```bash
🎯 목적: 사용자 친화적인 대시보드 생성
🔧 사용법: ./build_dashboard.sh (더블클릭 또는 터미널)

메뉴 옵션:
1) 기존 버전 (빠름)
2) 개선된 버전 (권장)
3) 개선된 버전 + 상세 로그
4) 두 버전 성능 비교
```

---

## 🗂️ **지원 파일들 (자동 동작)**

### **🔧 모듈 파일들**
| 파일명 | 역할 | 수정 필요성 |
|--------|------|-------------|
| `dashboard_config.py` | 설정 및 상수 관리 | 🟡 때때로 |
| `data_processor.py` | 데이터 처리 로직 | 🔴 없음 |
| `dashboard_templates.py` | HTML 템플릿 | 🔴 없음 |
| `dashboard_styles.py` | CSS 스타일 | 🟡 때때로 |
| `dashboard_javascript.py` | JavaScript 코드 | 🔴 없음 |
| `security_utils.py` | 보안 기능 | 🔴 없음 |
| `dashboard_builder.py` | 메인 빌더 | 🔴 없음 |

**🔴 없음**: 건드리지 마세요  
**🟡 때때로**: 설정 변경시에만 수정

### **📊 데이터 파일들**
| 파일명 | 타입 | 역할 |
|--------|------|------|
| `설문조사_전처리데이터_*.xlsx` | 입력 | 원본 설문 데이터 |
| `설문조사_전처리데이터_*_processed.xlsx` | 출력 | AI 분석 완료 데이터 |
| `서울아산병원 협업평가 대시보드.html` | 출력 | 웹 대시보드 |
| `상호평가_요약_*.xlsx` | 출력 | 요약 보고서 |

---

## 🎯 **시나리오별 사용법**

### **📊 정기 보고서 작성**
```bash
# 매월 첫째 주 작업
1. 새 데이터 파일 준비
2. python main.py
3. python build_dashboard_html_improved.py
4. HTML 파일을 관련자들에게 공유
```

### **🔍 특정 부서 분석**
```bash
# dashboard_config.py에서 필터 설정 후
python build_dashboard_html_improved.py --verbose
```

### **🚨 긴급 분석**
```bash
# 빠른 대시보드만 필요할 때
python build_dashboard_html.py  # 기존 버전 사용
```

### **🔧 문제 해결**
```bash
# 상세 로그와 함께 실행
python build_dashboard_html_improved.py --verbose
python test_improved_dashboard.py  # 테스트 실행
```

---

## 📞 **도움이 필요할 때**

### **🆘 즉시 연락이 필요한 상황**
- 프로그램이 완전히 실행되지 않을 때
- 중요한 데이터가 손실된 것 같을 때
- 마감 직전에 문제가 발생했을 때

### **📋 일반적인 질문**
- 새로운 기능 추가 요청
- 차트 디자인 변경 요청
- 성능 개선 요청

### **🔍 자가 진단 체크리스트**
```
□ 인터넷 연결이 안정적인가?
□ 파일명이 올바른가?
□ 다른 프로그램에서 파일을 사용 중이 아닌가?
□ 충분한 디스크 공간이 있는가?
□ 로그 파일에서 구체적인 에러 메시지를 확인했는가?
```

---

## 🏆 **마스터 체크리스트**

### **✅ 일일 작업 체크리스트**
```
□ 1. 새 데이터 파일 확인
□ 2. main.py 실행 (10-30분 대기)
□ 3. _processed.xlsx 파일 생성 확인
□ 4. 대시보드 생성 실행
□ 5. HTML 파일 웹브라우저에서 확인
□ 6. 결과 파일 백업 또는 공유
```

### **✅ 주간 관리 체크리스트**
```
□ 1. 기존 결과 파일들 정리/보관
□ 2. 로그 파일 크기 확인
□ 3. 시스템 성능 체크
□ 4. 새로운 요구사항 확인
```

### **✅ 월간 점검 체크리스트**
```
□ 1. 전체 파일 백업
□ 2. 프로그램 업데이트 확인
□ 3. 설정 파일 검토
□ 4. 성능 개선 사항 논의
```

---

**🎉 이 요약서를 참고하시면 각 파일의 역할을 명확히 구분하여 효율적으로 작업하실 수 있습니다!**