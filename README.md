# 📊 협업 평가 분석 및 대시보드 프로젝트

> 이 문서는 조직 내 협업 피드백을 AI로 분석하고, 결과를 시각화하는 프로젝트의 전체적인 내용과 기술적 세부사항을 설명합니다.

---

## 1. 프로젝트 개요

### 목적
부서 간 협업 과정에서 발생하는 서술형 피드백 데이터를 정량적, 정성적으로 분석하여 조직의 협업 건강도를 진단하고, 데이터 기반의 개선 전략 수립을 지원합니다.

### 핵심 프로세스
1.  데이터 입력: '협업 후기'가 포함된 엑셀 파일
2.  AI 분석 (`main.py`): Google의 Gemini AI 모델을 활용하여 텍스트를 다차원적으로 분석
3.  데이터 출력: 분석 결과가 추가된 새로운 엑셀 파일 생성
4.  시각화 (`build_dashboard_html_v2.py`): 분석된 데이터를 기반으로 인터랙티브 HTML 대시보드 생성

---

## 2. Gemini AI 심층 분석 상세 설명

본 프로젝트의 핵심은 Google의 Gemini 모델을 활용한 심층 텍스트 분석입니다. AI는 단순히 긍정/부정을 판단하는 것을 넘어, 아래와 같이 총 7가지 차원으로 텍스트를 분석하여 입체적인 인사이트를 제공합니다. 이는 AI에게 제공하는 정교한 지시사항(Prompt)을 통해 이루어집니다.

### 분석 차원 1: 텍스트 정제 및 유효성 검증
-   목표: 분석 가치가 있는 텍스트만 선별하고, 원문의 의미를 보존하며 가독성을 높입니다.
-   수행 작업:
    -   의미 없는 텍스트 필터링: "없음", "해당 없음", "---" 등 분석 가치가 없는 내용은 빈 문자열로 처리하여 분석에서 제외합니다.
    -   오탈자 및 문법 교정: "돼요"를 "되요"로 잘못 쓴 경우처럼, 문맥에 맞는 올바른 맞춤법으로 자동 교정합니다.

### 분석 차원 2: 표현 순화 및 전문적 언어 변환
-   목표: 잠재적으로 공격적이거나 감정적인 표현을 객관적이고 건설적인 피드백으로 변환합니다.
-   수행 작업:
    -   "일처리가 너무 답답하고 짜증남" → "업무 처리 속도에 아쉬움이 있으며, 개선이 필요해 보입니다."
    -   이를 통해 피드백 수용도를 높이고, 개인에 대한 비난이 아닌 문제 자체에 집중하도록 유도합니다.

### 분석 차원 3: 지능형 비식별 처리 (Anonymization)
-   목표: 피드백의 구체성은 유지하되, 불필요한 개인정보 노출을 방지합니다.
-   수행 작업:
    -   부정적 피드백의 실명 처리: "김철수 팀장 때문에 힘들다"와 같이 부정적 내용에 실명이 포함된 경우, "담당자", "관리자" 등의 일반적인 직책으로 자동 변경합니다.
    -   긍정적 피드백의 실명 유지: "박영희 선생님 덕분에 잘 해결했다"와 같은 긍정적 피드백은 실명을 그대로 유지하여 칭찬의 효과를 보존합니다.

### 분석 차원 4: 다차원 감정 분석
-   목표: 피드백에 담긴 감정을 '긍정', '부정', '중립'의 세 가지 범주로 분류합니다.
-   수행 작업:
    -   단순 키워드 기반이 아닌, 문장 전체의 뉘앙스와 맥락을 종합적으로 이해하여 판단합니다.
    -   예: "나쁘지 않았어요"는 '부정'이 아닌 '중립' 또는 '긍정'으로 분류합니다.

### 분석 차원 5: 감정 강도 측정
-   목표: 감정이 얼마나 강한지를 1점에서 10점까지의 척도로 정량화합니다.
-   수행 작업:
    -   "괜찮은 협업이었다"는 5점, "정말 환상적인 협업이었습니다!"는 9점과 같이 감정의 세기를 수치로 표현합니다.
    -   이를 통해 어떤 피드백에 더 주목해야 할지 우선순위를 정할 수 있습니다.

### 분석 차원 6: 핵심 키워드 및 의료 협업 맥락 추출
-   목표: 피드백의 핵심 주제와 의료 현장의 특정 상황을 도출합니다.
-   수행 작업:
    -   핵심 키워드: "신속한 응답", "정확한 정보 공유" 등 핵심 내용을 3~5개의 키워드로 요약합니다.
    -   의료 협업 맥락: 피드백 내용이 '의료 서비스', '업무 효율', '존중/소통', '전문성' 중 어떤 영역에 해당하는지 분류하여, 문제의 발생 지점을 구체화합니다.

### 분석 차원 7: AI 분석 신뢰도 자가 평가
-   목표: AI가 자신의 분석 결과가 얼마나 신뢰할 만한지를 스스로 평가합니다.
-   수행 작업:
    -   AI는 위 6가지 분석을 완료한 후, 종합적인 신뢰도를 1점에서 10점 사이의 점수로 제시합니다.
    -   신뢰도 점수가 낮은 분석 결과는 담당자가 추가적으로 검토할 수 있도록 하여, AI의 잠재적 오류를 보완합니다.

---

## 3. 기술적 상세 설명

### Part 1: 데이터 처리 파이프라인 (`main.py`)
-   사용 라이브러리: `pandas`, `vertexai` (Google Cloud), `tqdm`, `openpyxl`
-   실행 환경: Python 3.x

-   프로세스 흐름:
    1.  엑셀 파일 로드: `pandas.read_excel()`을 사용하여 원본 데이터를 DataFrame으로 불러옵니다.
    2.  데이터 필터링: 분석할 '협업 후기' 컬럼에서 비어있거나 무의미한 셀을 사전 필터링하여 불필요한 AI API 호출을 최소화합니다.
    3.  AI 연동 및 분석:
        -   `vertexai.init()`로 Google Cloud 프로젝트에 연결합니다.
        -   `GenerativeModel("gemini-2.5-flash")`를 통해 최신 AI 모델을 지정합니다.
        -   각 텍스트에 대해 위 "심층 분석 상세 설명"에 명시된 지시사항(Prompt)을 포함하여 AI에 분석을 요청합니다.
    4.  병렬 처리 및 안정성:
        -   `ThreadPoolExecutor`를 사용하여 여러 텍스트를 동시에 분석하여 처리 속도를 향상시킵니다.
        -   API 요청량이 많아질 경우를 대비하여, 오류 발생 시 일정 시간 대기 후 재시도하는 로직(`지수 백오프`)이 포함되어 있습니다.
    5.  결과 통합 및 저장:
        -   AI로부터 받은 분석 결과(JSON 형식)를 파싱하여 DataFrame에 새로운 컬럼들('정제된_텍스트', '감정_분류' 등)로 추가합니다.
        -   `pandas.ExcelWriter`를 사용하여 최종 결과를 새로운 엑셀 파일로 저장합니다.

### Part 2: 인터랙티브 대시보드 생성 (`build_dashboard_html_v2.py`)
-   사용 라이브러리: `pandas`, `plotly`
-   실행 환경: Python 3.x

-   프로세스 흐름:
    1.  데이터 로드: `main.py`에서 생성된, 분석이 완료된 엑셀 파일을 `pandas`로 읽어옵니다.
    2.  데이터 가공:
        -   대시보드에 필요한 형태로 데이터를 집계하고 그룹화합니다. (예: 연도별/부문별 평균 점수 계산)
        -   필터링 및 상호작용에 사용될 데이터를 JSON 형식으로 변환하여 HTML 내에 삽입 준비를 합니다.
    3.  HTML 구조 생성:
        -   전체적인 레이아웃, 필터(드롭다운, 체크박스), 차트 영역 등을 포함하는 HTML 뼈대를 생성합니다.
        -   CSS를 사용하여 시각적 디자인(색상, 폰트, 간격 등)을 정의합니다.
    4.  차트 생성 및 인터랙션 구현:
        -   `plotly.express`와 `plotly.graph_objects`를 사용하여 막대 차트, 라인 차트 등을 생성합니다.
        -   모든 데이터와 차트 로직은 JavaScript 코드 내에 포함됩니다. 사용자가 웹 브라우저에서 필터를 변경하면, 별도의 서버 요청 없이 브라우저 내에서 즉시 차트�� 다시 그려집니다.
        -   이를 통해 빠르고 부드러운 사용자 경험을 제공하는 독립적인 HTML 파일 하나가 최종 결과물로 생성됩니다.

---

## 4. FAQ (자주 묻는 질문)

### 질문 1: 감정(긍정, 중립, 부정)은 어떤 원리로 분류되나요?
답변: Google의 고성능 AI(Gemini)를 활용합니다. AI에게 '긍정'은 기쁨, 감사, 신뢰 등을, '부정'은 분노, 실망 등을 의미한다고 구체적인 정의와 예시를 제공하여 학습시킵니다. AI는 이 기준에 따라 문장 전체의 맥락과 뉘앙스를 파악하여 감정을 분류하므로, 단순 키워드 검색보다 훨씬 정교합니다.

### 질문 2: 텍스트 정제는 어떤 기준으로 이루어지나요?
답변: AI가 오탈자 교정, 비공식적 표현 순화("짜증남" → "아쉬움") 등을 자동으로 수행합니다. 특히, 부정적인 피드백에 포함된 실명은 "담당자"와 같이 일반적인 표현으로 자동 변경하여 개인정보를 보호하고 문제 자체에 집중하게 만듭니다. "없음"과 같이 의미 없는 내용은 분석에서 자동 제외됩니다.

### 질문 3: 핵심 키워드는 어떻게 추출되나요?
답변: AI가 정제된 텍스트의 핵심 의미를 가장 잘 나타내는 단어나 구(句)를 3~5개 정도 자동으로 ��별합니다. 예를 들어, "업무 프로세스가 복잡했지만, 담당자께서 친절하게 설명해주셔서 잘 마칠 수 있었습니다." 라는 문장에서 '업무 프로세스', '친절한 설명', '성공적 마무리'와 같은 키워드를 추출합니다. 이를 통해 수백 개의 피드백을 빠르게 요약하여 파악할 수 있습니다.

### 질문 4: 분석을 위해 전달되는 데이터는 안전하게 관리되나요?
답변: 네, 안전하게 관리됩니다. 모든 데이터는 암호화된 보안 연결(HTTPS)을 통해 Google의 AI 서버로 전송됩니다. Google의 엔터프라이즈 개인정보 보호 정책에 따라, 분석을 위해 전송된 데이터는 해당 분석 요청을 처리하는 용도로만 사용되며 Google의 범용 AI 모델을 학습시키는 데 재사용되지 않습니다. 분석이 끝나면 데이터는 서버에 영구적으로 저장되지 않습니다.

### 질문 5: AI의 분석 결과를 100% 신뢰할 수 있나요?
답변: AI는 매우 높은 정확도를 보이지만 100% 완벽하지는 않습니다. 이를 보완하기 위해 저희는 'AI 분석 신뢰도 자가 평가'라는 안전장치를 마련했습니다. AI가 스스로 분석 결과가 애매하거나 복잡하다고 판단하면 '신뢰도 점수'를 낮게 매깁니다. 관리자는 이 점수를 기준으��� 신뢰도가 낮은 분석 결과만 선별하여 직접 검토하고 수정할 수 있어, 시스템의 전반적인 신뢰도를 높일 수 있습니다.

### 질문 6: 왜 엑셀 차트가 아닌 별도의 HTML 대시보드 파일을 사용하나요?
답변: HTML 대시보드는 '살아있는 보고서'이기 때문입니다. 엑셀 차트가 정적인 이미지인 반면, HTML 대시보드는 다음과 같은 장점이 있습니다.
-   인터랙티브 탐색: 사용자가 직접 연도, 부서, Unit 등 필터를 클릭하며 원하는 조건의 데이터를 즉시 확인할 수 있습니다.
-   드릴다운 분석: 차트의 특정 막대(예: '부정 키워드')를 클릭하면, 해당 키워드가 포함된 실제 후기 내용을 바로 조회할 수 있습니다.
-   쉬운 공유: 이메일이나 메신저로 HTML 파일 하나만 전달하면 누구나 웹 브라우저에서 동일한 보고서를 보고 상호작용할 수 있습니다. 별도의 프로그램 설치가 필요 없습니다.

### 질문 7: 분석을 실행하는 데 시간은 얼마나 걸리나요?
답변: 데이터 양에 따라 다르지만, 수천 건의 텍스트를 몇 시간씩 기다릴 필요 없이 수 분 내에 처리할 수 있도록 설계되었습니다. 기술적으로 여러 개의 텍스트를 동시에 분석하는 '병렬 처리' 방식을 사용하여 속도를 크게 향상시켰습니다. 분석이 완료된 후 대시보드에서 데이터를 탐색하는 것은 즉각적으로 반응합니다.

### 질문 8: 분석 기준(예: 감정 분류, 키워드)을 변경하거나 추가할 수 있나요?
답변: 네, 가능합니다. 이 시스템의 유연성은 AI에게 내리는 지시사항(Prompt)이 코드와 분리된 텍스트 형태로 관리된다는 점에서 나옵니다. 예를 들어, '의료 협업 맥락'에 '환자 안전'이라는 새로운 카테고리를 추가하고 싶다면, 복잡한 코드를 수정하는 대신 AI 지시사항 템플릿에 해당 내용을 추가하고 몇 가지 예시를 알려주면 됩니다. 따라서 변화하는 요구사항에 맞춰 비교적 쉽게 시스템을 업데이트할 수 있습니다.
