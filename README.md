# 📊 협업 후기 텍스트 분석 시스템

서울아산병원 직원 협업 후기를 AI로 분석하여 감정, 키워드, 품질 등을 자동으로 분류하는 시스템입니다.

## 🚀 빠른 시작 (3단계)

### 1단계: 환경 설정
```bash
# 가상환경 활성화
source activate_env.sh

# 필요한 패키지 설치 (이미 설치되어 있음)
pip install -r requirements.txt
```

### 2단계: 데이터 준비
- `설문조사_전처리데이터_20250620_0731.xlsx` 파일이 프로젝트 폴더에 있는지 확인
- Excel 파일에 `협업 후기` 컬럼이 있는지 확인

### 3단계: 분석 실행
```bash
python main.py
```

## 📁 주요 파일 설명

### 🔧 **핵심 실행 파일**
- **`main.py`** ⭐ - **메인 분석 프로그램** (이 파일만 실행하면 됩니다!)
- **`activate_env.sh`** - 가상환경 활성화 스크립트
- **`requirements.txt`** - 필요한 Python 패키지 목록

### 📊 **데이터 파일**
- **`설문조사_전처리데이터_20250620_0731.xlsx`** - 원본 설문조사 데이터
- **`설문조사_전처리데이터_20250620_0731_processed.xlsx`** - 분석 완료된 결과 파일

### 📖 **문서**
- **`컬럼별_데이터_산출_공식_설명서.md`** - 분석 결과 컬럼별 상세 설명
- **`README.md`** - 이 파일 (사용법 안내)

### 🔍 **검증 스크립트** (고급 사용자용)
- `verify_sequential.py` - 데이터 일치성 검증
- `analyze_mismatch.py` - 데이터 불일치 분석
- `final_verification.py` - 최종 품질 검증
- `check_inconsistency.py` - 일관성 체크
- `verify_fix.py` - 수정사항 검증

## 🎯 분석 결과 설명

### 생성되는 한국어 컬럼
분석 완료 후 Excel 파일에 다음 10개 컬럼이 추가됩니다:

1. **`협업 후기_정제텍스트`** - AI가 오타/문법 교정한 텍스트
2. **`협업 후기_비식별처리여부`** - 개인정보 제거 여부 (True/False)
3. **`협업 후기_감정분석`** - 감정 분류 (긍정/부정/중립)
4. **`협업 후기_감정강도`** - 감정의 강도 (1-10점)
5. **`협업 후기_AI신뢰도`** - AI 분석의 신뢰도 (1-10점)
6. **`협업 후기_핵심키워드`** - 추출된 주요 키워드들
7. **`협업 후기_분류라벨`** - 협업 문제 유형 분류
8. **`협업 후기_품질점수`** - 분석 품질 점수 (1-10점)
9. **`협업 후기_재검토필요`** - 재검토 필요 여부 (True/False)
10. **`협업 후기_품질문제`** - 발견된 품질 문제 내용

### 분류 체계
- **부서간 협업** - 서로 다른 부서/팀 간 협력 문제
- **직원간 소통** - 같은 부서/팀 내 소통 문제  
- **전문성 부족** - 개인의 업무 지식/기술 부족
- **업무 태도** - 책임감, 적극성 등 자세 문제
- **상호 존중** - 인격적 대우, 배려 등 예의 문제

## ⚙️ 시스템 설정

### 현재 설정값 (main.py 하단)
```python
INPUT_FILE = "설문조사_전처리데이터_20250620_0731.xlsx"
COLUMN_NAME = "협업 후기"
MAX_ROWS = 100          # 테스트용 (전체 분석 시 None으로 변경)
BATCH_SIZE = 3          # 동시 처리 개수
ENABLE_QUALITY_RETRY = True  # 품질 개선 재분석 활성화
```

### 전체 데이터 분석하려면
`main.py` 파일 하단의 `MAX_ROWS = 100`을 `MAX_ROWS = None`으로 변경

## 📈 분석 성능

- **처리 속도**: 100개 데이터 약 50초 (배치 처리)
- **품질 보장**: 2단계 품질 검증 + 자동 재분석
- **신뢰도**: 평균 7.4/10점의 높은 AI 신뢰도
- **정확도**: 데이터 순서 보장으로 100% 일치성

## 🆘 문제 해결

### 자주 발생하는 문제

1. **환경 활성화 실패**
   ```bash
   # 수동으로 가상환경 활성화
   source venv/bin/activate
   ```

2. **패키지 설치 오류**
   ```bash
   pip install --upgrade pip
   pip install -r requirements.txt
   ```

3. **Google Cloud 인증 오류**
   - Google Cloud 프로젝트 설정 확인
   - Vertex AI API 활성화 확인

4. **Excel 파일 오류**
   - 파일명과 경로 확인
   - `협업 후기` 컬럼 존재 여부 확인

### 데이터 검증이 필요할 때
```bash
# 데이터 일치성 검증
python verify_sequential.py

# 최종 품질 검증
python final_verification.py
```

## 🎯 사용 시나리오

### 신규 사용자 (처음 사용하는 경우)
1. `source activate_env.sh` - 환경 활성화
2. `python main.py` - 분석 실행 (테스트용 100개)
3. 결과 확인 후 전체 데이터 분석

### 정기 분석 (주기적 사용)
1. 새로운 Excel 파일을 프로젝트 폴더에 복사
2. `main.py`에서 파일명 수정
3. `python main.py` 실행

### 고급 사용자 (커스터마이징)
1. `main.py`에서 분석 설정 조정
2. 검증 스크립트로 품질 확인
3. 필요 시 `컬럼별_데이터_산출_공식_설명서.md` 참조

## 📞 지원

- **기술 문의**: 시스템 관리자에게 연락
- **분석 해석**: `컬럼별_데이터_산출_공식_설명서.md` 참조
- **문제 신고**: GitHub Issues 또는 관리자 연락

---

> 💡 **처음 사용자라면 `python main.py`만 실행하면 됩니다!**  
> 📊 **결과는 Excel 파일로 자동 저장됩니다.**  
> 🔍 **상세한 설명이 필요하면 `컬럼별_데이터_산출_공식_설명서.md`를 확인하세요.**