
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>서울아산병원 협업 평가 결과 보고</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #343a40; font-size: 16px;}
        .container { max-width: 1400px; margin: auto; padding: 20px; }
        .header { background: linear-gradient(90deg, #4a69bd, #6a89cc); color: white; padding: 25px; text-align: center; border-radius: 0 0 10px 10px; }
        
        /* 자동 번호 매기기 CSS */
        .container { counter-reset: section-counter; }
        .section { counter-reset: subsection-counter; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section h2::before { counter-increment: section-counter; content: counter(section-counter) ". "; color: #4a69bd; font-weight: bold; }
        .section h3::before { counter-increment: subsection-counter; content: counter(section-counter) "." counter(subsection-counter) " "; color: #6a89cc; font-weight: bold; }
        
        h1, h2, h3 { margin: 0; padding: 0; }
        h2 { color: #4a69bd; border-bottom: 3px solid #6a89cc; padding-bottom: 10px; margin-top: 20px; margin-bottom: 20px; }
        h3 { color: #555; margin-top: 30px; margin-bottom: 15px;}
        
        /* 파트 구분 스타일 */
        .part-divider { background: linear-gradient(90deg, #e9ecef, #6c757d, #e9ecef); height: 3px; margin: 40px 0; border-radius: 2px; }
        .part-title { text-align: center; color: #6c757d; font-size: 1.2em; font-weight: bold; margin: 30px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 5px solid #6a89cc; }
        
        .filters, .trend-filters { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-end; margin-bottom: 20px;}
        .filter-group { display: flex; flex-direction: column; }
        .filter-group label { margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        .filter-group select, .filter-group input { padding: 8px; border-radius: 5px; border: 1px solid #ced4da; min-width: 200px; }
        .expander-container { border: 1px solid #ced4da; border-radius: 5px; background-color: white; min-width: 200px; max-width: 280px; position: relative; }
        .expander-header { padding: 6px 8px; background-color: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 5px; user-select: none; font-size: 13px; }
        .expander-header:hover { background-color: #e9ecef; }
        .expander-arrow { transition: transform 0.3s ease; font-size: 11px; }
        .expander-arrow.expanded { transform: rotate(180deg); }
        .expander-content { padding: 4px; display: none; max-height: 200px; overflow-y: auto; position: absolute; top: 100%; left: 0; width: 100%; background-color: white; border: 1px solid #ced4da; border-top: none; border-radius: 0 0 5px 5px; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .expander-content.expanded { display: block; }
        .checkbox-item { display: flex; align-items: center; padding: 2px 0; height: auto; min-height: unset; }
        .checkbox-item input[type="checkbox"] { width: 16px; height: 16px; min-width: 16px; min-height: 16px; margin-right: 6px; box-sizing: border-box; }
        .checkbox-item:hover { background-color: #f8f9fa; }
        .checkbox-item label { cursor: pointer; font-weight: normal; font-size: 13px; line-height: 1.1; margin: 0; }
        #metrics-container { display: flex; gap: 30px; margin-top: 20px; text-align: center; justify-content: center; }
        .metric { background-color: #e9ecef; padding: 15px; border-radius: 8px; flex-grow: 1; }
        .metric-value { font-size: 2em; font-weight: bold; color: #4a69bd; }
        .metric-label { font-size: 0.9em; color: #6c757d; }
        #reviews-table-container, #keyword-reviews-table-container { max-height: 400px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #network-reviews-table-container { max-height: 300px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #reviews-table, #keyword-reviews-table, #network-reviews-table { width: 100%; border-collapse: collapse; }
        #reviews-table th, #reviews-table td, #keyword-reviews-table th, #keyword-reviews-table td, #network-reviews-table th, #network-reviews-table td { padding: 12px; border-bottom: 1px solid #dee2e6; text-align: left; }
        #reviews-table th, #keyword-reviews-table th, #network-reviews-table th { background-color: #f8f9fa; position: sticky; top: 0; }
        #reviews-table tr:last-child td, #keyword-reviews-table tr:last-child td, #network-reviews-table tr:last-child td { border-bottom: none; }
        .keyword-charts-container { display: flex; gap: 20px; }
        .keyword-chart { flex: 1; }
        
        /* 차트 컨테이너 스타일 */
        .chart-container { margin: 20px 0; }
        .subsection { margin: 30px 0; }
        
        /* 협업 빈도 차트 스크롤 컨테이너 */
        #collaboration-frequency-chart-container { max-height: 600px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px; }
        
    </style>
</head>
<body>
    <div class="header">
        <h1> 서울아산병원 협업 평가 결과 보고 - 디자인ㆍ콘텐츠팀 </h1>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">설문 데이터: 2022년 ~ 2025년 상반기(2025년 7월 9일 기준) </p>
    </div>
    
    <!-- 안내 문구 섹션 -->
    <div style="max-width: 1400px; margin: 20px auto; padding: 0 20px;">
        <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            
            <div style="margin-bottom: 15px;">
                <strong style="color: #495057;">📊 평가 문항 설명:</strong>
                <ul style="margin: 8px 0 0 20px; color: #6c757d; font-size: 0.95em; line-height: 1.4;">
                    <li><strong>존중배려:</strong> ○○은 타 부서의 입장을 존중하고 배려하여 협력해주며, 협업 관련 의견을 경청해준다.</li>
                    <li><strong>정보공유:</strong> ○○은 업무상 필요한 정보에 대해 공유가 잘 이루어진다.</li>
                    <li><strong>명확처리:</strong> ○○은 업무에 대한 명확한 담당자가 있고 업무를 일관성있게 처리해준다.</li>
                    <li><strong>태도개선:</strong> ○○은 이전보다 업무 협력에 대한 태도나 의지가 개선되고 있다.</li>
                    <li><strong>전반만족:</strong> 전반적으로 ○○과의 협업에 대해 만족한다.</li>
                </ul>
            </div>
            
            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 12px;">
                <strong style="color: #856404;">⚠️ 통계적 해석 주의사항:</strong>
                <span style="color: #856404; font-size: 0.95em;">응답건수(표본수)가 30건 미만인 경우 통계적 해석에 유의하시기 바랍니다.</span>
            </div>
            
        </div>
    </div>
    
    <div class="container">
        
        
        <div class="section">
            <h2>병원 전체 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="hospital-score-header" onclick="toggleExpander('hospital-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="hospital-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="hospital-score-expander">
                            <div id="hospital-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="hospital-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>

        <div class="section">
            <h2>부문별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="comparison-year-filter">연도 선택</label>
                    <select id="comparison-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label>부문 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="comparison-division-header" onclick="toggleExpander('comparison-division-expander')">
                            <span>부문 선택 (0개 선택됨)</span>
                            <span class="expander-arrow" id="comparison-division-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="comparison-division-expander">
                            <div id="comparison-division-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comparison-chart-container" class="chart-container"></div>
        </div>

        <div class="section">
            <h2>소속 부문 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="division-chart-filter">부문 선택</label>
                    <select id="division-chart-filter"></select>
                </div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="division-score-header" onclick="toggleExpander('division-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="division-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="division-score-expander">
                            <div id="division-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="division-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>소속 부문 팀별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="team-ranking-year-filter">연도 선택</label>
                    <select id="team-ranking-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="team-ranking-division-filter">부문 선택</label>
                    <select id="team-ranking-division-filter"></select>
                </div>
            </div>
            <div id="team-ranking-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>부서/Unit 결과</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group"><label for="year-filter">연도 (전체)</label><select id="year-filter"></select></div>
                <div class="filter-group"><label for="department-filter">부서</label><select id="department-filter"></select></div>
                <div class="filter-group"><label for="unit-filter">Unit</label><select id="unit-filter"></select></div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="drilldown-score-header" onclick="toggleExpander('drilldown-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="drilldown-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="drilldown-score-expander">
                            <div id="drilldown-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 5.1 부서/Unit 결과 -->
            <div class="subsection">
                <h3>부서/Unit 결과</h3>
                <div id="metrics-container"></div>
                <div id="yearly-comparison-chart-container" class="chart-container"></div>
                
            </div>
            
            <!-- 5.2 부서 내 Unit 결과 -->
            <div class="subsection">
                <h3>부서 내 Unit 결과</h3>
                <div id="unit-comparison-chart-container" class="chart-container"></div>
            </div>
            
            <!-- 5.3 감정 분석 -->
            <div class="subsection">
                <h3>평가 부서 의견</h3>
                <div id="sentiment-chart-container" class="chart-container"></div>
                
                <!-- 협업 후기 -->
                <div style="margin-top: 30px;">
                    <h4>협업 후기 <span id="reviews-count-display" style="color: #666; font-size: 0.9em;"></span></h4>
                    <div class="filters">
                        <div class="filter-group">
                            <label>감정 분류 필터</label>
                            <div class="expander-container">
                                <div class="expander-header" id="review-sentiment-header" onclick="toggleExpander('review-sentiment-expander')">
                                    <span>감정 선택 (4개 선택됨)</span>
                                    <span class="expander-arrow" id="review-sentiment-arrow">▼</span>
                                </div>
                                <div class="expander-content" id="review-sentiment-expander">
                                    <div id="review-sentiment-filter"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="reviews-table-container"><table id="reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody></tbody></table></div>
                </div>
            </div>

        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>다빈도 평가 부서</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group">
                    <label for="network-division-filter">연도 (전체)</label>
                    <select id="network-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-division-filter">부문</label>
                    <select id="network-division-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-department-filter">부서</label>
                    <select id="network-department-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-unit-filter">Unit</label>
                    <select id="network-unit-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="min-collaboration-filter">평가 횟수</label>
                    <select id="min-collaboration-filter">
                        <option value="5">5회 이상</option>
                        <option value="10" selected>10회 이상</option>
                        <option value="30">30회 이상</option>
                    </select>
                </div>
            </div>
            
            <div class="subsection">
                <div id="collaboration-frequency-chart-container" class="chart-container"></div>
            </div>


        </div>

    </div>
    <script>
        // 부서별 데이터 구조
        const hybridData = {"aggregated": {"hospital_yearly": {"2022": {"존중배려": 67.14276157345465, "정보공유": 67.33654876741693, "명확처리": 67.26182500334986, "태도개선": 66.87172246873739, "전반만족": 66.08169541382537, "종합점수": 66.9457064563561, "응답수": 7481}, "2023": {"존중배려": 69.83673131112216, "정보공유": 69.63634101841102, "명확처리": 69.98963085856491, "태도개선": 69.31004330446369, "전반만족": 68.76658374792703, "종합점수": 69.49223280861641, "응답수": 12070}, "2024": {"존중배려": 74.488649134637, "정보공유": 73.94310771306499, "명확처리": 74.12310286677909, "태도개선": 73.35440894207971, "전반만족": 73.21970975362808, "종합점수": 73.80928354856822, "응답수": 8905}, "2025": {"존중배려": 77.27624375148774, "정보공유": 76.88712942016907, "명확처리": 77.01954009293459, "태도개선": 76.21536072623029, "전반만족": 76.12433075550268, "종합점수": 76.67731985731272, "응답수": 8410}}, "division_yearly": {"커뮤니케이션실": {"2022": {"존중배려": 71.4, "정보공유": 71.2, "명확처리": 69.6, "태도개선": 68.75, "전반만족": 68.359375, "종합점수": 70.37109375, "응답수": 128}, "2023": {"존중배려": 71.69540229885058, "정보공유": 72.42857142857143, "명확처리": 70.85714285714286, "태도개선": 69.25287356321839, "전반만족": 69.71428571428571, "종합점수": 70.72857142857143, "응답수": 175}, "2024": {"존중배려": 75.3623188405797, "정보공유": 75.18115942028986, "명확처리": 76.81159420289855, "태도개선": 74.27007299270073, "전반만족": 74.27007299270073, "종합점수": 75.20528985507246, "응답수": 138}, "2025": {"존중배려": 79.52380952380952, "정보공유": 78.06603773584905, "명확처리": 78.73831775700934, "태도개선": 77.35849056603773, "전반만족": 76.6355140186916, "종합점수": 77.71420560747664, "응답수": 107}}}, "division_comparison": {"2022": {"진료부문": {"존중배려": 65.45150501672241, "정보공유": 67.07439678284182, "명확처리": 66.05527638190955, "태도개선": 66.2134944612286, "전반만족": 65.10538641686183, "종합점수": 65.96836789297659, "응답수": 2990}, "디지털정보혁신본부": {"존중배려": 71.14485981308411, "정보공유": 69.48356807511738, "명확처리": 71.36150234741784, "태도개선": 69.31279620853081, "전반만족": 68.83720930232558, "종합점수": 69.97674418604652, "응답수": 215}, "관리부문": {"존중배려": 71.23039806996381, "정보공유": 69.5166163141994, "명확처리": 70.14767932489451, "태도개선": 69.2506067961165, "전반만족": 69.17168674698796, "종합점수": 69.85550872968092, "응답수": 1661}, "커뮤니케이션실": {"존중배려": 71.4, "정보공유": 71.2, "명확처리": 69.6, "태도개선": 68.75, "전반만족": 68.359375, "종합점수": 70.37109375, "응답수": 128}, "간호부문": {"존중배려": 66.6626036079961, "정보공유": 66.58946855192589, "명확처리": 66.66259168704157, "태도개선": 66.6421568627451, "전반만족": 65.72403705509508, "종합점수": 66.46411994149196, "응답수": 2051}, "기타부문": {"존중배려": 51.94805194805195, "정보공유": 55.51948051948052, "명확처리": 56.65584415584416, "태도개선": 52.75974025974026, "전반만족": 51.298701298701296, "종합점수": 53.63636363636363, "응답수": 154}, "국제사업실": {"존중배려": 63.559322033898304, "정보공유": 62.28813559322034, "명확처리": 63.559322033898304, "태도개선": 62.28813559322034, "전반만족": 59.32203389830509, "종합점수": 62.20338983050848, "응답수": 59}, "교육부문": {"존중배려": 65.77380952380952, "정보공유": 65.47619047619048, "명확처리": 68.1547619047619, "태도개선": 66.96428571428571, "전반만족": 65.47619047619048, "종합점수": 66.36904761904762, "응답수": 84}, "기획부문": {"존중배려": 70.14925373134328, "정보공유": 69.02985074626865, "명확처리": 73.88059701492537, "태도개선": 69.31818181818181, "전반만족": 69.02985074626865, "종합점수": 70.3731343283582, "응답수": 67}, "연구부문": {"존중배려": 71.875, "정보공유": 66.31944444444444, "명확처리": 70.13888888888889, "태도개선": 67.36111111111111, "전반만족": 68.40277777777777, "종합점수": 68.81944444444444, "응답수": 72}}, "2023": {"진료부문": {"존중배려": 68.65744773519164, "정보공유": 69.7546346782988, "명확처리": 69.44323144104804, "태도개선": 68.85111499781372, "전반만족": 68.0525283347864, "종합점수": 68.94009799651568, "응답수": 4592}, "디지털정보혁신본부": {"존중배려": 77.82485875706215, "정보공유": 75.42372881355932, "명확처리": 75.28248587570621, "태도개선": 74.36079545454545, "전반만족": 75.14124293785311, "종합점수": 75.61440677966101, "응답수": 354}, "관리부문": {"존중배려": 72.31262327416174, "정보공유": 70.63465965143045, "명확처리": 71.5412421952021, "태도개선": 71.01221928665785, "전반만족": 70.81414473684211, "종합점수": 71.25054533508542, "응답수": 3044}, "커뮤니케이션실": {"존중배려": 71.69540229885058, "정보공유": 72.42857142857143, "명확처리": 70.85714285714286, "태도개선": 69.25287356321839, "전반만족": 69.71428571428571, "종합점수": 70.72857142857143, "응답수": 175}, "간호부문": {"존중배려": 69.25772539025168, "정보공유": 68.89738687061823, "명확처리": 69.48869066581715, "태도개선": 69.10166240409207, "전반만족": 68.24410452517527, "종합점수": 68.96868152866242, "응답수": 3140}, "기타부문": {"존중배려": 45.91346153846154, "정보공유": 51.08173076923077, "명확처리": 52.41545893719807, "태도개선": 47.68292682926829, "전반만족": 46.875, "종합점수": 48.71995192307692, "응답수": 208}, "국제사업실": {"존중배려": 68.05555555555556, "정보공유": 69.44444444444444, "명확처리": 68.88888888888889, "태도개선": 67.13483146067416, "전반만족": 66.38888888888889, "종합점수": 68.05555555555556, "응답수": 90}, "교육부문": {"존중배려": 77.64084507042253, "정보공유": 72.71126760563381, "명확처리": 75.52816901408451, "태도개선": 73.21428571428571, "전반만족": 75.17605633802818, "종합점수": 74.92957746478874, "응답수": 142}, "기획부문": {"존중배려": 68.97590361445783, "정보공유": 65.8132530120482, "명확처리": 69.42771084337349, "태도개선": 67.33128834355828, "전반만족": 66.41566265060241, "종합점수": 67.53012048192771, "응답수": 166}, "연구부문": {"존중배려": 74.37106918238993, "정보공유": 71.38364779874213, "명확처리": 72.32704402515724, "태도개선": 70.80645161290323, "전반만족": 72.0125786163522, "종합점수": 72.30345911949685, "응답수": 159}}, "2024": {"진료부문": {"존중배려": 73.48090277777777, "정보공유": 73.87811233352635, "명확처리": 73.28985507246377, "태도개선": 72.88160185722577, "전반만족": 72.57457283521576, "종합점수": 73.20710358796296, "응답수": 3456}, "디지털정보혁신본부": {"존중배려": 80.32646048109966, "정보공유": 80.58419243986255, "명확처리": 80.41237113402062, "태도개선": 79.89690721649484, "전반만족": 79.63917525773196, "종합점수": 80.17182130584193, "응답수": 291}, "관리부문": {"존중배려": 76.41147244805781, "정보공유": 74.47987336047038, "명확처리": 74.93231046931407, "태도개선": 73.9867941712204, "전반만족": 74.32034435885818, "종합점수": 74.82935047361298, "응답수": 2217}, "커뮤니케이션실": {"존중배려": 75.3623188405797, "정보공유": 75.18115942028986, "명확처리": 76.81159420289855, "태도개선": 74.27007299270073, "전반만족": 74.27007299270073, "종합점수": 75.20528985507246, "응답수": 138}, "간호부문": {"존중배려": 73.94793926247289, "정보공유": 73.02688638334779, "명확처리": 73.77493495229835, "태도개선": 73.23529411764706, "전반만족": 72.9419410745234, "종합점수": 73.33820701602424, "응답수": 2309}, "기타부문": {"존중배려": 58.40163934426229, "정보공유": 63.31967213114754, "명확처리": 64.13934426229508, "태도개선": 60.65573770491803, "전반만족": 59.42622950819672, "종합점수": 61.18852459016394, "응답수": 122}, "국제사업실": {"존중배려": 71.03174603174604, "정보공유": 72.22222222222223, "명확처리": 71.42857142857143, "태도개선": 68.65079365079364, "전반만족": 67.06349206349206, "종합점수": 70.07936507936508, "응답수": 63}, "교육부문": {"존중배려": 79.7872340425532, "정보공유": 78.72340425531915, "명확처리": 79.25531914893617, "태도개선": 78.72340425531915, "전반만족": 77.3936170212766, "종합점수": 78.77659574468085, "응답수": 94}, "기획부문": {"존중배려": 74.3801652892562, "정보공유": 71.90082644628099, "명확처리": 76.44628099173553, "태도개선": 70.83333333333333, "전반만족": 71.90082644628099, "종합점수": 73.14049586776859, "응답수": 121}, "연구부문": {"존중배려": 78.19148936170212, "정보공유": 76.59574468085107, "명확처리": 77.3936170212766, "태도개선": 74.73118279569893, "전반만족": 76.0752688172043, "종합점수": 76.48936170212765, "응답수": 94}}, "2025": {"진료부문": {"존중배려": 76.21971736204576, "정보공유": 76.94378996970717, "명확처리": 76.2041091276524, "태도개선": 75.70219966159053, "전반만족": 75.49646583641871, "종합점수": 76.11265388496467, "응답수": 2973}, "디지털정보혁신본부": {"존중배려": 79.75409836065573, "정보공유": 77.71381578947368, "명확처리": 78.60655737704919, "태도개선": 77.88778877887789, "전반만족": 77.95081967213115, "종합점수": 78.3264918032787, "응답수": 305}, "관리부문": {"존중배려": 79.58694659972615, "정보공유": 78.07498856881573, "명확처리": 78.49474645957058, "태도개선": 77.80192131747484, "전반만족": 77.92104062072113, "종합점수": 78.33732664233575, "응답수": 2192}, "커뮤니케이션실": {"존중배려": 79.52380952380952, "정보공유": 78.06603773584905, "명확처리": 78.73831775700934, "태도개선": 77.35849056603773, "전반만족": 76.6355140186916, "종합점수": 77.71420560747664, "응답수": 107}, "간호부문": {"존중배려": 76.66596814752724, "정보공유": 76.21491411813993, "명확처리": 76.83900798654896, "태도개선": 75.89360807401178, "전반만족": 75.76487845766974, "종합점수": 76.25802763819095, "응답수": 2388}, "기타부문": {"존중배려": 57.7319587628866, "정보공유": 60.45918367346939, "명확처리": 61.98979591836735, "태도개선": 58.41836734693877, "전반만족": 57.90816326530612, "종합점수": 59.2219387755102, "응답수": 98}, "국제사업실": {"존중배려": 75.71428571428571, "정보공유": 73.57142857142857, "명확처리": 73.92857142857143, "태도개선": 72.5, "전반만족": 71.42857142857143, "종합점수": 73.42857142857143, "응답수": 70}, "교육부문": {"존중배려": 82.17821782178218, "정보공유": 79.95049504950495, "명확처리": 82.17821782178218, "태도개선": 79.95049504950495, "전반만족": 80.44554455445545, "종합점수": 80.94059405940594, "응답수": 101}, "기획부문": {"존중배려": 75.26315789473684, "정보공유": 75.52631578947368, "명확처리": 75.52631578947368, "태도개선": 74.21875, "전반만족": 72.65625, "종합점수": 74.32291666666667, "응답수": 96}, "연구부문": {"존중배려": 80.3125, "정보공유": 78.4375, "명확처리": 80.3125, "태도개선": 76.26582278481013, "전반만족": 78.4375, "종합점수": 78.6875, "응답수": 80}}}, "team_ranking": {"2022": [{"department": "디자인ㆍ콘텐츠팀", "score": 79.3, "count": 24, "rank": 1}, {"department": "홍보팀", "score": 77.5, "count": 24, "rank": 2}, {"department": "고객만족팀", "score": 65.6, "count": 80, "rank": 3}], "2023": [{"department": "홍보팀", "score": 86.9, "count": 36, "rank": 1}, {"department": "디자인ㆍ콘텐츠팀", "score": 78.1, "count": 32, "rank": 2}, {"department": "고객만족팀", "score": 63.1, "count": 107, "rank": 3}], "2024": [{"department": "홍보팀", "score": 90.7, "count": 21, "rank": 1}, {"department": "디자인ㆍ콘텐츠팀", "score": 80.2, "count": 44, "rank": 2}, {"department": "고객만족팀", "score": 67.7, "count": 73, "rank": 3}], "2025": [{"department": "홍보팀", "score": 89.0, "count": 15, "rank": 1}, {"department": "디자인ㆍ콘텐츠팀", "score": 77.4, "count": 41, "rank": 2}, {"department": "고객만족팀", "score": 74.6, "count": 51, "rank": 3}]}, "metadata": {"calculation_date": "2025-07-22T09:31:00.405829", "total_responses": 36866, "target_department": "디자인ㆍ콘텐츠팀", "target_division": "커뮤니케이션실", "security_level": "AGGREGATED_ONLY"}}, "rawData": [{"설문시행연도": "2022", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "업무 지원 요청 절차가 표준화되어 있지 않아 직원마다 처리 방식이 다릅니다.", "감정_분류": "부정", "핵심_키워드": ["업무 절차", "표준화", "비일관성"]}, {"설문시행연도": "2022", "평가부서": "외과간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "친절하게 응대해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["친절", "응대", "감사"]}, {"설문시행연도": "2022", "평가부서": "시뮬레이션센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "빠른 업무 진행과 가이드를 제공해 주셔서 좋았습니다.", "감정_분류": "긍정", "핵심_키워드": ["업무 진행", "가이드", "신속", "협업"]}, {"설문시행연도": "2022", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 90.0, "정제된_텍스트": "의료인이 일러스트 및 교육 자료 개발을 담당하고 있어 의사소통에 매우 유리합니다.", "감정_분류": "긍정", "핵심_키워드": ["의료인", "교육 자료 개발", "의사소통", "협업"]}, {"설문시행연도": "2022", "평가부서": "외래간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "적극적인 지원 태도", "감정_분류": "긍정", "핵심_키워드": ["적극적", "지원", "태도"]}, {"설문시행연도": "2022", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 80.0, "정제된_텍스트": "만족스러움", "감정_분류": "긍정", "핵심_키워드": ["만족", "긍정적", "경험"]}, {"설문시행연도": "2022", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "늘 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["감사", "지속", "고마움"]}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "교육자료 개발 요청 시, 매우 적극적이고 창의적인 방법으로 결과물을 도출하여 많은 도움을 받았습니다.", "감정_분류": "긍정", "핵심_키워드": ["교육자료", "적극성", "창의성", "업무_도움", "결과물"]}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "암병원간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "업무 진행에 있어 유연성이 부족하며, 전반적인 이해도가 낮고, 협업에 대한 적극적인 태도가 부족합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 유연성", "업무 이해도", "협업 태도", "적극성"]}, {"설문시행연도": "2022", "평가부서": "영상의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "암병원간호1팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "신규 교육 자료를 높은 품질로 빠른 일정으로 제작해 주셔서 매우 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["교육자료", "품질", "일정", "감사"]}, {"설문시행연도": "2022", "평가부서": "재활의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 90.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 70.0, "정제된_텍스트": "교육 자료의 질은 우수했습니다. 다만, 임상 업무(환자 진료 등)로 바쁜 의뢰자의 일정 고려 없이 제작 부서의 일정에 맞춰 진행되는 경향이 있어 개선이 필요해 보였습니다. 또한, 원내에서 제작된 자료에 대한 정보가 해당 부서 직원에 의해 외부인에게 유출되는 사례가 있었습니다.", "감정_분류": "부정", "핵심_키워드": ["교육 자료", "일정 고려", "업무 효율", "정보 유출", "개선"]}, {"설문시행연도": "2022", "평가부서": "사회복지팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": null, "정보공유": null, "명확처리": null, "태도개선": null, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "사회복지팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": null, "정보공유": null, "명확처리": null, "태도개선": null, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "외래간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "너무 멋있게 제작해주시고 신속하게 처리하여 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["제작", "신속", "처리", "감사"]}, {"설문시행연도": "2022", "평가부서": "약제팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": null, "전반만족": 0.0, "종합점수": 37.5, "정제된_텍스트": "문의사항이 있어 전화 시도했으나 여러 번 통화에 실패했고, 어렵게 통화가 되었으나 상대방이 일방적으로 말을 끊고 전화를 종료했습니다. 다른 연락 수단(아산톡, 홈페이지 번호)으로도 연락을 시도했지만 실패했습니다. 해당 서비스 이용 시마다 좋지 않은 인상을 받게 됩니다.", "감정_분류": "부정", "핵심_키워드": ["통화", "연락", "소통", "서비스", "불만"]}, {"설문시행연도": "2022", "평가부서": "재활의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "일부 업무에서는 만족도가 높았으나, 특정 직원들의 존중과 배려가 부족한 태도로 인해 협업 요청에 어려움을 겪고 있습니다. 특히 '이전부터 그래왔다'거나 '왜 몰랐냐'는 식의 표현은 소통을 단절시키며, 이로 인해 전반적인 만족도가 저하되고 있습니다.", "감정_분류": "부정", "핵심_키워드": ["존중_소통", "협업", "만족도_저하", "업무_태도"]}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 25.0, "정제된_텍스트": "이용자를 배려하거나 고려하지 않고 담당자 위주로 업무를 처리했습니다. 존중하지 않는 언어 표현(반말 사용, 첫 및 끝인사 없는 메신저 대화 등)으로 인해 해당 담당자 및 부서와는 다시 협업하고 싶지 않습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 처리", "배려", "존중", "소통", "협업"]}, {"설문시행연도": "2023", "평가부서": "아카데미운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "덕분에 즐겁게 촬영 진행하였습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["촬영", "즐거움", "감사"]}, {"설문시행연도": "2023", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "동영상 제작 과정에서 아이디어, 촬영, 섭외, 시나리오 등 적극적으로 동참해 주셔서 너무 감사했습니다.", "감정_분류": "긍정", "핵심_키워드": ["동영상 제작", "적극적 참여", "협업", "감사"]}, {"설문시행연도": "2023", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 0.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 20.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "의학사진실 이송 시 시간이 지연되거나 누락되는 경우 병동 간호사에게 책임이 전가되는 상황이 발생합니다. 간호사들의 업무 부담으로 인해 개별적인 확인이 어려운 점을 감안하여, 서로의 업무를 이해하고 협력하는 것이 중요합니다. 또한, 이송 관련 문제 발생 시 환자나 보호자에게 직접 연락하는 방안을 고려하면 더욱 효과적일 것입니다.", "감정_분류": "부정", "핵심_키워드": ["환자 이송", "책임 전가", "업무 협력", "소통 개선"]}, {"설문시행연도": "2023", "평가부서": "영양팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "과거보다 자료 제작 시 오류가 잦아 여러 차례 교정을 해야 해서 어려움이 있었습니다.", "감정_분류": "부정", "핵심_키워드": ["자료 제작", "오류", "교정", "어려움"]}, {"설문시행연도": "2023", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "신속하고 정확하게 중간중간 상황을 공유해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["신속", "정확", "상황 공유", "감사"]}, {"설문시행연도": "2023", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "담당자의 불친절한 태도가 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["불친절", "태도", "소통"]}, {"설문시행연도": "2023", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "동영상 제작 시 의견이 신속하게 반영되어 좋았습니다. 다만, 안내문 제작 시 일반적인 디자인 수정 요청에 많은 시간이 소요되어 아쉬웠습니다.", "감정_분류": "부정", "핵심_키워드": ["의견 반영", "안내문 디자인", "시간 소요", "업무 효율"]}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "활발한 의사소통과 꼼꼼한 업무 진행을 통해 성공적인 협업의 결과물을 만들었습니다.", "감정_분류": "긍정", "핵심_키워드": ["의사소통", "업무 진행", "협업", "성공"]}, {"설문시행연도": "2023", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "아카데미운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["감사", "고마움", "긍정적"]}, {"설문시행연도": "2023", "평가부서": "건진운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "적극적인 협업을 위해 노력하여 주심에 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["협업", "노력", "감사"]}, {"설문시행연도": "2023", "평가부서": "AGS팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "교육자료 제작 시 정성스럽게 완성도 높게 만들어주려고 노력해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["교육자료", "정성", "완성도", "노력", "감사"]}, {"설문시행연도": "2023", "평가부서": "보안관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "화재 시 대피용품 착용법 동영상 제작과 올해 감염관리센터 특별훈련 시 뉴스 형태로 동영상 제작 협조.", "감정_분류": "중립", "핵심_키워드": ["동영상 제작", "감염관리", "훈련", "협조"]}, {"설문시행연도": "2023", "평가부서": "이노베이션디자인센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "멋진 영상 제작과 깔끔한 사진 촬영을 통해 업무가 원활하게 진행될 수 있도록 도와주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["영상 제작", "사진 촬영", "업무 효율", "감사"]}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 60.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "원하는 만큼의 촬영 장비나 시설 지원이 이루어지지 않아 아쉬웠으나, 부서의 불가피한 사정임을 이해합니다.", "감정_분류": "부정", "핵심_키워드": ["촬영 장비", "시설 지원", "업무 환경", "이해"]}, {"설문시행연도": "2023", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "암병원간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "업무를 빠르게 처리해주십니다.", "감정_분류": "긍정", "핵심_키워드": ["업무", "처리", "신속"]}, {"설문시행연도": "2023", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "암병원간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "콘텐츠팀이 배포하는 자료들이 날이 갈수록 질적으로 향상되고 있습니다.", "감정_분류": "긍정", "핵심_키워드": ["콘텐츠팀", "자료", "질적 향상", "배포"]}, {"설문시행연도": "2024", "평가부서": "건진운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "특수검사팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "의학 사진 촬영 관련 직원 간 커뮤니케이션 시 응대 태도가 좋지 못했습니다. CS 교육이 매우 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["응대 태도", "커뮤니케이션", "CS 교육", "의학 사진 촬영"]}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "많은 지원 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["지원", "감사"]}, {"설문시행연도": "2024", "평가부서": "시뮬레이션센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "1인 스튜디오의 스케줄 운영이 운영자 기준에 맞춰져 있어 사용자와의 조율이 어렵고 업무 운영에 융통성이 부족합니다.", "감정_분류": "부정", "핵심_키워드": ["스케줄 운영", "조율", "융통성", "업무 효율"]}, {"설문시행연도": "2024", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "많은 제약에도 개선 의지가 강하고 다른 부서와 협업 회의를 통해 빠른 결과를 도출함.", "감정_분류": "긍정", "핵심_키워드": ["개선의지", "협업", "빠른 결과", "업무 효율"]}, {"설문시행연도": "2024", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "건진운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "외래간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "메디게이션에 등재된 자료가 가끔 누락되는 경우가 있었으나, 담당자와의 빠른 소통으로 문제가 해결되어 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["메디게이션", "자료 누락", "담당자 소통", "문제 해결", "만족"]}, {"설문시행연도": "2024", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "정보보호실", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "내과간호1팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "적극적으로 협업해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["협업", "감사", "적극적"]}, {"설문시행연도": "2024", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 90.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "응급간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "정보보호실", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "원내외 인증과 홈페이지 모의해킹 등을 수행하는 데 있어 업무 담당자와의 소통이 원활하며, 빠른 처리에 항상 감사하게 생각하고 있습니다.", "감정_분류": "긍정", "핵심_키워드": ["소통", "업무 효율", "인증", "모의해킹", "감사"]}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "협업이 잘 되어 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["협업", "만족"]}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "방사선종양팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "부서 메디게이션 제작에 도움주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["메디게이션 제작", "도움", "감사", "협업"]}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "담당자별로 업무 진행의 일관성이 부족합니다.", "감정_분류": "부정", "핵심_키워드": ["담당자", "업무 진행", "일관성 부족"]}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "자리를 자주 비우고, 업무 진행이 수동적입니다.", "감정_분류": "부정", "핵심_키워드": ["자리 비움", "수동적 업무", "업무 효율"]}, {"설문시행연도": "2024", "평가부서": "인사팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "타이트한 시간 일정 요청에도 협력해주시고 도움 주셔서 감사했습니다.", "감정_분류": "긍정", "핵심_키워드": ["협력", "도움", "감사", "일정"]}, {"설문시행연도": "2024", "평가부서": "AGS팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "핵의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "재활의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "다양한 유인물 제작에 적극적으로 도와주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["유인물 제작", "적극적", "도움", "감사"]}, {"설문시행연도": "2024", "평가부서": "총무팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "보안관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 50.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "내원객 안내와 관련하여 사이니지 제작 등 여러 차례 도움을 주셨습니다. 항상 많은 도움을 주셔서 정말로 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["내원객 안내", "사이니지 제작", "도움", "감사"]}, {"설문시행연도": "2024", "평가부서": "국제교류팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "이노베이션디자인센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "IT서비스팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "여러 방면으로 자주 연락드리고 많이 요청드렸는데도, 싫은 내색 없이 적극적으로 응대해 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["적극적", "응대", "소통", "감사", "협력"]}, {"설문시행연도": "2025", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "여러 방면으로 자주 연락드리고 많이 요청드렸는데, 한 번도 싫은 내색 없이 적극적으로 응해주셨습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["적극적", "응대", "협력", "감사"]}, {"설문시행연도": "2025", "평가부서": "소화기내시경팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "문제 발생 시 빠르게 처리해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["문제 해결", "빠른 처리", "감사"]}, {"설문시행연도": "2025", "평가부서": "임상연구보호센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "의뢰 부서와 사용 부서의 괴리가 없도록 중간역할을 해주셔서 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["부서 협업", "중간 역할", "괴리 해소", "감사"]}, {"설문시행연도": "2025", "평가부서": "간호교육행정팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "시뮬레이션센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "교육 홍보 지원에 적극적으로 응대해 주었습니다.", "감정_분류": "긍정", "핵심_키워드": ["교육", "홍보", "지원", "적극적", "응대"]}, {"설문시행연도": "2025", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "암병원간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "암병원간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 90.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 매우 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족", "항상"]}, {"설문시행연도": "2025", "평가부서": "IT서비스팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "보안관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "외과간호1팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 빠른 피드백을 주시고 꼼꼼하게 봐주셔서 영상 제작을 빠르게 잘 마무리할 수 있었습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["빠른 피드백", "꼼꼼함", "영상 제작", "업무 효율", "감사"]}, {"설문시행연도": "2025", "평가부서": "약제팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "영상의학팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "어린이병원간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "각 부서 홈페이지 담당자들은 주 업무 외에 홈페이지 관리를 담당하고 있어 관리가 미흡합니다. 디자인 콘텐츠팀에서 많은 지원과 도움을 주시면 좋겠습니다.", "감정_분류": "부정", "핵심_키워드": ["홈페이지 관리", "업무 미흡", "디자인 콘텐츠팀", "지원 요청"]}, {"설문시행연도": "2025", "평가부서": "후생사업팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 적극적이고 빠른 일 처리와 친절한 답변으로 업무를 원활하게 진행할 수 있게 도와주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["일처리", "친절", "업무 원활", "감사", "협업"]}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "업무 담당 및 책임 소재가 불분명합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 담당", "책임 소재", "불분명"]}, {"설문시행연도": "2025", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "자재팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "요청 시 잘 협조해 줍니다.", "감정_분류": "긍정", "핵심_키워드": ["협조", "협력", "요청"]}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "요청 디자인에 대한 속도가 가끔 아쉽습니다. 사진 촬영 요청 시 어려움이 조금 느껴집니다.", "감정_분류": "부정", "핵심_키워드": ["요청 디자인", "속도", "사진 촬영", "어려움"]}, {"설문시행연도": "2025", "평가부서": "외과간호2팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "외래간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "환자에게 제공되는 안내문 수정 및 제작 요청 시 처리 속도가 빠릅니다.", "감정_분류": "긍정", "핵심_키워드": ["안내문", "제작", "처리속도", "효율"]}, {"설문시행연도": "2025", "평가부서": "약제팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": null, "전반만족": 25.0, "종합점수": 43.75, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "심장병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "외래간호팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 10.0, "정제된_텍스트": "타 부서 직원의 지시적인 말투로 인해 대화에 불편함을 느꼈습니다.", "감정_분류": "부정", "핵심_키워드": ["지시적 말투", "소통", "불편함", "타부서"]}, {"설문시행연도": "2025", "평가부서": "홍보팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "운영지원팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "매우 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족"]}, {"설문시행연도": "2025", "평가부서": "이노베이션디자인센터", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "건진운영팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "메디컬콘텐츠 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "메디케이션 자료 개발 시 해당 부서의 자체적인 기준이 없어, 자료 수정 및 문제점 피드백 과정에서 오랜 시간이 소요되어 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["메디케이션 자료", "기준 부재", "문제점 피드백", "시간 소요"]}, {"설문시행연도": "2025", "평가부서": "어린이병원", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "브랜드디자인 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "고객만족팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "프로젝트 진행 시 병원의 상황에 맞게 적극적으로 도움을 주셔서 감사했습니다.", "감정_분류": "긍정", "핵심_키워드": ["프로젝트", "병원 상황", "적극적 도움", "감사"]}, {"설문시행연도": "2025", "평가부서": "감염관리팀", "피평가부문": "커뮤니케이션실", "피평가부서": "디자인ㆍ콘텐츠팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}], "security": {"target_department": "디자인ㆍ콘텐츠팀", "target_division": "커뮤니케이션실", "data_scope": "디자인ㆍ콘텐츠팀 관련 데이터만 포함", "security_level": "HIGH", "aggregated_sections": ["전체 연도별", "부문별 연도별", "부문 비교", "팀 순위"], "filtered_sections": ["부서 상세분석", "네트워크 분석"]}};
        const rawData = hybridData.rawData;  // 필터링된 부서 데이터만 포함
        const aggregatedData = hybridData.aggregated;  // 미리 계산된 집계 데이터
        const securityInfo = hybridData.security;
        
        const scoreCols = ['존중배려', '정보공유', '명확처리', '태도개선', '전반만족', '종합점수'];
        const allYears = [...new Set(rawData.map(item => item['설문시행연도']))].sort();
        // 부문 비교용: 집계 데이터에서 모든 부문 가져오기
        const allDivisions = Object.keys(aggregatedData.division_comparison).length > 0 
            ? [...new Set(Object.values(aggregatedData.division_comparison).flatMap(yearData => Object.keys(yearData)))].sort((a, b) => a.localeCompare(b, 'ko'))
            : ["커뮤니케이션실"];
        const layoutFont = { size: 14 };
        
        // 보안 정보 콘솔 출력
        console.log('🔒 보안 정보:', securityInfo);
        console.log('📊 데이터 범위:', securityInfo.data_scope);

        const departmentUnitMap = rawData.reduce((acc, item) => {
            const dept = item['피평가부서'];
            const unit = item['피평가Unit'];
            if (dept && dept !== 'N/A' && unit && unit !== 'N/A') {
                if (!acc[dept]) { acc[dept] = new Set(); }
                acc[dept].add(unit);
            }
            return acc;
        }, {});
        for (const dept in departmentUnitMap) {
            departmentUnitMap[dept] = [...departmentUnitMap[dept]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function populateFilters() {
            // 연도 필터 설정
            const yearSelect = document.getElementById('year-filter');
            const years = [...new Set(rawData.map(item => item['설문시행연도']))].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
            yearSelect.innerHTML = ['전체', ...years].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.addEventListener('change', updateDashboard);
            
            // 부서 필터를 디자인ㆍ콘텐츠팀으로 고정
            const deptSelect = document.getElementById('department-filter');
            deptSelect.innerHTML = `<option value="디자인ㆍ콘텐츠팀">디자인ㆍ콘텐츠팀</option>`;
            deptSelect.value = "디자인ㆍ콘텐츠팀";
            deptSelect.addEventListener('change', updateUnitFilter);
            
            // Unit 필터 초기화
            updateUnitFilter();
        }

        function updateUnitFilter() {
            const deptSelect = document.getElementById('department-filter');
            const unitSelect = document.getElementById('unit-filter');
            const selectedDept = deptSelect.value;

            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];

            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            // Unit 필터 변경 시 차트 실시간 업데이트
            unitSelect.addEventListener('change', updateDashboard);
        }

        function setupDivisionChart() {
            const select = document.getElementById('division-chart-filter');
            // 고정값: 커뮤니케이션실만 선택 가능
            select.innerHTML = `<option value="커뮤니케이션실">커뮤니케이션실</option>`;
            select.value = "커뮤니케이션실";
            select.addEventListener('change', updateDivisionYearlyChart);
            createCheckboxFilter('division-score-filter', scoreCols, 'division-score', updateDivisionYearlyChart);
            // 초기 차트 표시
            updateDivisionYearlyChart();
        }
        
        function setupComparisonChart() {
            const yearSelect = document.getElementById('comparison-year-filter');
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1]; // Default to last year
            yearSelect.addEventListener('change', updateYearlyDivisionComparisonChart);
            createCheckboxFilter('comparison-division-filter', allDivisions, 'comparison-division', updateYearlyDivisionComparisonChart, true);
        }

        function getFilteredData() {
            let filteredData = [...rawData];
            const filters = { 'year-filter': '설문시행연도', 'department-filter': '피평가부서', 'unit-filter': '피평가Unit' };
            for (const [elementId, dataCol] of Object.entries(filters)) {
                const selectedValue = document.getElementById(elementId).value;
                if (selectedValue !== '전체') { filteredData = filteredData.filter(item => item[dataCol] == selectedValue); }
            }
            return filteredData;
        }

        function updateDashboard() {
            const filteredData = getFilteredData();
            updateMetrics(filteredData);
            updateDrilldownChart(filteredData);
            updateSentimentChart(filteredData);
            updateReviewsTable(filteredData);
            updateKeywordAnalysis(filteredData);
            updateYearlyComparisonChart();
            updateUnitComparisonChart();
        }
        
        function calculateAverages(data) {
            const averages = {};
            scoreCols.forEach(col => {
                const total = data.reduce((sum, item) => sum + (item[col] || 0), 0);
                averages[col] = data.length > 0 ? (total / data.length) : 0;
            });
            return averages;
        }

        function updateMetrics(data) {
            const container = document.getElementById('metrics-container');
            if (data.length === 0) { container.innerHTML = "<p style='text-align:center;'>선택된 조건에 해당하는 데이터가 없습니다.</p>"; return; }
            const averages = calculateAverages(data);
            container.innerHTML = `<div class="metric"><div class="metric-value">${data.length}</div><div class="metric-label">응답 수</div></div><div class="metric"><div class="metric-value">${averages['종합점수'].toFixed(1)}</div><div class="metric-label">종합점수</div></div>`;
        }
        
        function updateDrilldownChart(data) {
            const container = document.getElementById('drilldown-chart-container');
            if (!container) return;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (data.length === 0 || selectedScores.length === 0) { 
                const message = data.length > 0 ? '표시할 문항을 선택해주세요.' : '';
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: message, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const averages = calculateAverages(data);
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            const chartData = [{ x: selectedScores, y: selectedScores.map(col => averages[col].toFixed(1)), type: 'bar', text: selectedScores.map(col => averages[col].toFixed(1)), textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[0], line: { color: '#000000', width: 1 } }, hovertemplate: '%{x}: %{y}<extra></extra>' }];
            const selectedYear = document.getElementById('year-filter').value;
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            
            // 제목 생성
            let titleParts = [];
            if (selectedDept !== '전체') { titleParts.push(selectedDept); }
            if (selectedUnit !== '전체') { titleParts.push(selectedUnit); }
            
            const titlePrefix = titleParts.length > 0 ? titleParts.join(' > ') : '부서, Unit';
            const yearSuffix = selectedYear === '전체' ? ' (전체 연도)' : ` (${selectedYear})`;
            const title = `<b>${titlePrefix} 문항 점수${yearSuffix}</b>`;
            const layout = { title: title, yaxis: { title: '점수', range: [0, 100] }, font: layoutFont, hovermode: 'closest', margin: { l: 60, r: 60, t: 80, b: 60 } };
            Plotly.react(container, chartData, layout);
        }
        
        function updateHospitalYearlyChart() {
            const container = document.getElementById('hospital-yearly-chart-container');
            const selectedScores = Array.from(document.querySelectorAll('input[name="hospital-score"]:checked')).map(cb => cb.value);
            
            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 집계 데이터 사용
            const hospitalData = aggregatedData.hospital_yearly;
            const years = Object.keys(hospitalData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => hospitalData[year][col] ? hospitalData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => hospitalData[year]['응답수'] || 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: '<b>병원 전체 결과</b>',
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateDivisionYearlyChart() {
            const container = document.getElementById('division-yearly-chart-container');
            const selectedDivision = document.getElementById('division-chart-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="division-score"]:checked')).map(cb => cb.value);

            // 커뮤니케이션실로 고정되어 있으므로 선택 확인 불필요

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문별 집계 데이터 사용
            const divisionData = aggregatedData.division_yearly[selectedDivision] || {};
            const years = Object.keys(divisionData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => divisionData[year] && divisionData[year][col] ? divisionData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => divisionData[year] ? divisionData[year]['응답수'] || 0 : 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: `<b>[${selectedDivision}] 결과</b>`,
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateYearlyDivisionComparisonChart() {
            const container = document.getElementById('comparison-chart-container');
            const selectedYear = document.getElementById('comparison-year-filter').value;
            const selectedDivisions = Array.from(document.querySelectorAll('input[name="comparison-division"]:checked')).map(cb => cb.value);

            if (selectedDivisions.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '비교할 부문을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문 비교 집계 데이터 사용 (모든 부문 포함)
            const comparisonData = aggregatedData.division_comparison[selectedYear] || {};
            
            const divisions = selectedDivisions.filter(div => comparisonData[div]).sort((a,b) => a.localeCompare(b, 'ko'));
            const avgScores = divisions.map(div => comparisonData[div]['종합점수'] ? comparisonData[div]['종합점수'].toFixed(1) : '0.0');
            const responseCounts = divisions.map(div => comparisonData[div]['응답수'] || 0);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = { x: divisions, y: avgScores, type: 'bar', text: avgScores, textposition: 'outside', textfont: { size: 14 }, marker: { color: '#FDC1B4', line: { color: '#000000', width: 1 } }, customdata: responseCounts, hovertemplate: '%{x}: %{y}점<br>응답수: %{customdata}건<extra></extra>' };
            
            const avgLine = {
                x: [divisions[0], divisions[divisions.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };
            
            const layout = {
                title: `<b>${selectedYear} 부문별 종합 점수</b>`,
                yaxis: { title: '점수', range: [0, 100] },
                font: layoutFont,
                height: 500,
                barmode: 'group',
                hovermode: 'closest',
                showlegend: false,
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };
            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateSentimentChart(data) {
            const container = document.getElementById('sentiment-chart-container');
            
            if (data.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류가 있는 데이터만 필터링
            const validSentimentData = data.filter(item => {
                const sentiment = item['감정_분류'];
                return sentiment && sentiment !== 'N/A' && sentiment !== '알 수 없음';
            });

            if (validSentimentData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '감정 분류 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류별 집계 (알 수 없음 제외)
            const sentimentCounts = {};
            validSentimentData.forEach(item => {
                const sentiment = item['감정_분류'];
                sentimentCounts[sentiment] = (sentimentCounts[sentiment] || 0) + 1;
            });

            // 원하는 순서로 감정 분류 고정
            const desiredOrder = ['긍정', '부정', '중립'];
            const sentiments = desiredOrder.filter(sentiment => sentimentCounts[sentiment] > 0);
            const counts = sentiments.map(sentiment => sentimentCounts[sentiment]);
            const total = counts.reduce((sum, count) => sum + count, 0);
            const percentages = counts.map(count => ((count / total) * 100).toFixed(1));

            // 색상 매핑
            const colorMap = {
                '긍정': '#72B0AB',
                '부정': '#FE9179', 
                '중립': '#FFF6F5',
                '알 수 없음': '#808080'
            };
            const colors = sentiments.map(sentiment => colorMap[sentiment] || '#808080');

            const trace = {
                x: sentiments,
                y: counts,
                type: 'bar',
                text: counts.map((count, idx) => `${count}건 (${percentages[idx]}%)`),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{x}: %{y}건 (%{text})<extra></extra>'
            };

            const layout = {
                title: '',
                height: 400,
                xaxis: { title: '감정 분류' },
                yaxis: { title: '응답 수', rangemode: 'tozero', range: [0, Math.max(...counts) * 1.15] },
                font: layoutFont,
                hovermode: 'closest',
                showlegend: false,
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };

            Plotly.react(container, [trace], layout);
        }


        function updateReviewsTable(data = null) {
            const tbody = document.querySelector("#reviews-table tbody");
            
            if (data === null) { data = getFilteredData(); }
            
            const selectedSentiments = Array.from(document.querySelectorAll('input[name="review-sentiment"]:checked')).map(cb => cb.value);
            
            let filteredData = data;
            if (selectedSentiments.length > 0 && !selectedSentiments.includes('전체')) {
                filteredData = data.filter(item => selectedSentiments.includes(item['감정_분류']));
            }
            
            const reviews = filteredData.map(item => ({ 
                year: item['설문시행연도'], 
                review: item['정제된_텍스트'],
                sentiment: item['감정_분류'] || '알 수 없음'
            })).filter(r => r.review && r.review !== 'N/A')
            .sort((a, b) => b.year - a.year)
            .slice(0, 40000); // 최대 40000개만 표시
            
            // 후기 개수 표시 업데이트
            const countDisplay = document.getElementById('reviews-count-display');
            if (countDisplay) {
                countDisplay.textContent = `(${reviews.length}건)`;
            }
            
            tbody.innerHTML = (reviews.length > 0) ? 
                reviews.map(r => `<tr><td>${r.year}</td><td>${r.review} <span style="color: #666; font-size: 0.9em;">[${r.sentiment}]</span></td></tr>`).join('') : 
                '<tr><td colspan="2">해당 조건의 후기가 없습니다.</td></tr>';
        }

        function updateKeywordAnalysis(data) {
            const positiveCounts = {};
            const negativeCounts = {};

            data.forEach(item => {
                const keywords = item['핵심_키워드'];
                if (keywords && Array.isArray(keywords) && keywords.length > 0) {
                    const sentiment = item['감정_분류'];
                    keywords.forEach(kw => {
                        if (sentiment === '긍정') {
                            positiveCounts[kw] = (positiveCounts[kw] || 0) + 1;
                        } else if (sentiment === '부정') {
                            negativeCounts[kw] = (negativeCounts[kw] || 0) + 1;
                        }
                    });
                }
            });

            const topPositive = Object.entries(positiveCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);
            const topNegative = Object.entries(negativeCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);

            const posChartContainer = document.getElementById('positive-keywords-chart');
            const negChartContainer = document.getElementById('negative-keywords-chart');

            if (posChartContainer) plotKeywordChart(posChartContainer, '긍정 키워드 Top 10', topPositive, '긍정');
            if (negChartContainer) plotKeywordChart(negChartContainer, '부정 키워드 Top 10', topNegative, '부정');
            
            displayKeywordReviews(null, null, true);
        }

        function plotKeywordChart(container, title, data, sentiment) {
            if (!container) return;
            if (data.length === 0) {
                Plotly.react(container, [], { title: `<b>${title}</b>`, height: 400, annotations: [{ text: '데이터 없음', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false }] });
                return;
            }

            const trace = {
                y: data.map(d => d[0]).reverse(),
                x: data.map(d => d[1]).reverse(),
                type: 'bar',
                orientation: 'h',
                marker: { color: sentiment === '긍정' ? '#72B0AB' : '#FE9179', line: { color: '#000000', width: 1 } },
                hovertemplate: '언급 횟수: %{x}<extra></extra>'
            };

            const layout = {
                title: `<b>${title}</b>`,
                height: 400,
                margin: { l: 120, r: 40, t: 80, b: 60 },
                xaxis: { title: '언급 횟수' },
                yaxis: { automargin: true }
            };

            Plotly.react(container, [trace], layout);
            container.removeAllListeners('plotly_click');
            container.on('plotly_click', (eventData) => {
                const keyword = eventData.points[0].y;
                displayKeywordReviews(keyword, sentiment);
            });
        }

        function displayKeywordReviews(keyword, sentiment, isInitial = false) {
            const container = document.getElementById('keyword-reviews-container');
            if (!container) return;
            
            if (isInitial) {
                container.innerHTML = `<h4>관련 리뷰</h4><p>위 그래프의 막대를 클릭하면 관련 리뷰를 확인할 수 있습니다.</p><div id="keyword-reviews-table-container"><table id="keyword-reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody><tr><td colspan="2" style="text-align:center;"></td></tr></tbody></table></div>`;
                return;
            }

            const filteredData = getFilteredData();
            
            const reviews = filteredData.filter(item => 
                item['감정_분류'] === sentiment && 
                Array.isArray(item['핵심_키워드']) && 
                item['핵심_키워드'].includes(keyword)
            );

            let content = `<h4>'${keyword}' (${sentiment}) 관련 리뷰 (${reviews.length}건)</h4>`;
            if (reviews.length > 0) {
                content += `<div id="keyword-reviews-table-container"><table id="keyword-reviews-table">
                    <thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody>`;
                content += reviews.slice(0, 40000).map(r => `<tr><td>${r['설문시행연도']}</td><td>${r['정제된_텍스트']}</td></tr>`).join(''); // 최대 40000개만 표시
                content += `</tbody></table></div>`;
            } else {
                content += '<p>관련 리뷰가 없습니다.</p>';
            }
            container.innerHTML = content;
        }

        function setupTeamRankingChart() {
            const yearSelect = document.getElementById('team-ranking-year-filter');
            const divisionSelect = document.getElementById('team-ranking-division-filter');
            
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1];
            
            // 고정값: 커뮤니케이션실만 선택 가능
            divisionSelect.innerHTML = `<option value="커뮤니케이션실">커뮤니케이션실</option>`;
            divisionSelect.value = "커뮤니케이션실";
            
            yearSelect.addEventListener('change', updateTeamRankingChart);
            divisionSelect.addEventListener('change', updateTeamRankingChart);
            // 초기 차트 표시
            updateTeamRankingChart();
        }

        function updateTeamRankingChart() {
            const container = document.getElementById('team-ranking-chart-container');
            const selectedYear = document.getElementById('team-ranking-year-filter').value;
            const selectedDivision = document.getElementById('team-ranking-division-filter').value;

            // 커뮤니케이션실로 고정되어 있으므로 선택 확인 불필요

            // 미리 계산된 팀 순위 집계 데이터 사용
            const teamRankingData = aggregatedData.team_ranking[selectedYear] || [];
            
            // 해당 부문에 속한 팀들만 필터링 (커뮤니케이션실 소속 부서들)
            const teamRankings = teamRankingData.filter(team => {
                // 동적으로 해당 부문의 부서들을 포함
                return true; // 이미 집계 데이터에서 해당 부문만 포함되어 있음
            });

            if (teamRankings.length === 0) {
                Plotly.react(container, [], {
                    height: 600,
                    annotations: [{ text: '선택된 조건에 해당하는 부서 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 모든 부문 동일 색상 사용
            const departments = teamRankings.map(item => item.department);
            const scores = teamRankings.map(item => parseFloat(item.score));
            const colors = teamRankings.map(() => '#FDC1B4');
            const hoverTexts = teamRankings.map(item => `부서: ${item.department}<br>점수: ${item.score.toFixed(1)}<br>응답수: ${item.count}건`);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = {
                x: departments, y: scores, type: 'bar', text: scores.map(score => score.toFixed(1)),
                textposition: 'outside', textfont: { size: 12 }, marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{hovertext}<extra></extra>', hovertext: hoverTexts
            };

            const avgLine = {
                x: [departments[0], departments[departments.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };

            const layout = {
                title: `<b>${selectedYear} 팀별 종합점수</b>`, height: 600,
                xaxis: { title: '부서', tickangle: -45, automargin: true },
                yaxis: { title: '점수', range: [Math.min(...scores) - 5, Math.max(...scores) + 5] },
                font: layoutFont, hovermode: 'closest', showlegend: false,
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.02, xanchor: 'right', x: 1 },
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 100 }
            };

            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateYearlyComparisonChart() {
            const container = document.getElementById('yearly-comparison-chart-container');
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let targetData = [...rawData];
            if (selectedDept !== '전체') { targetData = targetData.filter(item => item['피평가부서'] === selectedDept); }
            if (selectedUnit !== '전체') { targetData = targetData.filter(item => item['피평가Unit'] === selectedUnit); }

            if (targetData.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const years = [...new Set(targetData.map(item => item['설문시행연도']))].sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => {
                    const yearData = targetData.filter(d => d['설문시행연도'] === year);
                    return yearData.length > 0 ? (yearData.reduce((sum, item) => sum + (item[col] || 0), 0) / yearData.length).toFixed(1) : 0;
                });
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => targetData.filter(d => d['설문시행연도'] === year).length);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            let titleText = '결과';
            if (selectedDept !== '전체' && selectedUnit !== '전체') { titleText = `[${selectedDept} > ${selectedUnit}] 결과`; }
            else if (selectedDept !== '전체') { titleText = `[${selectedDept}] 결과`; }
            else if (selectedUnit !== '전체') { titleText = `[${selectedUnit}] 결과`; }
            
            const layout = {
                title: `<b>${titleText}</b>`, barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            
            Plotly.react(container, traces, layout);
        }

        function setupUnitComparisonChart() {
            // Unit comparison chart uses main filters from detailed analysis section
            // No separate filters needed
        }

        function updateUnitComparisonChart() {
            const container = document.getElementById('unit-comparison-chart-container');
            const selectedDepartment = document.getElementById('department-filter').value;
            const selectedYear = document.getElementById('year-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedDepartment === '전체') {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: 'Unit 간 비교를 위해 부서를 선택해 주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let departmentData = rawData.filter(item => item['피평가부서'] === selectedDepartment);
            if (selectedYear !== '전체') { departmentData = departmentData.filter(item => item['설문시행연도'] === selectedYear); }

            const unitsInDepartment = [...new Set(departmentData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a, b) => String(a).localeCompare(String(b), 'ko'));

            if (unitsInDepartment.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 Unit이 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const traces = [];
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = unitsInDepartment.map(unit => {
                    const unitData = departmentData.filter(item => item['피평가Unit'] === unit);
                    return unitData.length > 0 ? (unitData.reduce((sum, item) => sum + (item[col] || 0), 0) / unitData.length).toFixed(1) : 0;
                });
                traces.push({ x: unitsInDepartment, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>Unit: %{x}<extra></extra>' });
            });

            const layout = {
                title: `<b>[${selectedDepartment}] Unit별 결과</b>`, barmode: 'group', height: 400,
                xaxis: { title: 'Unit' }, yaxis: { title: '점수', range: [0, 100] },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };

            Plotly.react(container, traces, layout);
        }

        function toggleExpander(expanderId) {
            const content = document.getElementById(expanderId);
            const arrow = document.getElementById(expanderId.replace('-expander', '-arrow'));
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                arrow.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                arrow.classList.add('expanded');
            }
        }

        function updateExpanderHeader(groupName, selectedCount, totalCount) {
            const headerId = groupName.replace('-filter', '-header');
            const headerSpan = document.querySelector(`#${headerId} span:first-child`);
            if (headerSpan) {
                if (groupName.includes('division-filter')) {
                    headerSpan.textContent = `부문 선택 (${selectedCount}개 선택됨)`;
                } else {
                    headerSpan.textContent = `문항 선택 (${selectedCount}개 선택됨)`;
                }
            }
        }

        function createCheckboxFilter(containerId, items, groupName, updateFunction, startChecked = true) {
            const container = document.getElementById(containerId);
            
            const selectAllDiv = document.createElement('div');
            selectAllDiv.className = 'checkbox-item';
            selectAllDiv.innerHTML = `<input type="checkbox" id="${groupName}-select-all" ${startChecked ? 'checked' : ''}><label for="${groupName}-select-all"><b>전체 선택</b></label>`;
            container.appendChild(selectAllDiv);
            
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'checkbox-item';
                itemDiv.innerHTML = `<input type="checkbox" id="${groupName}-${item}" name="${groupName}" value="${item}" ${startChecked ? 'checked' : ''}><label for="${groupName}-${item}">${item}</label>`;
                container.appendChild(itemDiv);
            });

            const selectAllCheckbox = container.querySelector(`#${groupName}-select-all`);
            const itemCheckboxes = container.querySelectorAll(`input[name="${groupName}"]`);

            function updateSelectAllState() {
                const allChecked = [...itemCheckboxes].every(cb => cb.checked);
                const someChecked = [...itemCheckboxes].some(cb => cb.checked);
                const checkedCount = [...itemCheckboxes].filter(cb => cb.checked).length;
                
                selectAllCheckbox.checked = allChecked;
                selectAllCheckbox.indeterminate = !allChecked && someChecked;
                
                updateExpanderHeader(containerId, checkedCount, items.length);
            }

            selectAllCheckbox.addEventListener('change', (e) => {
                itemCheckboxes.forEach(checkbox => { checkbox.checked = e.target.checked; });
                updateSelectAllState();
                updateFunction();
            });

            itemCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateSelectAllState();
                    updateFunction();
                });
            });

            updateSelectAllState();
        }

        // === 협업 네트워크 분석 기능 ===
        
        // 부문-부서-Unit 매핑 생성
        const divisionDepartmentMap = rawData.reduce((acc, item) => {
            const division = item['피평가부문'];
            const department = item['피평가부서'];
            if (division && division !== 'N/A' && department && department !== 'N/A') {
                if (!acc[division]) { acc[division] = new Set(); }
                acc[division].add(department);
            }
            return acc;
        }, {});
        for (const division in divisionDepartmentMap) {
            divisionDepartmentMap[division] = [...divisionDepartmentMap[division]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function setupNetworkAnalysis() {
            const yearSelect = document.getElementById('network-year-filter');
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const minCollabSelect = document.getElementById('min-collaboration-filter');
            
            // 연도 필터 설정
            yearSelect.innerHTML = ['전체', ...allYears].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            
            // 부문 필터 설정 - 고정값: 커뮤니케이션실만 선택 가능
            divisionSelect.innerHTML = `<option value="커뮤니케이션실">커뮤니케이션실</option>`;
            divisionSelect.value = "커뮤니케이션실";
            
            // 초기 부서, Unit 설정
            departmentSelect.innerHTML = '<option value="전체">전체</option>';
            unitSelect.innerHTML = '<option value="전체">전체</option>';
            
            // 이벤트 리스너 추가
            yearSelect.addEventListener('change', updateNetworkAnalysis);
            divisionSelect.addEventListener('change', updateNetworkDepartments);
            departmentSelect.addEventListener('change', updateNetworkUnits);
            unitSelect.addEventListener('change', updateNetworkAnalysis);
            minCollabSelect.addEventListener('change', updateNetworkAnalysis);
            
            // 협업 관계 현황 체크박스 이벤트 리스너는 updateStatusDropdowns 함수에서 동적으로 추가됨
            
            // 초기 네트워크 분석 표시
            updateNetworkDepartments();
        }

        function updateNetworkDepartments() {
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDivision = divisionSelect.value;
            
            // 부서 드롭다운을 디자인ㆍ콘텐츠팀으로 고정
            departmentSelect.innerHTML = `<option value="디자인ㆍ콘텐츠팀">디자인ㆍ콘텐츠팀</option>`;
            departmentSelect.value = "디자인ㆍ콘텐츠팀";
            
            // 부서 필터가 변경되었으므로, Unit 필터를 업데이트하고 분석을 새로고침합니다.
            updateNetworkUnits();
        }

        function updateNetworkUnits() {
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDept = departmentSelect.value;
            
            // Unit 드롭다운 업데이트
            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];
            
            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            updateNetworkAnalysis();
        }

        function getNetworkFilteredData() {
            let filteredData = [...rawData];
            
            const selectedYear = document.getElementById('network-year-filter').value;
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedYear !== '전체') { filteredData = filteredData.filter(item => String(item['설문시행연도']) === String(selectedYear)); }
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }
        
        function getNetworkFilteredDataWithoutYear() {
            let filteredData = [...rawData];
            
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }

        function updateNetworkAnalysis() {
            updateCollaborationFrequencyChart();
        }

        function updateCollaborationFrequencyChart() {
            const container = document.getElementById('collaboration-frequency-chart-container');
            const filteredData = getNetworkFilteredData();
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            if (filteredData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            // 협업 빈도 계산
            const selectedUnit = document.getElementById('network-unit-filter').value;
            const collaborationCounts = {};
            filteredData.forEach(item => {
                const evaluator = item['평가부서'];
                // Unit이 선택된 경우 Unit 이름 사용, 그렇지 않으면 부서 이름 사용
                const evaluated = selectedUnit !== '전체' ? item['피평가Unit'] : item['피평가부서'];
                if (evaluator !== evaluated && evaluator && evaluated && evaluator !== 'N/A' && evaluated !== 'N/A') {
                    const key = `${evaluator} → ${evaluated}`;
                    collaborationCounts[key] = (collaborationCounts[key] || 0) + 1;
                }
            });
            
            // 최소 협업 횟수 이상인 관계만 필터링
            const filteredCollaborations = Object.entries(collaborationCounts)
                .filter(([_, count]) => count >= minCollabCount)
                .sort((a, b) => b[1] - a[1]);
            
            if (filteredCollaborations.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: `최소 ${minCollabCount}회 이상 협업한 관계가 없습니다.`, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            const trace = {
                y: filteredCollaborations.map(([key, _]) => key).reverse(),
                x: filteredCollaborations.map(([_, count]) => count).reverse(),
                type: 'bar',
                orientation: 'h',
                text: filteredCollaborations.map(([_, count]) => `${count}회`).reverse(),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: '#355E58', line: { color: '#000000', width: 1 } },
                hovertemplate: '협업 횟수: %{x}회<extra></extra>'
            };
            
            // 부서 수에 따라 동적 높이 계산 (막대당 최소 25px 보장)
            const barHeight = 25;
            const dynamicHeight = Math.max(400, filteredCollaborations.length * barHeight + 100);
            
            const layout = {
                title: '<b>부서 리스트</b>',
                height: dynamicHeight,
                margin: { l: 150, r: 40, t: 80, b: 60 },
                xaxis: { title: '협업 횟수' },
                yaxis: { 
                    automargin: true,
                    fixedrange: true,
                    categoryorder: 'total ascending'
                },
                font: layoutFont
            };
            
            Plotly.react(container, [trace], layout);
        }

        



        window.onload = () => { 
            populateFilters(); 
            createCheckboxFilter('hospital-score-filter', scoreCols, 'hospital-score', updateHospitalYearlyChart);
            createCheckboxFilter('drilldown-score-filter', scoreCols, 'drilldown-score', updateDashboard);
            createCheckboxFilter('review-sentiment-filter', ['긍정', '부정', '중립'], 'review-sentiment', updateReviewsTable, true);
            setupDivisionChart();
            setupComparisonChart();
            setupTeamRankingChart();
            setupUnitComparisonChart();
            setupNetworkAnalysis();
            updateDashboard(); 
            updateHospitalYearlyChart();
            updateDivisionYearlyChart();
            updateYearlyDivisionComparisonChart();
            updateTeamRankingChart();
            updateUnitComparisonChart();
            updateNetworkAnalysis();
        };
    </script>
</body>
</html>
    