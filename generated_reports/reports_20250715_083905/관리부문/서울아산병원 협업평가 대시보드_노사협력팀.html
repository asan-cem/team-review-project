
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>서울아산병원 협업 평가 대시보드</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #343a40; font-size: 16px;}
        .container { max-width: 1400px; margin: auto; padding: 20px; }
        .header { background: linear-gradient(90deg, #4a69bd, #6a89cc); color: white; padding: 25px; text-align: center; border-radius: 0 0 10px 10px; }
        
        /* 자동 번호 매기기 CSS */
        .container { counter-reset: section-counter; }
        .section { counter-reset: subsection-counter; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section h2::before { counter-increment: section-counter; content: counter(section-counter) ". "; color: #4a69bd; font-weight: bold; }
        .section h3::before { counter-increment: subsection-counter; content: counter(section-counter) "." counter(subsection-counter) " "; color: #6a89cc; font-weight: bold; }
        
        h1, h2, h3 { margin: 0; padding: 0; }
        h2 { color: #4a69bd; border-bottom: 3px solid #6a89cc; padding-bottom: 10px; margin-top: 20px; margin-bottom: 20px; }
        h3 { color: #555; margin-top: 30px; margin-bottom: 15px;}
        
        /* 파트 구분 스타일 */
        .part-divider { background: linear-gradient(90deg, #e9ecef, #6c757d, #e9ecef); height: 3px; margin: 40px 0; border-radius: 2px; }
        .part-title { text-align: center; color: #6c757d; font-size: 1.2em; font-weight: bold; margin: 30px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 5px solid #6a89cc; }
        
        .filters, .trend-filters { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-end; margin-bottom: 20px;}
        .filter-group { display: flex; flex-direction: column; }
        .filter-group label { margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        .filter-group select, .filter-group input { padding: 8px; border-radius: 5px; border: 1px solid #ced4da; min-width: 200px; }
        .expander-container { border: 1px solid #ced4da; border-radius: 5px; background-color: white; min-width: 200px; max-width: 280px; position: relative; }
        .expander-header { padding: 6px 8px; background-color: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 5px; user-select: none; font-size: 13px; }
        .expander-header:hover { background-color: #e9ecef; }
        .expander-arrow { transition: transform 0.3s ease; font-size: 11px; }
        .expander-arrow.expanded { transform: rotate(180deg); }
        .expander-content { padding: 4px; display: none; max-height: 200px; overflow-y: auto; position: absolute; top: 100%; left: 0; width: 100%; background-color: white; border: 1px solid #ced4da; border-top: none; border-radius: 0 0 5px 5px; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .expander-content.expanded { display: block; }
        .checkbox-item { display: flex; align-items: center; padding: 2px 0; height: auto; min-height: unset; }
        .checkbox-item input[type="checkbox"] { width: 16px; height: 16px; min-width: 16px; min-height: 16px; margin-right: 6px; box-sizing: border-box; }
        .checkbox-item:hover { background-color: #f8f9fa; }
        .checkbox-item label { cursor: pointer; font-weight: normal; font-size: 13px; line-height: 1.1; margin: 0; }
        #metrics-container { display: flex; gap: 30px; margin-top: 20px; text-align: center; justify-content: center; }
        .metric { background-color: #e9ecef; padding: 15px; border-radius: 8px; flex-grow: 1; }
        .metric-value { font-size: 2em; font-weight: bold; color: #4a69bd; }
        .metric-label { font-size: 0.9em; color: #6c757d; }
        #reviews-table-container, #keyword-reviews-table-container { max-height: 400px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #network-reviews-table-container { max-height: 300px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #reviews-table, #keyword-reviews-table, #network-reviews-table { width: 100%; border-collapse: collapse; }
        #reviews-table th, #reviews-table td, #keyword-reviews-table th, #keyword-reviews-table td, #network-reviews-table th, #network-reviews-table td { padding: 12px; border-bottom: 1px solid #dee2e6; text-align: left; }
        #reviews-table th, #keyword-reviews-table th, #network-reviews-table th { background-color: #f8f9fa; position: sticky; top: 0; }
        #reviews-table tr:last-child td, #keyword-reviews-table tr:last-child td, #network-reviews-table tr:last-child td { border-bottom: none; }
        .keyword-charts-container { display: flex; gap: 20px; }
        .keyword-chart { flex: 1; }
        
        /* 차트 컨테이너 스타일 개선 */
        .chart-container { margin: 20px 0; }
        .subsection { margin: 30px 0; }
        
        /* 협업 빈도 차트 스크롤 컨테이너 */
        #collaboration-frequency-chart-container { max-height: 600px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px; }
        
        /* 협업 관계 현황 드롭다운 스타일 */
        .collaboration-status-dropdowns { margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .status-dropdown { border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; background: white; }
        .status-dropdown h5 { margin: 0 0 10px 0; font-size: 1em; font-weight: bold; }
        .status-dropdown.excellent { border-left: 4px solid #28a745; }
        .status-dropdown.good { border-left: 4px solid #17a2b8; }
        .status-dropdown.caution { border-left: 4px solid #ffc107; }
        .status-dropdown.problem { border-left: 4px solid #dc3545; }
        .status-dropdown select { width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px; background: white; }
        .status-dropdown .dept-count { color: #6c757d; font-size: 0.9em; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1> 서울아산병원 협업 평가 대시보드 - 노사협력팀 </h1>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">설문 데이터: 2022년 ~ 2025년 상반기(2025년 7월 9일 기준) </p>
    </div>
    
    <!-- 안내 문구 섹션 -->
    <div style="max-width: 1400px; margin: 20px auto; padding: 0 20px;">
        <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <h3 style="color: #495057; margin: 0 0 15px 0; font-size: 1.1em;">📋 대시보드 이용 안내</h3>
            
            <div style="margin-bottom: 15px;">
                <strong style="color: #495057;">📊 평가 문항 설명:</strong>
                <ul style="margin: 8px 0 0 20px; color: #6c757d; font-size: 0.95em; line-height: 1.4;">
                    <li><strong>존중배려:</strong> ○○은 타 부서의 입장을 존중하고 배려하여 협력해주며, 협업 관련 의견을 경청해준다.</li>
                    <li><strong>정보공유:</strong> ○○은 업무상 필요한 정보에 대해 공유가 잘 이루어진다.</li>
                    <li><strong>명확처리:</strong> ○○은 업무에 대한 명확한 담당자가 있고 업무를 일관성있게 처리해준다.</li>
                    <li><strong>태도개선:</strong> ○○은 이전보다 업무 협력에 대한 태도나 의지가 개선되고 있다.</li>
                    <li><strong>전반만족:</strong> 전반적으로 ○○과의 협업에 대해 만족한다.</li>
                </ul>
            </div>
            
            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 12px;">
                <strong style="color: #856404;">⚠️ 통계적 해석 주의사항:</strong>
                <span style="color: #856404; font-size: 0.95em;">응답건수(표본수)가 30건 미만인 경우 통계적 해석에 유의하시기 바랍니다.</span>
            </div>
        </div>
    </div>
    
    <div class="container">
        
        
        <div class="section">
            <h2>[전체] 연도별 문항 점수</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">우리 병원의 점수 트렌드를 파악합니다.</p>
            <div class="filters">
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="hospital-score-header" onclick="toggleExpander('hospital-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="hospital-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="hospital-score-expander">
                            <div id="hospital-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="hospital-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>

        <div class="section">
            <h2>[부문별] 연도별 문항 점수</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">부문별 점수 트렌드를 파악합니다.</p>
            <div class="filters">
                <div class="filter-group">
                    <label for="division-chart-filter">부문 선택</label>
                    <select id="division-chart-filter"></select>
                </div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="division-score-header" onclick="toggleExpander('division-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="division-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="division-score-expander">
                            <div id="division-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="division-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="section">
            <h2>연도별 부문 비교</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">특정 연도의 부문간 점수를 비교합니다.</p>
            <div class="filters">
                <div class="filter-group">
                    <label for="comparison-year-filter">연도 선택</label>
                    <select id="comparison-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label>부문 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="comparison-division-header" onclick="toggleExpander('comparison-division-expander')">
                            <span>부문 선택 (0개 선택됨)</span>
                            <span class="expander-arrow" id="comparison-division-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="comparison-division-expander">
                            <div id="comparison-division-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comparison-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>부문별 팀 점수 순위</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">부문 내 부서간 점수를 파악합니다.</p>
            <div class="filters">
                <div class="filter-group">
                    <label for="team-ranking-year-filter">연도 선택</label>
                    <select id="team-ranking-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="team-ranking-division-filter">부문 선택</label>
                    <select id="team-ranking-division-filter"></select>
                </div>
            </div>
            <div id="team-ranking-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>부서/Unit 상세 분석</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">부서와 Unit이 받은 점수 및 후기를 파악합니다.</p>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group"><label for="year-filter">연도 (전체)</label><select id="year-filter"></select></div>
                <div class="filter-group"><label for="department-filter">부서</label><select id="department-filter"></select></div>
                <div class="filter-group"><label for="unit-filter">Unit</label><select id="unit-filter"></select></div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="drilldown-score-header" onclick="toggleExpander('drilldown-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="drilldown-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="drilldown-score-expander">
                            <div id="drilldown-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 5.1 기본 지표 및 점수 트렌드 -->
            <div class="subsection">
                <h3>기본 지표 및 점수 트렌드</h3>
                <div id="metrics-container"></div>
                <div id="drilldown-chart-container" class="chart-container"></div>
                <div id="yearly-comparison-chart-container" class="chart-container"></div>
                
                <!-- 부서 내 Unit 비교 -->
                <div style="margin-top: 30px;">
                    <h4 style="color: #555; margin-bottom: 15px;">부서 내 Unit 비교</h4>
                    <p style="color: #6c757d; margin-bottom: 20px; font-size: 0.9em;">부서 내 Unit간 점수를 파악합니다.</p>
                    <div id="unit-comparison-chart-container" class="chart-container"></div>
                </div>
            </div>
            
            <!-- 5.2 감정 분석 -->
            <div class="subsection">
                <h3>협업 주관식 피드백 감정 분석</h3>
                <div id="sentiment-chart-container" class="chart-container"></div>
            </div>
            

            <!-- 5.3 키워드 분석 -->
            <div class="subsection">
                <h3>핵심 키워드 분석</h3>
                <div style="background: #f8f9fa; padding: 15px; border-left: 4px solid #6a89cc; margin-bottom: 20px; border-radius: 0 5px 5px 0;">
                    <p style="margin: 0; color: #495057; font-size: 0.95em;">
                        <strong>📊 이 차트는 무엇인가요?</strong><br>
                        협업 후기에서 자주 언급되는 단어들을 긍정/부정으로 분류하여 상위 10개를 보여줍니다.<br><br>
                        <strong>💡 활용 방법:</strong><br>
                        • <span style="color: #28a745;"><strong>긍정 키워드</strong></span>: 어떤 부분에서 만족하고 있는지 파악<br>
                        • <span style="color: #dc3545;"><strong>부정 키워드</strong></span>: 개선이 필요한 부분을 빠르게 확인<br>
                        • <strong>막대 클릭</strong>: 해당 키워드가 포함된 실제 후기 내용을 확인할 수 있습니다<br><br>
                        <em>예시: "신속한" 키워드 클릭 → "신속한 응답으로 업무가 원활했다" 등의 후기 표시</em>
                    </p>
                </div>
                <div class="keyword-charts-container">
                    <div id="positive-keywords-chart" class="keyword-chart"></div>
                    <div id="negative-keywords-chart" class="keyword-chart"></div>
                </div>
                <div id="keyword-reviews-container"></div>
            </div>
            
            <!-- 5.4 협업 후기 -->
            <div class="subsection">
                <h3>협업 후기 <span id="reviews-count-display" style="color: #666; font-size: 0.9em;"></span></h3>
                <div class="filters">
                    <div class="filter-group">
                        <label>감정 분류 필터</label>
                        <div class="expander-container">
                            <div class="expander-header" id="review-sentiment-header" onclick="toggleExpander('review-sentiment-expander')">
                                <span>감정 선택 (4개 선택됨)</span>
                                <span class="expander-arrow" id="review-sentiment-arrow">▼</span>
                            </div>
                            <div class="expander-content" id="review-sentiment-expander">
                                <div id="review-sentiment-filter"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="reviews-table-container"><table id="reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody></tbody></table></div>
            </div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>협업 네트워크 분석</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">🔍 우리 팀/Unit과 협업을 하는 팀/Unit과의 관계를 종합적으로 분석합니다.</p>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group">
                    <label for="network-division-filter">연도 (전체)</label>
                    <select id="network-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-division-filter">부문</label>
                    <select id="network-division-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-department-filter">부서</label>
                    <select id="network-department-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="network-unit-filter">Unit</label>
                    <select id="network-unit-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="min-collaboration-filter">최소 협업 횟수</label>
                    <select id="min-collaboration-filter">
                        <option value="5">5회 이상</option>
                        <option value="10" selected>10회 이상</option>
                        <option value="30">30회 이상</option>
                    </select>
                </div>
            </div>
            
            <!-- 2.1 협업을 많이 하는 부서 -->
            <div class="subsection">
                <h3>협업을 많이 하는 부서</h3>
                <div style="background: #e8f4fd; padding: 15px; border-left: 4px solid #0066cc; margin-bottom: 20px; border-radius: 0 5px 5px 0;">
                    <p style="margin: 0; color: #495057; font-size: 0.95em;">
                        <strong>📊 이 차트는 무엇인가요?</strong><br>
                        우리 부서/Unit에 협업 평가를 준 부서를 보여줍니다.<br>
                        • <span style="color: #dc3545;">주의 사항</span>: Unit을 선택하면 차트에는 팀으로 보여지지만 실제로는 해당 Unit의 결과입니다.<br><br>
                        <strong>💡 활용 방법:</strong><br>
                        • <span style="color: #28a745;"><strong>주요 협업 관계 파악</strong></span>: 업무 연계가 가장 많은 부서 파악
                    </p>
                </div>
                <div id="collaboration-frequency-chart-container" class="chart-container"></div>
            </div>

            <!-- 2.2 협업 관계 현황 -->
            <div class="subsection">
                <h3>협업 관계 현황</h3>
                <div id="collaboration-status-chart-container" class="chart-container"></div>
                <div class="collaboration-status-dropdowns">
                    <div class="status-dropdown excellent">
                        <h5>🏆 우수 (75점 이상)</h5>
                        <div class="expander-container">
                            <div class="expander-header" id="excellent-dept-header" onclick="toggleExpander('excellent-dept-expander')">
                                <span>부서 선택 (0개 선택됨)</span>
                                <span class="expander-arrow" id="excellent-dept-arrow">▼</span>
                            </div>
                            <div class="expander-content" id="excellent-dept-expander">
                                <div id="excellent-dept-filter"></div>
                            </div>
                        </div>
                        <div class="dept-count" id="excellent-count">0개 관계</div>
                    </div>
                    <div class="status-dropdown good">
                        <h5>✅ 양호 (60-74점)</h5>
                        <div class="expander-container">
                            <div class="expander-header" id="good-dept-header" onclick="toggleExpander('good-dept-expander')">
                                <span>부서 선택 (0개 선택됨)</span>
                                <span class="expander-arrow" id="good-dept-arrow">▼</span>
                            </div>
                            <div class="expander-content" id="good-dept-expander">
                                <div id="good-dept-filter"></div>
                            </div>
                        </div>
                        <div class="dept-count" id="good-count">0개 관계</div>
                    </div>
                    <div class="status-dropdown caution">
                        <h5>⚠️ 주의 (50-59점)</h5>
                        <div class="expander-container">
                            <div class="expander-header" id="caution-dept-header" onclick="toggleExpander('caution-dept-expander')">
                                <span>부서 선택 (0개 선택됨)</span>
                                <span class="expander-arrow" id="caution-dept-arrow">▼</span>
                            </div>
                            <div class="expander-content" id="caution-dept-expander">
                                <div id="caution-dept-filter"></div>
                            </div>
                        </div>
                        <div class="dept-count" id="caution-count">0개 관계</div>
                    </div>
                    <div class="status-dropdown problem">
                        <h5>🚨 문제 (50점 미만)</h5>
                        <div class="expander-container">
                            <div class="expander-header" id="problem-dept-header" onclick="toggleExpander('problem-dept-expander')">
                                <span>부서 선택 (0개 선택됨)</span>
                                <span class="expander-arrow" id="problem-dept-arrow">▼</span>
                            </div>
                            <div class="expander-content" id="problem-dept-expander">
                                <div id="problem-dept-filter"></div>
                            </div>
                        </div>
                        <div class="dept-count" id="problem-count">0개 관계</div>
                    </div>
                </div>
            </div>

            <!-- 2.3 협업 관계 변화 트렌드 -->
            <div class="subsection">
                <h3>협업 관계 변화 트렌드</h3>
                <div id="collaboration-trend-chart-container" class="chart-container"></div>
            </div>

            <!-- 2.4 협업 후기 -->
            <div class="subsection">
                <h3>협업 후기 <span id="network-reviews-count-display" style="color: #666; font-size: 0.9em;"></span></h3>
                <div class="filters">
                    <div class="filter-group">
                        <label>감정 분류 필터</label>
                        <select id="network-sentiment-filter">
                            <option value="전체">전체 (긍정+부정+중립)</option>
                            <option value="긍정">긍정</option>
                            <option value="부정">부정</option>
                            <option value="중립">중립</option>
                        </select>
                    </div>
                </div>
                <div id="network-reviews-table-container">
                    <table id="network-reviews-table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">연도</th>
                                <th style="width: 120px;">협업 부서</th>
                                <th>후기 내용</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
    <script>
        // 🔒 보안 강화된 하이브리드 데이터 구조
        const hybridData = {"aggregated": {"hospital_yearly": {"2022": {"존중배려": 67.62563279417212, "정보공유": 67.68051434223541, "명확처리": 67.7299703264095, "태도개선": 67.19932977535062, "전반만족": 66.5093175367148, "종합점수": 67.35530224525044, "응답수": 8106}, "2024": {"존중배려": 74.73027462946818, "정보공유": 74.17121046892039, "명확처리": 74.3431810748937, "태도개선": 73.5901226456417, "전반만족": 73.47807113244599, "종합점수": 74.04710769900903, "응답수": 9183}, "2025": {"존중배려": 77.30341070582662, "정보공유": 76.91031868262054, "명확처리": 77.04505038529935, "태도개선": 76.25386260993582, "전반만족": 76.15721557949568, "종합점수": 76.70684571699006, "응답수": 8452}, "2023": {"존중배려": 70.22939743891901, "정보공유": 70.02004559389985, "명확처리": 70.3333857524768, "태도개선": 69.68429360694554, "전반만족": 69.149897814809, "종합점수": 69.86668499175371, "응답수": 12733}}, "division_yearly": {"관리부문": {"2022": {"존중배려": 71.73458725182863, "정보공유": 69.80366492146597, "명확처리": 70.63968668407311, "태도개선": 69.5, "전반만족": 69.69973890339426, "종합점수": 70.26864893062076, "응답수": 1917}, "2023": {"존중배려": 72.61261261261261, "정보공유": 70.91468909582457, "명확처리": 71.7877514259982, "태도개선": 71.2605548854041, "전반만족": 71.05618990384616, "종합점수": 71.51460384153661, "응답수": 3332}, "2024": {"존중배려": 76.59139784946237, "정보공유": 74.65517241379311, "명확처리": 75.07520412548345, "태도개선": 74.19739696312364, "전반만족": 74.49287872248597, "종합점수": 75.00626718213059, "응답수": 2328}, "2025": {"존중배려": 79.61711711711712, "정보공유": 78.11371841155234, "명확처리": 78.55049594229035, "태도개선": 77.87810383747178, "전반만족": 77.98423423423424, "종합점수": 78.39055380459251, "응답수": 2221}}}, "division_comparison": {"2022": {"진료부문": {"존중배려": 65.76483655982229, "정보공유": 67.3529411764706, "명확처리": 66.40972663699937, "태도개선": 66.44108280254777, "전반만족": 65.41269841269842, "종합점수": 66.2648111710568, "응답수": 3151}, "디지털정보혁신본부": {"존중배려": 71.44444444444444, "정보공유": 69.53125, "명확처리": 71.65178571428571, "태도개선": 69.48198198198199, "전반만족": 68.80530973451327, "종합점수": 70.13274336283186, "응답수": 226}, "기획부문": {"존중배려": 67.7710843373494, "정보공유": 65.96385542168674, "명확처리": 71.98795180722891, "태도개선": 67.5925925925926, "전반만족": 65.66265060240964, "종합점수": 67.9066265060241, "응답수": 83}, "관리부문": {"존중배려": 71.73458725182863, "정보공유": 69.80366492146597, "명확처리": 70.63968668407311, "태도개선": 69.5, "전반만족": 69.69973890339426, "종합점수": 70.26864893062076, "응답수": 1917}, "커뮤니케이션실": {"존중배려": 72.43150684931507, "정보공유": 71.91780821917808, "명확처리": 71.06164383561644, "태도개선": 70.34482758620689, "전반만족": 70.13422818791946, "종합점수": 71.59395973154362, "응답수": 149}, "간호부문": {"존중배려": 67.2003659652333, "정보공유": 67.16605672461117, "명확처리": 67.20183486238533, "태도개선": 67.08045977011494, "전반만족": 66.20539798719122, "종합점수": 66.97754345837146, "응답수": 2186}, "기타부문": {"존중배려": 52.25903614457831, "정보공유": 54.51807228915663, "명확처리": 56.174698795180724, "태도개선": 52.86144578313253, "전반만족": 50.903614457831324, "종합점수": 53.3433734939759, "응답수": 166}, "교육부문": {"존중배려": 66.05263157894737, "정보공유": 65.52631578947368, "명확처리": 67.89473684210526, "태도개선": 66.57894736842105, "전반만족": 65.52631578947368, "종합점수": 66.3157894736842, "응답수": 95}, "국제사업실": {"존중배려": 63.52459016393443, "정보공유": 62.704918032786885, "명확처리": 63.52459016393443, "태도개선": 62.295081967213115, "전반만족": 59.42622950819672, "종합점수": 62.295081967213115, "응답수": 61}, "연구부문": {"존중배려": 71.875, "정보공유": 66.31944444444444, "명확처리": 70.13888888888889, "태도개선": 67.36111111111111, "전반만족": 68.40277777777777, "종합점수": 68.81944444444444, "응답수": 72}}, "2024": {"진료부문": {"존중배려": 73.48245109321059, "정보공유": 73.87737478411053, "명확처리": 73.29250720461096, "태도개선": 72.87218695903059, "전반만족": 72.57414339188021, "종합점수": 73.20591196777906, "응답수": 3476}, "디지털정보혁신본부": {"존중배려": 80.39383561643835, "정보공유": 80.65068493150685, "명확처리": 80.39383561643835, "태도개선": 79.96575342465754, "전반만족": 79.70890410958904, "종합점수": 80.22260273972603, "응답수": 292}, "기획부문": {"존중배려": 74.38524590163935, "정보공유": 71.92622950819673, "명확처리": 76.43442622950819, "태도개선": 70.66115702479338, "전반만족": 71.92622950819673, "종합점수": 73.11475409836065, "응답수": 122}, "관리부문": {"존중배려": 76.59139784946237, "정보공유": 74.65517241379311, "명확처리": 75.07520412548345, "태도개선": 74.19739696312364, "전반만족": 74.49287872248597, "종합점수": 75.00626718213059, "응답수": 2328}, "커뮤니케이션실": {"존중배려": 75.35714285714286, "정보공유": 75.17857142857143, "명확처리": 76.78571428571429, "태도개선": 74.10071942446044, "전반만족": 74.28057553956835, "종합점수": 75.16664285714286, "응답수": 140}, "간호부문": {"존중배려": 74.6319018404908, "정보공유": 73.74284546197875, "명확처리": 74.44807849550286, "태도개선": 73.93179950698439, "전반만족": 73.703022875817, "종합점수": 74.04774193548387, "응답수": 2449}, "기타부문": {"존중배려": 58.6, "정보공유": 63.4, "명확처리": 64.4, "태도개선": 60.8, "전반만족": 59.8, "종합점수": 61.4, "응답수": 125}, "교육부문": {"존중배려": 79.7872340425532, "정보공유": 78.72340425531915, "명확처리": 79.25531914893617, "태도개선": 78.72340425531915, "전반만족": 77.3936170212766, "종합점수": 78.77659574468085, "응답수": 94}, "국제사업실": {"존중배려": 71.03174603174604, "정보공유": 72.22222222222223, "명확처리": 71.42857142857143, "태도개선": 68.65079365079364, "전반만족": 67.06349206349206, "종합점수": 70.07936507936508, "응답수": 63}, "연구부문": {"존중배려": 78.19148936170212, "정보공유": 76.59574468085107, "명확처리": 77.3936170212766, "태도개선": 74.73118279569893, "전반만족": 76.0752688172043, "종합점수": 76.48936170212765, "응답수": 94}}, "2025": {"진료부문": {"존중배려": 76.21008403361344, "정보공유": 76.9334229993275, "명확처리": 76.18606998654106, "태도개선": 75.70148749154835, "전반만족": 75.48755884330868, "종합점수": 76.1031317204301, "응답수": 2976}, "디지털정보혁신본부": {"존중배려": 79.75409836065573, "정보공유": 77.71381578947368, "명확처리": 78.60655737704919, "태도개선": 77.88778877887789, "전반만족": 77.95081967213115, "종합점수": 78.3264918032787, "응답수": 305}, "기획부문": {"존중배려": 75.26315789473684, "정보공유": 75.52631578947368, "명확처리": 75.52631578947368, "태도개선": 74.21875, "전반만족": 72.65625, "종합점수": 74.32291666666667, "응답수": 96}, "관리부문": {"존중배려": 79.61711711711712, "정보공유": 78.11371841155234, "명확처리": 78.55049594229035, "태도개선": 77.87810383747178, "전반만족": 77.98423423423424, "종합점수": 78.39055380459251, "응답수": 2221}, "커뮤니케이션실": {"존중배려": 79.52380952380952, "정보공유": 78.06603773584905, "명확처리": 78.73831775700934, "태도개선": 77.35849056603773, "전반만족": 76.6355140186916, "종합점수": 77.71420560747664, "응답수": 107}, "간호부문": {"존중배려": 76.72161936560934, "정보공유": 76.26199415936587, "명확처리": 76.8836333193805, "태도개선": 75.94221105527639, "전반만족": 75.81385642737897, "종합점수": 76.30699332777314, "응답수": 2398}, "기타부문": {"존중배려": 57.7319587628866, "정보공유": 60.45918367346939, "명확처리": 61.98979591836735, "태도개선": 58.41836734693877, "전반만족": 57.90816326530612, "종합점수": 59.2219387755102, "응답수": 98}, "교육부문": {"존중배려": 82.17821782178218, "정보공유": 79.95049504950495, "명확처리": 82.17821782178218, "태도개선": 79.95049504950495, "전반만족": 80.44554455445545, "종합점수": 80.94059405940594, "응답수": 101}, "국제사업실": {"존중배려": 75.71428571428571, "정보공유": 73.57142857142857, "명확처리": 73.92857142857143, "태도개선": 72.5, "전반만족": 71.42857142857143, "종합점수": 73.42857142857143, "응답수": 70}, "연구부문": {"존중배려": 80.3125, "정보공유": 78.4375, "명확처리": 80.3125, "태도개선": 76.26582278481013, "전반만족": 78.4375, "종합점수": 78.6875, "응답수": 80}}, "2023": {"진료부문": {"존중배려": 68.94984326018809, "정보공유": 70.05023022185014, "명확처리": 69.69411271736853, "태도개선": 69.15250681770506, "전반만족": 68.35390085756119, "종합점수": 69.22840752351097, "응답수": 4785}, "디지털정보혁신본부": {"존중배려": 77.12328767123287, "정보공유": 74.93150684931507, "명확처리": 74.65753424657534, "태도개선": 73.7603305785124, "전반만족": 74.65753424657534, "종합점수": 75.03424657534246, "응답수": 365}, "기획부문": {"존중배려": 69.0119760479042, "정보공유": 65.86826347305389, "명확처리": 69.46107784431138, "태도개선": 67.3780487804878, "전반만족": 66.46706586826348, "종합점수": 67.57485029940119, "응답수": 167}, "관리부문": {"존중배려": 72.61261261261261, "정보공유": 70.91468909582457, "명확처리": 71.7877514259982, "태도개선": 71.2605548854041, "전반만족": 71.05618990384616, "종합점수": 71.51460384153661, "응답수": 3332}, "커뮤니케이션실": {"존중배려": 72.39583333333333, "정보공유": 73.18652849740933, "명확처리": 71.76165803108809, "태도개선": 70.05208333333333, "전반만족": 70.46632124352331, "종합점수": 71.51554404145078, "응답수": 193}, "간호부문": {"존중배려": 69.94680851063829, "정보공유": 69.59562176953482, "명확처리": 70.13677811550151, "태도개선": 69.76815131177547, "전반만족": 68.91152325934935, "종합점수": 69.64195077484048, "응답수": 3291}, "기타부문": {"존중배려": 45.69377990430622, "정보공유": 50.95693779904306, "명확처리": 52.16346153846154, "태도개선": 47.45145631067961, "전반만족": 46.875, "종합점수": 48.516746411483254, "응답수": 209}, "교육부문": {"존중배려": 77.64084507042253, "정보공유": 72.71126760563381, "명확처리": 75.52816901408451, "태도개선": 73.21428571428571, "전반만족": 75.17605633802818, "종합점수": 74.92957746478874, "응답수": 142}, "국제사업실": {"존중배려": 68.05555555555556, "정보공유": 69.44444444444444, "명확처리": 68.88888888888889, "태도개선": 67.13483146067416, "전반만족": 66.38888888888889, "종합점수": 68.05555555555556, "응답수": 90}, "연구부문": {"존중배려": 74.37106918238993, "정보공유": 71.38364779874213, "명확처리": 72.32704402515724, "태도개선": 70.80645161290323, "전반만족": 72.0125786163522, "종합점수": 72.30345911949685, "응답수": 159}}}, "team_ranking": {"2022": [{"department": "재무회계팀", "score": 77.5, "count": 36, "rank": 1}, {"department": "보안관리팀", "score": 76.7, "count": 82, "rank": 2}, {"department": "사회복지팀", "score": 75.9, "count": 13, "rank": 3}, {"department": "중앙공급팀", "score": 73.7, "count": 63, "rank": 4}, {"department": "총무팀", "score": 73.2, "count": 121, "rank": 5}, {"department": "시설팀", "score": 72.5, "count": 305, "rank": 6}, {"department": "인사팀", "score": 72.3, "count": 75, "rank": 7}, {"department": "의공팀", "score": 69.8, "count": 400, "rank": 8}, {"department": "원무팀", "score": 69.4, "count": 516, "rank": 9}, {"department": "자재팀", "score": 68.1, "count": 126, "rank": 10}, {"department": "법무팀", "score": 68.0, "count": 47, "rank": 11}, {"department": "후생사업팀", "score": 66.7, "count": 17, "rank": 12}, {"department": "적정진료팀", "score": 61.1, "count": 88, "rank": 13}, {"department": "노사협력팀", "score": 58.0, "count": 28, "rank": 14}], "2023": [{"department": "사회복지팀", "score": 90.0, "count": 16, "rank": 1}, {"department": "재무회계팀", "score": 83.4, "count": 92, "rank": 2}, {"department": "보안관리팀", "score": 77.9, "count": 140, "rank": 3}, {"department": "인사팀", "score": 76.7, "count": 129, "rank": 4}, {"department": "후생사업팀", "score": 76.6, "count": 28, "rank": 5}, {"department": "시설팀", "score": 73.7, "count": 458, "rank": 6}, {"department": "중앙공급팀", "score": 73.2, "count": 103, "rank": 7}, {"department": "의공팀", "score": 72.4, "count": 675, "rank": 8}, {"department": "자재팀", "score": 72.1, "count": 256, "rank": 9}, {"department": "총무팀", "score": 71.7, "count": 208, "rank": 10}, {"department": "원무팀", "score": 69.7, "count": 967, "rank": 11}, {"department": "법무팀", "score": 60.0, "count": 88, "rank": 12}, {"department": "적정진료팀", "score": 58.6, "count": 144, "rank": 13}, {"department": "노사협력팀", "score": 56.6, "count": 28, "rank": 14}], "2024": [{"department": "재무회계팀", "score": 86.8, "count": 58, "rank": 1}, {"department": "보안관리팀", "score": 82.4, "count": 199, "rank": 2}, {"department": "후생사업팀", "score": 81.2, "count": 22, "rank": 3}, {"department": "사회복지팀", "score": 77.6, "count": 17, "rank": 4}, {"department": "원무팀", "score": 76.3, "count": 602, "rank": 5}, {"department": "의공팀", "score": 75.9, "count": 456, "rank": 6}, {"department": "총무팀", "score": 75.0, "count": 147, "rank": 7}, {"department": "시설팀", "score": 74.6, "count": 329, "rank": 8}, {"department": "중앙공급팀", "score": 72.8, "count": 77, "rank": 9}, {"department": "인사팀", "score": 72.6, "count": 89, "rank": 10}, {"department": "자재팀", "score": 72.2, "count": 145, "rank": 11}, {"department": "법무팀", "score": 64.3, "count": 47, "rank": 12}, {"department": "적정진료팀", "score": 60.5, "count": 120, "rank": 13}, {"department": "노사협력팀", "score": 58.5, "count": 20, "rank": 14}], "2025": [{"department": "보안관리팀", "score": 84.0, "count": 128, "rank": 1}, {"department": "재무회계팀", "score": 83.1, "count": 53, "rank": 2}, {"department": "사회복지팀", "score": 82.7, "count": 11, "rank": 3}, {"department": "후생사업팀", "score": 81.7, "count": 18, "rank": 4}, {"department": "시설팀", "score": 80.7, "count": 357, "rank": 5}, {"department": "의공팀", "score": 80.5, "count": 499, "rank": 6}, {"department": "원무팀", "score": 79.7, "count": 530, "rank": 7}, {"department": "중앙공급팀", "score": 79.6, "count": 92, "rank": 8}, {"department": "총무팀", "score": 77.3, "count": 143, "rank": 9}, {"department": "인사팀", "score": 76.3, "count": 85, "rank": 10}, {"department": "자재팀", "score": 72.4, "count": 143, "rank": 11}, {"department": "적정진료팀", "score": 63.7, "count": 107, "rank": 12}, {"department": "노사협력팀", "score": 61.5, "count": 10, "rank": 13}, {"department": "법무팀", "score": 60.3, "count": 45, "rank": 14}]}, "metadata": {"calculation_date": "2025-07-15T08:39:09.559632", "total_responses": 38474, "target_department": "노사협력팀", "target_division": "관리부문", "security_level": "AGGREGATED_ONLY"}}, "rawData": [{"설문시행연도": "2022", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "인사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "개선이 필요한 영역에 대해 주관 부서가 좀 더 적극적으로 활동해 주시면 좋겠습니다.", "감정_분류": "부정", "핵심_키워드": ["개선", "주관부서", "적극적_활동"]}, {"설문시행연도": "2022", "평가부서": "심장병원간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "고객만족팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "특수검사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "자재팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "암병원간호2팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 75.0, "태도개선": 25.0, "전반만족": 75.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "특수검사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "늘 친절하고 신속하게 잘 처리해 주십니다.", "감정_분류": "긍정", "핵심_키워드": ["친절", "신속", "업무 처리"]}, {"설문시행연도": "2022", "평가부서": "후생사업팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "외과간호1팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 0.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 0.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "특수검사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "직원 의무실에서 약을 몇 차례 받았는데, 응대가 적극적이지 못했습니다.", "감정_분류": "부정", "핵심_키워드": ["의무실", "응대", "서비스"]}, {"설문시행연도": "2022", "평가부서": "IT서비스팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "특별히 아쉬운 부분이 없음.", "감정_분류": "긍정", "핵심_키워드": ["아쉬움 없음", "만족", "긍정적"]}, {"설문시행연도": "2022", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "경청은 해주었으나, 그 이상의 추가 조치는 없었습니다.", "감정_분류": "부정", "핵심_키워드": ["경청", "소통", "조치"]}, {"설문시행연도": "2022", "평가부서": "내과간호2팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "항상 직원을 위해 힘써주셔서 감사합니다. 다만, 직원 건강 검진 항목이 너무 부족합니다. 내시경, 초음파 등 선택할 수 있는 항목이 많이 추가되었으면 합니다.", "감정_분류": "부정", "핵심_키워드": ["건강 검진", "검진 항목", "내시경", "초음파", "항목 추가"]}, {"설문시행연도": "2022", "평가부서": "내과간호1팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "간호교육행정팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 75.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "TF(태스크포스) 업무 특성상 주관 부서의 부재로 업무 분장에 어려움이 있었습니다. 또한, 서로의 업무가 아니라는 책임 회피적인 회의 분위기에 아쉬움을 느꼈습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 분장", "주관 부서", "책임 회피", "회의 분위기", "협업"]}, {"설문시행연도": "2022", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "방사선종양팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 0.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "문의사항에 대해서 응대가 불만족스럽습니다.", "감정_분류": "부정", "핵심_키워드": ["문의사항", "응대", "불만족"]}, {"설문시행연도": "2022", "평가부서": "응급간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "암병원간호2팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "평가부서": "아카데미운영팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "신입직원 관련 업무 진행 시 정보 공유와 원활한 협업에 일부 어려움이 있었으나, 빠르고 정확한 문의 답변과 상호 지원적인 태도로 업무에 도움을 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["정보 공유", "협업", "문의 답변", "업무 지원", "감사"]}, {"설문시행연도": "2022", "평가부서": "AGS팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "다소 방어적인 태도를 보입니다.", "감정_분류": "부정", "핵심_키워드": ["방어적", "태도", "소통"]}, {"설문시행연도": "2022", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "감염관리실이 정책 결정만을 받아 단순히 시행하는 부서로 인식되어 협업의 의미를 찾기 어렵습니다.", "감정_분류": "부정", "핵심_키워드": ["협업", "업무 방식", "정책 결정", "역할 인식"]}, {"설문시행연도": "2023", "평가부서": "운영팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "청라병원 사용자 협의 과정에서 본원 현황과 개선 필요점, 그리고 설계에 반영 가능한 운영안에 대해 적극적인 의견과 자료 공유가 이루어졌습니다.", "감정_분류": "긍정", "핵심_키워드": ["사용자 협의", "개선", "운영안", "적극적 소통", "자료 공유"]}, {"설문시행연도": "2023", "평가부서": "진단검사의학팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "직접 병원의 곳곳을 다니며 꼼꼼하게 챙기는 모습과, 형식적인 점검이 아닌 직원과 병원의 안전을 위해 애써주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["꼼꼼함", "병원 안전", "직원 안전", "노력", "감사"]}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "함께 진행하는 업무에서 특정 담당자의 업무 처리 미숙으로 인해 진행이 지연되는 경우가 많고, 부서 차원에서도 적극적인 해결 의지가 부족해 보입니다. 담당자의 업무 역량이 미흡하다면 부서 차원의 조치가 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 지연", "업무 역량", "부서 조치", "해결 의지"]}, {"설문시행연도": "2023", "평가부서": "중앙공급팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "노사 협력팀 직원분들의 개인적인 인맥을 통한 일정 변경 요청이 잦아 보입니다. 병원 내 자동화된 예약 시스템의 취지를 이해하고, 개인적인 일정 요청은 자제해 주시길 바랍니다.", "감정_분류": "부정", "핵심_키워드": ["지인", "일정 변경", "예약 시스템", "업무 요청"]}, {"설문시행연도": "2023", "평가부서": "재해예방관리실", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "문제에 대하여 함께 고민하고 해결 방법을 제시합니다.", "감정_분류": "긍정", "핵심_키워드": ["문제 해결", "협력", "방법 제시"]}, {"설문시행연도": "2023", "평가부서": "고객만족팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 50.0, "전반만족": 0.0, "종합점수": 10.0, "정제된_텍스트": "협업 업무 진행 시 주관 부서 담당자의 책임감이 부족하게 느껴져 아쉬웠습니다.", "감정_분류": "부정", "핵심_키워드": ["협업", "업무", "책임감", "아쉬움"]}, {"설문시행연도": "2023", "평가부서": "시설팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족"]}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "연구지원팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "AGS팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "업무 협의 내용 이행이 미흡했으며, 업무 개선 의지가 다소 부족해 보입니다. 또한 전화 응대 태도 및 업무 수행의 정확성 개선이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 협의", "업무 개선", "전화 응대", "업무 수행"]}, {"설문시행연도": "2023", "평가부서": "방사선종양팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "소화기내시경팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "AGS팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 75.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "유해물질 주관 부서로서 현업 부서에 실질적인 가이드를 제공했으면 좋겠습니다.", "감정_분류": "부정", "핵심_키워드": ["유해물질", "주관부서", "현업부서", "가이드", "업무개선"]}, {"설문시행연도": "2023", "평가부서": "재해예방관리실", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "안전조치 및 보건조치 업무 협조에 있어 긍정적입니다.", "감정_분류": "긍정", "핵심_키워드": ["안전조치", "보건조치", "업무 협조", "긍정"]}, {"설문시행연도": "2023", "평가부서": "고객만족팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "고객만족팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "연구지원팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "연구지원팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 55.0, "정제된_텍스트": "사후 안내가 부족하고 본인의 입장만 주장하여, 좀 더 자세한 안내가 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["사후 안내", "정보 제공", "소통", "개선"]}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 15.0, "정제된_텍스트": "기존 방식이나 규정만을 고수하기보다, 업무 맥락을 고려하여 유연하게 처리하려는 의지를 보여주셨으면 합니다. 이는 때론 잘못된 관행을 발견하고 불합리한 규정 개정의 계기가 될 수도 있습니다. 더 넓은 안목으로 병원 업무에 협업하는 팀이 되기를 바랍니다. 감사합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 관행", "규정 개선", "협업", "유연성", "소통"]}, {"설문시행연도": "2023", "평가부서": "재해예방관리실", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "빠르고 정확한 답변으로 업무에 도움이 많이 됐습니다.", "감정_분류": "긍정", "핵심_키워드": ["빠른 답변", "정확성", "업무 효율"]}, {"설문시행연도": "2023", "평가부서": "시설팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "법무팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "적극적인 협업 부분이 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["협업", "적극성", "아쉬움"]}, {"설문시행연도": "2023", "평가부서": "시설팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "대체적으로 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족", "대체적", "원활"]}, {"설문시행연도": "2023", "평가부서": "영상의학팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "간호교육행정팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "노무관리는 다양하고 민감한 이슈들이 많은데, 문의 시 자세히 알려주고 조율할 수 있는 방법을 제안합니다.", "감정_분류": "긍정", "핵심_키워드": ["노무관리", "자세한 설명", "조율", "해결책 제안"]}, {"설문시행연도": "2024", "평가부서": "법무팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "중앙공급팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "고객만족팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "재해예방관리실", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "문의나 처리 요청을 해도 결과가 항상 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["문의", "처리", "결과", "아쉬움"]}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 0.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "직원의무실 담당자와의 업무 협의 과정은 전반적으로 만족스럽지만, 그 외 업무에 대한 정보 공유나 협의 시에는 다소 불편함이 있습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 협의", "정보 공유", "불편함"]}, {"설문시행연도": "2024", "평가부서": "AGS팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 25.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "다부서 간 개선이 필요한 업무 진행 시 적극적인 개입이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["다부서 협업", "업무 개선", "개입"]}, {"설문시행연도": "2024", "평가부서": "시설팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "시설팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "회의 시, 타 부서의 의견을 적극적으로 반영하려는 노력과 의지가 엿보입니다.", "감정_분류": "긍정", "핵심_키워드": ["의견 반영", "소통", "노력", "협업"]}, {"설문시행연도": "2024", "평가부서": "중환자간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 15.0, "정제된_텍스트": "담당자가 명확한 업무 범위와 목적성에 대한 이해가 부족한 듯하며, 자신의 업무가 아니라는 태도를 보여 불만족스럽습니다. 협업하는 입장에서 최대한 존중하며 불편사항을 이해하려 노력함에도 불구하고, 스스로를 피해자라고 여기고 상대방을 존중하는 태도가 부족하다고 느껴져 협업에 어려움을 겪고 있습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 이해", "태도", "존중 부족", "협업 어려움", "불만족"]}, {"설문시행연도": "2024", "평가부서": "인사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 0.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "인사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "외과간호2팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 5.0, "정제된_텍스트": "예방접종 기간이 신청했던 장기 휴가와 겹쳐 문의했습니다. 문의했을 때 담당 직원의 응대가 다소 불친절하게 느껴졌습니다. 간단한 공감이나 설명에도 큰 어려움이 없을 텐데, 휴가를 미리 고지했음에도 불구하고 휴가 중 특정 날짜를 언급하며 접종을 안내하는 방식으로 불필요하게 시간을 소모했습니다. 대안이 없다면 소중한 장기 휴가 중이라도 방문하겠지만, 담당 직원의 태도가 매우 불쾌했습니다. 정중하게 예방접종을 받지 않아도 되는지 문의했지만, 해당 직원은 아무런 답변도 없이 제 질문을 무시했습니다. 저 외에도 많은 직원들이 문의할 것으로 예상되며, 노사협력팀이 직원들이 선호하는 부서임을 감안할 때, 만약 업무 과중이라면 시스템 개선이 필요하고, 그렇지 않다면 응대 태도에 대한 교육이 필요하다고 생각합니다.", "감정_분류": "부정", "핵심_키워드": ["예방접종", "직원 응대", "소통 부재", "시스템 개선", "태도 교육"]}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "노사 협의나 단체 교섭 등 노조 활동 시, 일반 직원들이 근무상 어려움을 겪는 경우가 발생합니다.", "감정_분류": "부정", "핵심_키워드": ["노조 활동", "근무 어려움", "직원 피해"]}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "늘 개선하기 위해 고민해주시고 도움주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["개선", "고민", "도움", "감사"]}, {"설문시행연도": "2024", "평가부서": "진단검사의학팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "신입직원 예방접종(면역관리)이 보다 나은 방향으로 개선될 수 있도록 항상 함께 고민해주시고 많은 업무 협업해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["예방접종", "면역관리", "업무 협업", "개선", "감사"]}, {"설문시행연도": "2024", "평가부서": "병리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "안전한 직원 관리를 위해 애써주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["직원관리", "안전", "감사", "노력"]}, {"설문시행연도": "2025", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "외과간호2팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "미화 노조 관련 사안을 세세하게 확인하고 잘 정리하여 알려주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["미화 노조", "정보 확인", "정보 정리", "소통", "감사"]}, {"설문시행연도": "2025", "평가부서": "인사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 75.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "외래간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "AGS팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 25.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "주어진 업무에 대해서는 명확한 가이드를 받을 수 있었습니다. 하지만 정해진 범위 외의 내용에 대해서는 도움을 받기 어려워 아쉬웠습니다.", "감정_분류": "부정", "핵심_키워드": ["업무", "가이드", "범위", "아쉬움"]}, {"설문시행연도": "2025", "평가부서": "특수검사팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "평가부서": "소화기내시경팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 25.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 45.0, "정제된_텍스트": "사건사고보고를 위해 방문했을 때, 마치 개인의 잘못인 양 책임을 묻는 듯한 느낌을 받아 불쾌했습니다.", "감정_분류": "부정", "핵심_키워드": ["사건사고보고", "책임", "불쾌", "소통"]}, {"설문시행연도": "2025", "평가부서": "수술간호팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "최근 노무팀의 찾아가는 노무 상담 시간이 매우 좋았습니다. 현장 어려움을 바로 질문하고 서로 의견을 나눌 수 있어 유익한 시간이라고 생각합니다.", "감정_분류": "긍정", "핵심_키워드": ["노무 상담", "현장 어려움", "의견 교환", "유익"]}, {"설문시행연도": "2025", "평가부서": "감염관리팀", "피평가부문": "관리부문", "피평가부서": "노사협력팀", "피평가Unit": "노사협력 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "담당하는 업무에 대한 책임감이 조금 더 있으시면 좋을 것 같습니다.", "감정_분류": "부정", "핵심_키워드": ["업무", "책임감", "개선"]}], "security": {"target_department": "노사협력팀", "target_division": "관리부문", "data_scope": "노사협력팀 관련 데이터만 포함", "security_level": "HIGH", "aggregated_sections": ["전체 연도별", "부문별 연도별", "부문 비교", "팀 순위"], "filtered_sections": ["부서 상세분석", "네트워크 분석"]}};
        const rawData = hybridData.rawData;  // 필터링된 부서 데이터만 포함
        const aggregatedData = hybridData.aggregated;  // 미리 계산된 집계 데이터
        const securityInfo = hybridData.security;
        
        const scoreCols = ['존중배려', '정보공유', '명확처리', '태도개선', '전반만족', '종합점수'];
        const allYears = [...new Set(rawData.map(item => item['설문시행연도']))].sort();
        // 부문 비교용: 집계 데이터에서 모든 부문 가져오기
        const allDivisions = Object.keys(aggregatedData.division_comparison).length > 0 
            ? [...new Set(Object.values(aggregatedData.division_comparison).flatMap(yearData => Object.keys(yearData)))].sort((a, b) => a.localeCompare(b, 'ko'))
            : ["관리부문"];
        const layoutFont = { size: 14 };
        
        // 보안 정보 콘솔 출력
        console.log('🔒 보안 정보:', securityInfo);
        console.log('📊 데이터 범위:', securityInfo.data_scope);

        const departmentUnitMap = rawData.reduce((acc, item) => {
            const dept = item['피평가부서'];
            const unit = item['피평가Unit'];
            if (dept && dept !== 'N/A' && unit && unit !== 'N/A') {
                if (!acc[dept]) { acc[dept] = new Set(); }
                acc[dept].add(unit);
            }
            return acc;
        }, {});
        for (const dept in departmentUnitMap) {
            departmentUnitMap[dept] = [...departmentUnitMap[dept]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function populateFilters() {
            // 연도 필터 설정
            const yearSelect = document.getElementById('year-filter');
            const years = [...new Set(rawData.map(item => item['설문시행연도']))].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
            yearSelect.innerHTML = ['전체', ...years].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.addEventListener('change', updateDashboard);
            
            // 부서 필터를 노사협력팀으로 고정
            const deptSelect = document.getElementById('department-filter');
            deptSelect.innerHTML = `<option value="노사협력팀">노사협력팀</option>`;
            deptSelect.value = "노사협력팀";
            deptSelect.addEventListener('change', updateUnitFilter);
            
            // Unit 필터 초기화
            updateUnitFilter();
        }

        function updateUnitFilter() {
            const deptSelect = document.getElementById('department-filter');
            const unitSelect = document.getElementById('unit-filter');
            const selectedDept = deptSelect.value;

            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];

            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            // Unit 필터 변경 시 차트 실시간 업데이트
            unitSelect.addEventListener('change', updateDashboard);
        }

        function setupDivisionChart() {
            const select = document.getElementById('division-chart-filter');
            // 고정값: 관리부문만 선택 가능
            select.innerHTML = `<option value="관리부문">관리부문</option>`;
            select.value = "관리부문";
            select.addEventListener('change', updateDivisionYearlyChart);
            createCheckboxFilter('division-score-filter', scoreCols, 'division-score', updateDivisionYearlyChart);
            // 초기 차트 표시
            updateDivisionYearlyChart();
        }
        
        function setupComparisonChart() {
            const yearSelect = document.getElementById('comparison-year-filter');
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1]; // Default to last year
            yearSelect.addEventListener('change', updateYearlyDivisionComparisonChart);
            createCheckboxFilter('comparison-division-filter', allDivisions, 'comparison-division', updateYearlyDivisionComparisonChart, true);
        }

        function getFilteredData() {
            let filteredData = [...rawData];
            const filters = { 'year-filter': '설문시행연도', 'department-filter': '피평가부서', 'unit-filter': '피평가Unit' };
            for (const [elementId, dataCol] of Object.entries(filters)) {
                const selectedValue = document.getElementById(elementId).value;
                if (selectedValue !== '전체') { filteredData = filteredData.filter(item => item[dataCol] == selectedValue); }
            }
            return filteredData;
        }

        function updateDashboard() {
            const filteredData = getFilteredData();
            updateMetrics(filteredData);
            updateDrilldownChart(filteredData);
            updateSentimentChart(filteredData);
            updateReviewsTable(filteredData);
            updateKeywordAnalysis(filteredData);
            updateYearlyComparisonChart();
            updateUnitComparisonChart();
        }
        
        function calculateAverages(data) {
            const averages = {};
            scoreCols.forEach(col => {
                const total = data.reduce((sum, item) => sum + (item[col] || 0), 0);
                averages[col] = data.length > 0 ? (total / data.length) : 0;
            });
            return averages;
        }

        function updateMetrics(data) {
            const container = document.getElementById('metrics-container');
            if (data.length === 0) { container.innerHTML = "<p style='text-align:center;'>선택된 조건에 해당하는 데이터가 없습니다.</p>"; return; }
            const averages = calculateAverages(data);
            container.innerHTML = `<div class="metric"><div class="metric-value">${data.length}</div><div class="metric-label">응답 수</div></div><div class="metric"><div class="metric-value">${averages['종합점수'].toFixed(1)}</div><div class="metric-label">종합점수</div></div>`;
        }
        
        function updateDrilldownChart(data) {
            const container = document.getElementById('drilldown-chart-container');
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (data.length === 0 || selectedScores.length === 0) { 
                const message = data.length > 0 ? '표시할 문항을 선택해주세요.' : '';
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: message, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const averages = calculateAverages(data);
            const chartData = [{ x: selectedScores, y: selectedScores.map(col => averages[col].toFixed(1)), type: 'bar', text: selectedScores.map(col => averages[col].toFixed(1)), textposition: 'outside', textfont: { size: 14 }, marker: { color: '#6a89cc' }, hovertemplate: '%{x}: %{y}<extra></extra>' }];
            const selectedYear = document.getElementById('year-filter').value;
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            
            // 제목 생성
            let titleParts = [];
            if (selectedDept !== '전체') { titleParts.push(selectedDept); }
            if (selectedUnit !== '전체') { titleParts.push(selectedUnit); }
            
            const titlePrefix = titleParts.length > 0 ? titleParts.join(' > ') : '부서, Unit';
            const yearSuffix = selectedYear === '전체' ? ' (전체 연도)' : ` (${selectedYear})`;
            const title = `<b>${titlePrefix} 문항 점수${yearSuffix}</b>`;
            const layout = { title: title, yaxis: { title: '점수', range: [0, 100] }, font: layoutFont, hovermode: 'closest', margin: { l: 60, r: 60, t: 80, b: 60 } };
            Plotly.react(container, chartData, layout);
        }
        
        function updateHospitalYearlyChart() {
            const container = document.getElementById('hospital-yearly-chart-container');
            const selectedScores = Array.from(document.querySelectorAll('input[name="hospital-score"]:checked')).map(cb => cb.value);
            
            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 🔒 보안 강화: 미리 계산된 집계 데이터 사용
            const hospitalData = aggregatedData.hospital_yearly;
            const years = Object.keys(hospitalData).sort();
            const traces = [];

            selectedScores.forEach(col => {
                const y_values = years.map(year => hospitalData[year][col] ? hospitalData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => hospitalData[year]['응답수'] || 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3 }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: '<b>[전체] 연도별 문항 점수</b>',
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateDivisionYearlyChart() {
            const container = document.getElementById('division-yearly-chart-container');
            const selectedDivision = document.getElementById('division-chart-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="division-score"]:checked')).map(cb => cb.value);

            // 관리부문로 고정되어 있으므로 선택 확인 불필요

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 🔒 보안 강화: 미리 계산된 부문별 집계 데이터 사용
            const divisionData = aggregatedData.division_yearly[selectedDivision] || {};
            const years = Object.keys(divisionData).sort();
            const traces = [];

            selectedScores.forEach(col => {
                const y_values = years.map(year => divisionData[year] && divisionData[year][col] ? divisionData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => divisionData[year] ? divisionData[year]['응답수'] || 0 : 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3 }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: `<b>[${selectedDivision}] 연도별 문항 점수</b>`,
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateYearlyDivisionComparisonChart() {
            const container = document.getElementById('comparison-chart-container');
            const selectedYear = document.getElementById('comparison-year-filter').value;
            const selectedDivisions = Array.from(document.querySelectorAll('input[name="comparison-division"]:checked')).map(cb => cb.value);

            if (selectedDivisions.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '비교할 부문을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 🔒 보안 강화: 미리 계산된 부문 비교 집계 데이터 사용 (모든 부문 포함)
            const comparisonData = aggregatedData.division_comparison[selectedYear] || {};
            
            const divisions = selectedDivisions.filter(div => comparisonData[div]).sort((a,b) => a.localeCompare(b, 'ko'));
            const avgScores = divisions.map(div => comparisonData[div]['종합점수'] ? comparisonData[div]['종합점수'].toFixed(1) : '0.0');

            const trace = [{ x: divisions, y: avgScores, type: 'bar', text: avgScores, textposition: 'outside', textfont: { size: 14 }, hovertemplate: '%{x}: %{y}<extra></extra>' }];
            const layout = {
                title: `<b>${selectedYear} 부문별 점수 비교</b>`,
                yaxis: { title: '점수', range: [0, 100] },
                font: layoutFont,
                height: 500,
                barmode: 'group',
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };
            Plotly.react(container, trace, layout);
        }

        function updateSentimentChart(data) {
            const container = document.getElementById('sentiment-chart-container');
            
            if (data.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류가 있는 데이터만 필터링
            const validSentimentData = data.filter(item => {
                const sentiment = item['감정_분류'];
                return sentiment && sentiment !== 'N/A' && sentiment !== '알 수 없음';
            });

            if (validSentimentData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '감정 분류 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류별 집계 (알 수 없음 제외)
            const sentimentCounts = {};
            validSentimentData.forEach(item => {
                const sentiment = item['감정_분류'];
                sentimentCounts[sentiment] = (sentimentCounts[sentiment] || 0) + 1;
            });

            // 원하는 순서로 감정 분류 고정
            const desiredOrder = ['긍정', '부정', '중립'];
            const sentiments = desiredOrder.filter(sentiment => sentimentCounts[sentiment] > 0);
            const counts = sentiments.map(sentiment => sentimentCounts[sentiment]);
            const total = counts.reduce((sum, count) => sum + count, 0);
            const percentages = counts.map(count => ((count / total) * 100).toFixed(1));

            // 색상 매핑
            const colorMap = {
                '긍정': '#2E8B57',
                '부정': '#DC143C', 
                '중립': '#4682B4',
                '알 수 없음': '#808080'
            };
            const colors = sentiments.map(sentiment => colorMap[sentiment] || '#808080');

            const trace = {
                x: sentiments,
                y: counts,
                type: 'bar',
                text: counts.map((count, idx) => `${count}건 (${percentages[idx]}%)`),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: colors },
                hovertemplate: '%{x}: %{y}건 (%{text})<extra></extra>'
            };

            const layout = {
                title: '<b>감정 분류별 응답 분포</b>',
                height: 400,
                xaxis: { title: '감정 분류' },
                yaxis: { title: '응답 수', rangemode: 'tozero', range: [0, Math.max(...counts) * 1.15] },
                font: layoutFont,
                hovermode: 'closest',
                showlegend: false,
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };

            Plotly.react(container, [trace], layout);
        }


        function updateReviewsTable(data = null) {
            const tbody = document.querySelector("#reviews-table tbody");
            
            if (data === null) { data = getFilteredData(); }
            
            const selectedSentiments = Array.from(document.querySelectorAll('input[name="review-sentiment"]:checked')).map(cb => cb.value);
            
            let filteredData = data;
            if (selectedSentiments.length > 0 && !selectedSentiments.includes('전체')) {
                filteredData = data.filter(item => selectedSentiments.includes(item['감정_분류']));
            }
            
            const reviews = filteredData.map(item => ({ 
                year: item['설문시행연도'], 
                review: item['정제된_텍스트'],
                sentiment: item['감정_분류'] || '알 수 없음'
            })).filter(r => r.review && r.review !== 'N/A')
            .sort((a, b) => b.year - a.year)
            .slice(0, 40000); // 최대 40000개만 표시
            
            // 후기 개수 표시 업데이트
            const countDisplay = document.getElementById('reviews-count-display');
            if (countDisplay) {
                countDisplay.textContent = `(${reviews.length}건)`;
            }
            
            tbody.innerHTML = (reviews.length > 0) ? 
                reviews.map(r => `<tr><td>${r.year}</td><td>${r.review} <span style="color: #666; font-size: 0.9em;">[${r.sentiment}]</span></td></tr>`).join('') : 
                '<tr><td colspan="2">해당 조건의 후기가 없습니다.</td></tr>';
        }

        function updateKeywordAnalysis(data) {
            const positiveCounts = {};
            const negativeCounts = {};

            data.forEach(item => {
                const keywords = item['핵심_키워드'];
                if (keywords && Array.isArray(keywords) && keywords.length > 0) {
                    const sentiment = item['감정_분류'];
                    keywords.forEach(kw => {
                        if (sentiment === '긍정') {
                            positiveCounts[kw] = (positiveCounts[kw] || 0) + 1;
                        } else if (sentiment === '부정') {
                            negativeCounts[kw] = (negativeCounts[kw] || 0) + 1;
                        }
                    });
                }
            });

            const topPositive = Object.entries(positiveCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);
            const topNegative = Object.entries(negativeCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);

            const posChartContainer = document.getElementById('positive-keywords-chart');
            const negChartContainer = document.getElementById('negative-keywords-chart');

            plotKeywordChart(posChartContainer, '긍정 키워드 Top 10', topPositive, '긍정');
            plotKeywordChart(negChartContainer, '부정 키워드 Top 10', topNegative, '부정');
            
            displayKeywordReviews(null, null, true);
        }

        function plotKeywordChart(container, title, data, sentiment) {
            if (data.length === 0) {
                Plotly.react(container, [], { title: `<b>${title}</b>`, height: 400, annotations: [{ text: '데이터 없음', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false }] });
                return;
            }

            const trace = {
                y: data.map(d => d[0]).reverse(),
                x: data.map(d => d[1]).reverse(),
                type: 'bar',
                orientation: 'h',
                marker: { color: sentiment === '긍정' ? '#28a745' : '#dc3545' },
                hovertemplate: '언급 횟수: %{x}<extra></extra>'
            };

            const layout = {
                title: `<b>${title}</b>`,
                height: 400,
                margin: { l: 120, r: 40, t: 80, b: 60 },
                xaxis: { title: '언급 횟수' },
                yaxis: { automargin: true }
            };

            Plotly.react(container, [trace], layout);
            container.removeAllListeners('plotly_click');
            container.on('plotly_click', (eventData) => {
                const keyword = eventData.points[0].y;
                displayKeywordReviews(keyword, sentiment);
            });
        }

        function displayKeywordReviews(keyword, sentiment, isInitial = false) {
            const container = document.getElementById('keyword-reviews-container');
            
            if (isInitial) {
                container.innerHTML = `<h4>관련 리뷰</h4><p>위 그래프의 막대를 클릭하면 관련 리뷰를 확인할 수 있습니다.</p><div id="keyword-reviews-table-container"><table id="keyword-reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody><tr><td colspan="2" style="text-align:center;"></td></tr></tbody></table></div>`;
                return;
            }

            const filteredData = getFilteredData();
            
            const reviews = filteredData.filter(item => 
                item['감정_분류'] === sentiment && 
                Array.isArray(item['핵심_키워드']) && 
                item['핵심_키워드'].includes(keyword)
            );

            let content = `<h4>'${keyword}' (${sentiment}) 관련 리뷰 (${reviews.length}건)</h4>`;
            if (reviews.length > 0) {
                content += `<div id="keyword-reviews-table-container"><table id="keyword-reviews-table">
                    <thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody>`;
                content += reviews.slice(0, 40000).map(r => `<tr><td>${r['설문시행연도']}</td><td>${r['정제된_텍스트']}</td></tr>`).join(''); // 최대 40000개만 표시
                content += `</tbody></table></div>`;
            } else {
                content += '<p>관련 리뷰가 없습니다.</p>';
            }
            container.innerHTML = content;
        }

        function setupTeamRankingChart() {
            const yearSelect = document.getElementById('team-ranking-year-filter');
            const divisionSelect = document.getElementById('team-ranking-division-filter');
            
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1];
            
            // 고정값: 관리부문만 선택 가능
            divisionSelect.innerHTML = `<option value="관리부문">관리부문</option>`;
            divisionSelect.value = "관리부문";
            
            yearSelect.addEventListener('change', updateTeamRankingChart);
            divisionSelect.addEventListener('change', updateTeamRankingChart);
            // 초기 차트 표시
            updateTeamRankingChart();
        }

        function updateTeamRankingChart() {
            const container = document.getElementById('team-ranking-chart-container');
            const selectedYear = document.getElementById('team-ranking-year-filter').value;
            const selectedDivision = document.getElementById('team-ranking-division-filter').value;

            // 관리부문로 고정되어 있으므로 선택 확인 불필요

            // 🔒 보안 강화: 미리 계산된 팀 순위 집계 데이터 사용
            const teamRankingData = aggregatedData.team_ranking[selectedYear] || [];
            
            // 해당 부문에 속한 팀들만 필터링 (관리부문 소속 부서들)
            const teamRankings = teamRankingData.filter(team => {
                // 동적으로 해당 부문의 부서들을 포함
                return true; // 이미 집계 데이터에서 해당 부문만 포함되어 있음
            });

            if (teamRankings.length === 0) {
                Plotly.react(container, [], {
                    height: 600,
                    annotations: [{ text: '선택된 조건에 해당하는 부서 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const divisionColors = { '진료부문': '#1f77b4', '간호부문': '#ff7f0e', '관리부문': '#2ca02c', '의료지원부문': '#d62728', '커뮤니케이션실': '#9467bd', '기타': '#17becf' };
            const departments = teamRankings.map(item => item.department);
            const scores = teamRankings.map(item => parseFloat(item.score));
            const colors = teamRankings.map(item => divisionColors['관리부문'] || '#9467bd');  // 관리부문 색상
            const hoverTexts = teamRankings.map(item => `부서: ${item.department}<br>순위: ${item.rank}위<br>점수: ${item.score.toFixed(1)}<br>응답수: ${item.count}건`);

            // 🔒 보안 강화: 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = {
                x: departments, y: scores, type: 'bar', text: scores.map(score => score.toFixed(1)),
                textposition: 'outside', textfont: { size: 12 }, marker: { color: colors },
                hovertemplate: '%{hovertext}<extra></extra>', hovertext: hoverTexts
            };

            const avgLine = {
                x: [departments[0], departments[departments.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 전체 평균: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };

            const layout = {
                title: `<b>${selectedYear} 부문별 부서 점수 순위 (점수 높은 순)</b>`, height: 600,
                xaxis: { title: '부서', tickangle: -45, automargin: true },
                yaxis: { title: '점수', range: [Math.min(...scores) - 5, Math.max(...scores) + 5] },
                font: layoutFont, hovermode: 'closest', showlegend: false,
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.02, xanchor: 'right', x: 1 },
                annotations: [{
                    text: `${selectedYear} 전체 평균: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 100 }
            };

            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateYearlyComparisonChart() {
            const container = document.getElementById('yearly-comparison-chart-container');
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let targetData = [...rawData];
            if (selectedDept !== '전체') { targetData = targetData.filter(item => item['피평가부서'] === selectedDept); }
            if (selectedUnit !== '전체') { targetData = targetData.filter(item => item['피평가Unit'] === selectedUnit); }

            if (targetData.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const years = [...new Set(targetData.map(item => item['설문시행연도']))].sort();
            const traces = [];

            selectedScores.forEach(col => {
                const y_values = years.map(year => {
                    const yearData = targetData.filter(d => d['설문시행연도'] === year);
                    return yearData.length > 0 ? (yearData.reduce((sum, item) => sum + (item[col] || 0), 0) / yearData.length).toFixed(1) : 0;
                });
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => targetData.filter(d => d['설문시행연도'] === year).length);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3 }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            let titleText = '연도별 문항 점수';
            if (selectedDept !== '전체' && selectedUnit !== '전체') { titleText = `[${selectedDept} > ${selectedUnit}] 연도별 문항 점수`; }
            else if (selectedDept !== '전체') { titleText = `[${selectedDept}] 연도별 문항 점수`; }
            else if (selectedUnit !== '전체') { titleText = `[${selectedUnit}] 연도별 문항 점수`; }
            
            const layout = {
                title: `<b>${titleText}</b>`, barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            
            Plotly.react(container, traces, layout);
        }

        function setupUnitComparisonChart() {
            // Unit comparison chart uses main filters from detailed analysis section
            // No separate filters needed
        }

        function updateUnitComparisonChart() {
            const container = document.getElementById('unit-comparison-chart-container');
            const selectedDepartment = document.getElementById('department-filter').value;
            const selectedYear = document.getElementById('year-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedDepartment === '전체') {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: 'Unit 간 비교를 위해 부서를 선택해 주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let departmentData = rawData.filter(item => item['피평가부서'] === selectedDepartment);
            if (selectedYear !== '전체') { departmentData = departmentData.filter(item => item['설문시행연도'] === selectedYear); }

            const unitsInDepartment = [...new Set(departmentData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a, b) => String(a).localeCompare(String(b), 'ko'));

            if (unitsInDepartment.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 Unit이 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const traces = [];
            selectedScores.forEach(col => {
                const y_values = unitsInDepartment.map(unit => {
                    const unitData = departmentData.filter(item => item['피평가Unit'] === unit);
                    return unitData.length > 0 ? (unitData.reduce((sum, item) => sum + (item[col] || 0), 0) / unitData.length).toFixed(1) : 0;
                });
                traces.push({ x: unitsInDepartment, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, hovertemplate: '%{fullData.name}: %{y}<br>Unit: %{x}<extra></extra>' });
            });

            const yearTitle = selectedYear === '전체' ? '전체 연도' : selectedYear;
            const layout = {
                title: `<b>[${selectedDepartment}] Unit별 문항 점수 비교 (${yearTitle})</b>`, barmode: 'group', height: 400,
                xaxis: { title: 'Unit' }, yaxis: { title: '점수', range: [0, 100] },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };

            Plotly.react(container, traces, layout);
        }

        function toggleExpander(expanderId) {
            const content = document.getElementById(expanderId);
            const arrow = document.getElementById(expanderId.replace('-expander', '-arrow'));
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                arrow.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                arrow.classList.add('expanded');
            }
        }

        function updateExpanderHeader(groupName, selectedCount, totalCount) {
            const headerId = groupName.replace('-filter', '-header');
            const headerSpan = document.querySelector(`#${headerId} span:first-child`);
            if (headerSpan) {
                if (groupName.includes('division-filter')) {
                    headerSpan.textContent = `부문 선택 (${selectedCount}개 선택됨)`;
                } else {
                    headerSpan.textContent = `문항 선택 (${selectedCount}개 선택됨)`;
                }
            }
        }

        function createCheckboxFilter(containerId, items, groupName, updateFunction, startChecked = true) {
            const container = document.getElementById(containerId);
            
            const selectAllDiv = document.createElement('div');
            selectAllDiv.className = 'checkbox-item';
            selectAllDiv.innerHTML = `<input type="checkbox" id="${groupName}-select-all" ${startChecked ? 'checked' : ''}><label for="${groupName}-select-all"><b>전체 선택</b></label>`;
            container.appendChild(selectAllDiv);
            
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'checkbox-item';
                itemDiv.innerHTML = `<input type="checkbox" id="${groupName}-${item}" name="${groupName}" value="${item}" ${startChecked ? 'checked' : ''}><label for="${groupName}-${item}">${item}</label>`;
                container.appendChild(itemDiv);
            });

            const selectAllCheckbox = container.querySelector(`#${groupName}-select-all`);
            const itemCheckboxes = container.querySelectorAll(`input[name="${groupName}"]`);

            function updateSelectAllState() {
                const allChecked = [...itemCheckboxes].every(cb => cb.checked);
                const someChecked = [...itemCheckboxes].some(cb => cb.checked);
                const checkedCount = [...itemCheckboxes].filter(cb => cb.checked).length;
                
                selectAllCheckbox.checked = allChecked;
                selectAllCheckbox.indeterminate = !allChecked && someChecked;
                
                updateExpanderHeader(containerId, checkedCount, items.length);
            }

            selectAllCheckbox.addEventListener('change', (e) => {
                itemCheckboxes.forEach(checkbox => { checkbox.checked = e.target.checked; });
                updateSelectAllState();
                updateFunction();
            });

            itemCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateSelectAllState();
                    updateFunction();
                });
            });

            updateSelectAllState();
        }

        // === 협업 네트워크 분석 기능 ===
        
        // 부문-부서-Unit 매핑 생성
        const divisionDepartmentMap = rawData.reduce((acc, item) => {
            const division = item['피평가부문'];
            const department = item['피평가부서'];
            if (division && division !== 'N/A' && department && department !== 'N/A') {
                if (!acc[division]) { acc[division] = new Set(); }
                acc[division].add(department);
            }
            return acc;
        }, {});
        for (const division in divisionDepartmentMap) {
            divisionDepartmentMap[division] = [...divisionDepartmentMap[division]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function setupNetworkAnalysis() {
            const yearSelect = document.getElementById('network-year-filter');
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const minCollabSelect = document.getElementById('min-collaboration-filter');
            const sentimentSelect = document.getElementById('network-sentiment-filter');
            
            // 연도 필터 설정
            yearSelect.innerHTML = ['전체', ...allYears].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            
            // 부문 필터 설정 - 고정값: 관리부문만 선택 가능
            divisionSelect.innerHTML = `<option value="관리부문">관리부문</option>`;
            divisionSelect.value = "관리부문";
            
            // 초기 부서, Unit 설정
            departmentSelect.innerHTML = '<option value="전체">전체</option>';
            unitSelect.innerHTML = '<option value="전체">전체</option>';
            
            // 이벤트 리스너 추가
            yearSelect.addEventListener('change', updateNetworkAnalysis);
            divisionSelect.addEventListener('change', updateNetworkDepartments);
            departmentSelect.addEventListener('change', updateNetworkUnits);
            unitSelect.addEventListener('change', updateNetworkAnalysis);
            minCollabSelect.addEventListener('change', updateNetworkAnalysis);
            sentimentSelect.addEventListener('change', updateNetworkReviews);
            
            // 협업 관계 현황 체크박스 이벤트 리스너는 updateStatusDropdowns 함수에서 동적으로 추가됨
            
            // 초기 네트워크 분석 표시
            updateNetworkDepartments();
        }

        function updateNetworkDepartments() {
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDivision = divisionSelect.value;
            
            // 부서 드롭다운을 노사협력팀으로 고정
            departmentSelect.innerHTML = `<option value="노사협력팀">노사협력팀</option>`;
            departmentSelect.value = "노사협력팀";
            
            // 부서 필터가 변경되었으므로, Unit 필터를 업데이트하고 분석을 새로고침합니다.
            updateNetworkUnits();
        }

        function updateNetworkUnits() {
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDept = departmentSelect.value;
            
            // Unit 드롭다운 업데이트
            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];
            
            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            updateNetworkAnalysis();
        }

        function getNetworkFilteredData() {
            let filteredData = [...rawData];
            
            const selectedYear = document.getElementById('network-year-filter').value;
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedYear !== '전체') { filteredData = filteredData.filter(item => String(item['설문시행연도']) === String(selectedYear)); }
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }
        
        function getNetworkFilteredDataWithoutYear() {
            let filteredData = [...rawData];
            
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }

        function updateNetworkAnalysis() {
            updateCollaborationFrequencyChart();
            updateCollaborationStatusChart();
            updateCollaborationTrendChart();
            updateNetworkReviews();
        }

        function updateCollaborationFrequencyChart() {
            const container = document.getElementById('collaboration-frequency-chart-container');
            const filteredData = getNetworkFilteredData();
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            if (filteredData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            // 협업 빈도 계산
            const collaborationCounts = {};
            filteredData.forEach(item => {
                const evaluator = item['평가부서'];
                const evaluated = item['피평가부서'];
                if (evaluator !== evaluated && evaluator && evaluated && evaluator !== 'N/A' && evaluated !== 'N/A') {
                    const key = `${evaluator} → ${evaluated}`;
                    collaborationCounts[key] = (collaborationCounts[key] || 0) + 1;
                }
            });
            
            // 최소 협업 횟수 이상인 관계만 필터링
            const filteredCollaborations = Object.entries(collaborationCounts)
                .filter(([_, count]) => count >= minCollabCount)
                .sort((a, b) => b[1] - a[1]);
            
            if (filteredCollaborations.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: `최소 ${minCollabCount}회 이상 협업한 관계가 없습니다.`, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            const trace = {
                y: filteredCollaborations.map(([key, _]) => key).reverse(),
                x: filteredCollaborations.map(([_, count]) => count).reverse(),
                type: 'bar',
                orientation: 'h',
                text: filteredCollaborations.map(([_, count]) => `${count}회`).reverse(),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: '#4a69bd' },
                hovertemplate: '협업 횟수: %{x}회<extra></extra>'
            };
            
            // 부서 수에 따라 동적 높이 계산 (막대당 최소 25px 보장)
            const barHeight = 25;
            const dynamicHeight = Math.max(400, filteredCollaborations.length * barHeight + 100);
            
            const layout = {
                title: '<b>부서 리스트</b>',
                height: dynamicHeight,
                margin: { l: 150, r: 40, t: 80, b: 60 },
                xaxis: { title: '협업 횟수' },
                yaxis: { 
                    automargin: true,
                    fixedrange: true,
                    categoryorder: 'total ascending'
                },
                font: layoutFont
            };
            
            Plotly.react(container, [trace], layout);
        }

        function updateCollaborationStatusChart() {
            const container = document.getElementById('collaboration-status-chart-container');
            const filteredData = getNetworkFilteredData();
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            if (filteredData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                updateStatusDropdowns({});
                return;
            }
            
            // 협업 관계별 점수 계산
            const relationshipScores = {};
            filteredData.forEach(item => {
                const evaluator = item['평가부서'];
                const evaluated = item['피평가부서'];
                const score = item['종합점수'];
                if (evaluator !== evaluated && evaluator && evaluated && evaluator !== 'N/A' && evaluated !== 'N/A' && score != null) {
                    const key = `${evaluator} → ${evaluated}`;
                    if (!relationshipScores[key]) { relationshipScores[key] = { scores: [], count: 0 }; }
                    relationshipScores[key].scores.push(score);
                    relationshipScores[key].count++;
                }
            });
            
            // 최소 협업 횟수 이상인 관계만 필터링하고 점수별로 분류
            const statusCounts = { '우수 (75점 이상)': 0, '양호 (60-74점)': 0, '주의 (50-59점)': 0, '문제 (50점 미만)': 0 };
            const statusDepartments = {
                '우수': [],
                '양호': [],
                '주의': [],
                '문제': []
            };
            
            Object.entries(relationshipScores)
                .filter(([_, data]) => data.count >= minCollabCount)
                .forEach(([relationship, data]) => {
                    const avgScore = data.scores.reduce((sum, score) => sum + score, 0) / data.scores.length;
                    const [evaluator, evaluated] = relationship.split(' → ');
                    const relationshipInfo = {
                        relationship: relationship,
                        avgScore: avgScore.toFixed(1),
                        count: data.count,
                        evaluator: evaluator,
                        evaluated: evaluated
                    };
                    
                    if (avgScore >= 75) {
                        statusCounts['우수 (75점 이상)']++;
                        statusDepartments['우수'].push(relationshipInfo);
                    } else if (avgScore >= 60) {
                        statusCounts['양호 (60-74점)']++;
                        statusDepartments['양호'].push(relationshipInfo);
                    } else if (avgScore >= 50) {
                        statusCounts['주의 (50-59점)']++;
                        statusDepartments['주의'].push(relationshipInfo);
                    } else {
                        statusCounts['문제 (50점 미만)']++;
                        statusDepartments['문제'].push(relationshipInfo);
                    }
                });
            
            const statusLabels = Object.keys(statusCounts);
            const statusValues = Object.values(statusCounts);
            const statusColors = ['#28a745', '#ffc107', '#fd7e14', '#dc3545'];
            
            if (statusValues.every(val => val === 0)) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: `최소 ${minCollabCount}회 이상 협업한 관계가 없습니다.`, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                updateStatusDropdowns({});
                return;
            }
            
            const trace = {
                x: statusLabels,
                y: statusValues,
                type: 'bar',
                text: statusValues.map(val => `${val}개`),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: statusColors },
                hovertemplate: '%{x}: %{y}개 부서<extra></extra>'
            };
            
            const layout = {
                title: '<b>협업 관계 현황</b>',
                height: 400,
                xaxis: { title: '상태' },
                yaxis: { title: '부서 수', rangemode: 'tozero', range: [0, Math.max(...statusValues) * 1.2] },
                font: layoutFont,
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };
            
            Plotly.react(container, [trace], layout);
            
            // 드롭다운 업데이트
            updateStatusDropdowns(statusDepartments);
        }
        
        function updateStatusDropdowns(statusData) {
            const statusMappings = {
                '우수': { filterId: 'excellent-dept-filter', countId: 'excellent-count', headerId: 'excellent-dept-header', groupName: 'excellent-dept' },
                '양호': { filterId: 'good-dept-filter', countId: 'good-count', headerId: 'good-dept-header', groupName: 'good-dept' },
                '주의': { filterId: 'caution-dept-filter', countId: 'caution-count', headerId: 'caution-dept-header', groupName: 'caution-dept' },
                '문제': { filterId: 'problem-dept-filter', countId: 'problem-count', headerId: 'problem-dept-header', groupName: 'problem-dept' }
            };
            
            Object.entries(statusMappings).forEach(([status, elements]) => {
                const container = document.getElementById(elements.filterId);
                const countElement = document.getElementById(elements.countId);
                const headerElement = document.getElementById(elements.headerId);
                const groupName = elements.groupName;
                
                // 컨테이너 초기화
                container.innerHTML = '';
                
                if (statusData[status] && statusData[status].length > 0) {
                    // 전체 선택 체크박스 추가
                    const selectAllDiv = document.createElement('div');
                    selectAllDiv.className = 'checkbox-item';
                    selectAllDiv.innerHTML = `<input type="checkbox" id="${groupName}-select-all"><label for="${groupName}-select-all"><b>전체 선택</b></label>`;
                    container.appendChild(selectAllDiv);
                    
                    // 관계별로 체크박스 추가
                    statusData[status]
                        .sort((a, b) => b.avgScore - a.avgScore) // 점수 높은 순으로 정렬
                        .forEach(item => {
                            const itemDiv = document.createElement('div');
                            itemDiv.className = 'checkbox-item';
                            itemDiv.innerHTML = `<input type="checkbox" id="${groupName}-${item.relationship}" name="${groupName}" value="${item.relationship}"><label for="${groupName}-${item.relationship}" title="${item.relationship} (평균: ${item.avgScore}점, ${item.count}회)">${item.relationship}</label>`;
                            container.appendChild(itemDiv);
                        });
                    
                    // 전체 선택 기능
                    const selectAllCheckbox = container.querySelector(`#${groupName}-select-all`);
                    const itemCheckboxes = container.querySelectorAll(`input[name="${groupName}"]`);
                    
                    function updateSelectAllState() {
                        const allChecked = [...itemCheckboxes].every(cb => cb.checked);
                        const someChecked = [...itemCheckboxes].some(cb => cb.checked);
                        selectAllCheckbox.checked = allChecked;
                        selectAllCheckbox.indeterminate = someChecked && !allChecked;
                        
                        // 헤더 업데이트
                        const checkedCount = [...itemCheckboxes].filter(cb => cb.checked).length;
                        headerElement.querySelector('span').textContent = `부서 선택 (${checkedCount}개 선택됨)`;
                    }
                    
                    selectAllCheckbox.addEventListener('change', (e) => {
                        itemCheckboxes.forEach(checkbox => { checkbox.checked = e.target.checked; });
                        updateSelectAllState();
                        updateCollaborationTrendChart();
                    });
                    
                    itemCheckboxes.forEach(checkbox => {
                        checkbox.addEventListener('change', () => {
                            updateSelectAllState();
                            updateCollaborationTrendChart();
                        });
                    });
                    
                    updateSelectAllState();
                    countElement.textContent = `${statusData[status].length}개 관계`;
                } else {
                    countElement.textContent = '0개 관계';
                    headerElement.querySelector('span').textContent = '부서 선택 (0개 선택됨)';
                }
            });
        }

        function updateCollaborationTrendChart() {
            const container = document.getElementById('collaboration-trend-chart-container');
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            // 선택된 부서들 수집
            const selectedDepartments = [];
            const statusMappings = {
                '우수': 'excellent-dept',
                '양호': 'good-dept',
                '주의': 'caution-dept',
                '문제': 'problem-dept'
            };
            
            Object.entries(statusMappings).forEach(([status, groupName]) => {
                const checkedBoxes = document.querySelectorAll(`input[name="${groupName}"]:checked`);
                checkedBoxes.forEach(checkbox => {
                    const relationshipValue = checkbox.value;
                    // 드롭다운 값 파싱: "평가부서 → 피평가부서" 형태
                    const match = relationshipValue.match(/^(.+?) → (.+?)$/);
                    if (match) {
                        const [, evaluator, evaluated] = match;
                        selectedDepartments.push({
                            evaluator: evaluator.trim(),
                            evaluated: evaluated.trim(),
                            status: status,
                            relationKey: `${evaluator.trim()}-${evaluated.trim()}`
                        });
                    }
                });
            });
            
            // 선택된 부서가 없으면 빈 차트 표시
            if (selectedDepartments.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{
                        text: '우수/양호/주의/문제 드롭다운에서 부서를 선택하세요.',
                        xref: 'paper', yref: 'paper', x: 0.5, y: 0.5,
                        showarrow: false, font: {size: 16, color: '#888'}
                    }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            // 현재 필터 적용
            const selectedYear = document.getElementById('network-year-filter').value;
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            // 전체 연도 리스트
            const allYears = [...new Set(rawData.map(item => item['설문시행연도']))].sort();
            
            // 선택된 부서들의 트렌드 라인 생성
            const traces = [];
            const statusColors = {
                '우수': '#28a745',
                '양호': '#17a2b8', 
                '주의': '#ffc107',
                '문제': '#dc3545'
            };
            
            selectedDepartments.forEach((dept, index) => {
                // 해당 협업 관계의 연도별 점수 및 응답수 계산
                const relationYearlyData = allYears.map(year => {
                    const yearRelationData = rawData.filter(item => 
                        item['설문시행연도'] === year && 
                        item['평가부서'] === dept.evaluator && 
                        item['피평가부서'] === dept.evaluated &&
                        // 현재 필터 조건 적용
                        (selectedYear === '전체' || String(item['설문시행연도']) === String(selectedYear)) &&
                        (selectedDivision === '전체' || item['피평가부문'] === selectedDivision) &&
                        (selectedDepartment === '전체' || item['피평가부서'] === selectedDepartment) &&
                        (selectedUnit === '전체' || item['피평가Unit'] === selectedUnit)
                    );
                    
                    if (yearRelationData.length === 0) return null;
                    const avgScore = yearRelationData.reduce((sum, item) => sum + (item['종합점수'] || 0), 0) / yearRelationData.length;
                    return { 
                        score: parseFloat(avgScore.toFixed(1)), 
                        count: yearRelationData.length 
                    };
                });
                
                const relationYearlyScores = relationYearlyData.map(data => data ? data.score : null);
                const relationYearlyCounts = relationYearlyData.map(data => data ? data.count : null);
                
                // 데이터가 있는 경우에만 트레이스 추가
                if (!relationYearlyScores.every(score => score === null)) {
                    traces.push({
                        x: allYears,
                        y: relationYearlyScores,
                        type: 'scatter',
                        mode: 'lines+markers',
                        name: `${dept.evaluator} → ${dept.evaluated}`,
                        line: { 
                            color: statusColors[dept.status], 
                            width: 3 
                        },
                        marker: { size: 8 },
                        connectgaps: false,
                        customdata: relationYearlyCounts,
                        hovertemplate: `${dept.evaluator} → ${dept.evaluated}<br>연도: %{x}<br>평균 점수: %{y}점<br>응답수: %{customdata}건<extra></extra>`
                    });
                }
            });
            
            if (traces.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{
                        text: '선택된 부서의 트렌드 데이터가 없습니다.',
                        xref: 'paper', yref: 'paper', x: 0.5, y: 0.5,
                        showarrow: false, font: {size: 16, color: '#888'}
                    }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            const layout = {
                title: '<b>선택된 부서의 협업 관계 변화 트렌드</b>',
                height: 400,
                xaxis: { title: '연도', type: 'category' },
                yaxis: { title: '종합점수', range: [0, 100] },
                font: layoutFont,
                legend: { orientation: 'v', x: 1.02, y: 1 },
                margin: { l: 60, r: 200, t: 100, b: 60 }
            };
            
            Plotly.react(container, traces, layout);
        }

        function updateNetworkReviews() {
            const tbody = document.querySelector('#network-reviews-table tbody');
            const filteredData = getNetworkFilteredData();
            const selectedSentiment = document.getElementById('network-sentiment-filter').value;
            
            let reviewData = filteredData;
            if (selectedSentiment !== '전체') {
                reviewData = filteredData.filter(item => item['감정_분류'] === selectedSentiment);
            }
            
            const reviews = reviewData
                .filter(item => item['정제된_텍스트'] && item['정제된_텍스트'] !== 'N/A')
                .map(item => ({
                    year: String(item['설문시행연도']),
                    partner: item['평가부서'] !== item['피평가부서'] ? item['평가부서'] : '동일부서',
                    review: item['정제된_텍스트'],
                    sentiment: item['감정_분류'] || '알 수 없음'
                }))
                .sort((a, b) => {
                    // 1차 정렬: 연도별 (2025, 2024, 2023, 2022 순서)
                    const yearA = parseInt(a.year);
                    const yearB = parseInt(b.year);
                    if (yearA !== yearB) return yearB - yearA;
                    
                    // 2차 정렬: 협업 파트너 가나다 순
                    return a.partner.localeCompare(b.partner, 'ko');
                })
                .slice(0, 40000); // 최대 40000개만 표시
            
            // 후기 개수 표시 업데이트
            const countDisplay = document.getElementById('network-reviews-count-display');
            if (countDisplay) {
                countDisplay.textContent = `(${reviews.length}건)`;
            }
            
            tbody.innerHTML = (reviews.length > 0) ?
                reviews.map(r => `<tr><td>${r.year}</td><td>${r.partner}</td><td>${r.review} <span style="color: #666; font-size: 0.9em;">[${r.sentiment}]</span></td></tr>`).join('') :
                '<tr><td colspan="3">해당 조건의 후기가 없습니다.</td></tr>';
        }

        window.onload = () => { 
            populateFilters(); 
            createCheckboxFilter('hospital-score-filter', scoreCols, 'hospital-score', updateHospitalYearlyChart);
            createCheckboxFilter('drilldown-score-filter', scoreCols, 'drilldown-score', updateDashboard);
            createCheckboxFilter('review-sentiment-filter', ['긍정', '부정', '중립'], 'review-sentiment', updateReviewsTable, true);
            setupDivisionChart();
            setupComparisonChart();
            setupTeamRankingChart();
            setupUnitComparisonChart();
            setupNetworkAnalysis();
            updateDashboard(); 
            updateHospitalYearlyChart();
            updateDivisionYearlyChart();
            updateYearlyDivisionComparisonChart();
            updateTeamRankingChart();
            updateUnitComparisonChart();
            updateNetworkAnalysis();
        };
    </script>
</body>
</html>
    