
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>서울아산병원 협업 평가 결과 보고</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #343a40; font-size: 16px;}
        .container { max-width: 1400px; margin: auto; padding: 20px; }
        .header { background: linear-gradient(90deg, #4a69bd, #6a89cc); color: white; padding: 25px; text-align: center; border-radius: 0 0 10px 10px; }
        
        /* 자동 번호 매기기 CSS */
        .container { counter-reset: section-counter; }
        .section { counter-reset: subsection-counter; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section h2::before { counter-increment: section-counter; content: counter(section-counter) ". "; color: #4a69bd; font-weight: bold; }
        .section h3::before { counter-increment: subsection-counter; content: counter(section-counter) "." counter(subsection-counter) " "; color: #6a89cc; font-weight: bold; }
        
        h1, h2, h3 { margin: 0; padding: 0; }
        h2 { color: #4a69bd; border-bottom: 3px solid #6a89cc; padding-bottom: 10px; margin-top: 20px; margin-bottom: 20px; }
        h3 { color: #555; margin-top: 30px; margin-bottom: 15px;}
        
        /* 파트 구분 스타일 */
        .part-divider { background: linear-gradient(90deg, #e9ecef, #6c757d, #e9ecef); height: 3px; margin: 40px 0; border-radius: 2px; }
        .part-title { text-align: center; color: #6c757d; font-size: 1.2em; font-weight: bold; margin: 30px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 5px solid #6a89cc; }
        
        .filters, .trend-filters { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-end; margin-bottom: 20px;}
        .filter-group { display: flex; flex-direction: column; }
        .filter-group label { margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        .filter-group select, .filter-group input { padding: 8px; border-radius: 5px; border: 1px solid #ced4da; min-width: 200px; }
        .expander-container { border: 1px solid #ced4da; border-radius: 5px; background-color: white; min-width: 200px; max-width: 280px; position: relative; }
        .expander-header { padding: 6px 8px; background-color: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 5px; user-select: none; font-size: 13px; }
        .expander-header:hover { background-color: #e9ecef; }
        .expander-arrow { transition: transform 0.3s ease; font-size: 11px; }
        .expander-arrow.expanded { transform: rotate(180deg); }
        .expander-content { padding: 4px; display: none; max-height: 200px; overflow-y: auto; position: absolute; top: 100%; left: 0; width: 100%; background-color: white; border: 1px solid #ced4da; border-top: none; border-radius: 0 0 5px 5px; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .expander-content.expanded { display: block; }
        .checkbox-item { display: flex; align-items: center; padding: 2px 0; height: auto; min-height: unset; }
        .checkbox-item input[type="checkbox"] { width: 16px; height: 16px; min-width: 16px; min-height: 16px; margin-right: 6px; box-sizing: border-box; }
        .checkbox-item:hover { background-color: #f8f9fa; }
        .checkbox-item label { cursor: pointer; font-weight: normal; font-size: 13px; line-height: 1.1; margin: 0; }
        #metrics-container { display: flex; gap: 30px; margin-top: 20px; text-align: center; justify-content: center; }
        .metric { background-color: #e9ecef; padding: 15px; border-radius: 8px; flex-grow: 1; }
        .metric-value { font-size: 2em; font-weight: bold; color: #4a69bd; }
        .metric-label { font-size: 0.9em; color: #6c757d; }
        #reviews-table-container, #keyword-reviews-table-container { max-height: 400px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #network-reviews-table-container { max-height: 300px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #reviews-table, #keyword-reviews-table, #network-reviews-table { width: 100%; border-collapse: collapse; }
        #reviews-table th, #reviews-table td, #keyword-reviews-table th, #keyword-reviews-table td, #network-reviews-table th, #network-reviews-table td { padding: 12px; border-bottom: 1px solid #dee2e6; text-align: left; }
        #reviews-table th, #keyword-reviews-table th, #network-reviews-table th { background-color: #f8f9fa; position: sticky; top: 0; }
        #reviews-table tr:last-child td, #keyword-reviews-table tr:last-child td, #network-reviews-table tr:last-child td { border-bottom: none; }
        .keyword-charts-container { display: flex; gap: 20px; }
        .keyword-chart { flex: 1; }
        
        /* 차트 컨테이너 스타일 */
        .chart-container { margin: 20px 0; }
        .subsection { margin: 30px 0; }
        
        /* 협업 빈도 차트 스크롤 컨테이너 */
        #collaboration-frequency-chart-container { max-height: 600px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px; }
        
    </style>
</head>
<body>
    <div class="header">
        <h1> 서울아산병원 협업 평가 결과 보고 - 방사선종양팀 </h1>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">설문 데이터: 2022년 ~ 2025년 상반기(2025년 7월 9일 기준) </p>
    </div>
    
    <!-- 안내 문구 섹션 -->
    <div style="max-width: 1400px; margin: 20px auto; padding: 0 20px;">
        <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            
            <div style="margin-bottom: 15px;">
                <strong style="color: #495057;">📊 평가 문항 설명:</strong>
                <ul style="margin: 8px 0 0 20px; color: #6c757d; font-size: 0.95em; line-height: 1.4;">
                    <li><strong>존중배려:</strong> ○○은 타 부서의 입장을 존중하고 배려하여 협력해주며, 협업 관련 의견을 경청해준다.</li>
                    <li><strong>정보공유:</strong> ○○은 업무상 필요한 정보에 대해 공유가 잘 이루어진다.</li>
                    <li><strong>명확처리:</strong> ○○은 업무에 대한 명확한 담당자가 있고 업무를 일관성있게 처리해준다.</li>
                    <li><strong>태도개선:</strong> ○○은 이전보다 업무 협력에 대한 태도나 의지가 개선되고 있다.</li>
                    <li><strong>전반만족:</strong> 전반적으로 ○○과의 협업에 대해 만족한다.</li>
                </ul>
            </div>
            
            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 12px;">
                <strong style="color: #856404;">⚠️ 통계적 해석 주의사항:</strong>
                <span style="color: #856404; font-size: 0.95em;">응답건수(표본수)가 30건 미만인 경우 통계적 해석에 유의하시기 바랍니다.</span>
            </div>
            
        </div>
    </div>
    
    <div class="container">
        
        
        <div class="section">
            <h2>병원 전체 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="hospital-score-header" onclick="toggleExpander('hospital-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="hospital-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="hospital-score-expander">
                            <div id="hospital-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="hospital-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>

        <div class="section">
            <h2>부문별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="comparison-year-filter">연도 선택</label>
                    <select id="comparison-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label>부문 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="comparison-division-header" onclick="toggleExpander('comparison-division-expander')">
                            <span>부문 선택 (0개 선택됨)</span>
                            <span class="expander-arrow" id="comparison-division-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="comparison-division-expander">
                            <div id="comparison-division-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comparison-chart-container" class="chart-container"></div>
        </div>

        <div class="section">
            <h2>소속 부문 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="division-chart-filter">부문 선택</label>
                    <select id="division-chart-filter"></select>
                </div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="division-score-header" onclick="toggleExpander('division-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="division-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="division-score-expander">
                            <div id="division-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="division-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>소속 부문 팀별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="team-ranking-year-filter">연도 선택</label>
                    <select id="team-ranking-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="team-ranking-division-filter">부문 선택</label>
                    <select id="team-ranking-division-filter"></select>
                </div>
            </div>
            <div id="team-ranking-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>부서/Unit 결과</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group"><label for="year-filter">연도 (전체)</label><select id="year-filter"></select></div>
                <div class="filter-group"><label for="department-filter">부서</label><select id="department-filter"></select></div>
                <div class="filter-group"><label for="unit-filter">Unit</label><select id="unit-filter"></select></div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="drilldown-score-header" onclick="toggleExpander('drilldown-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="drilldown-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="drilldown-score-expander">
                            <div id="drilldown-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 5.1 부서/Unit 결과 -->
            <div class="subsection">
                <h3>부서/Unit 결과</h3>
                <div id="metrics-container"></div>
                <div id="yearly-comparison-chart-container" class="chart-container"></div>
                
            </div>
            
            <!-- 5.2 부서 내 Unit 결과 -->
            <div class="subsection">
                <h3>부서 내 Unit 결과</h3>
                <div id="unit-comparison-chart-container" class="chart-container"></div>
            </div>
            
            <!-- 5.3 감정 분석 -->
            <div class="subsection">
                <h3>평가 부서 의견</h3>
                <div id="sentiment-chart-container" class="chart-container"></div>
                
                <!-- 협업 후기 -->
                <div style="margin-top: 30px;">
                    <h4>협업 후기 <span id="reviews-count-display" style="color: #666; font-size: 0.9em;"></span></h4>
                    <div class="filters">
                        <div class="filter-group">
                            <label>감정 분류 필터</label>
                            <div class="expander-container">
                                <div class="expander-header" id="review-sentiment-header" onclick="toggleExpander('review-sentiment-expander')">
                                    <span>감정 선택 (4개 선택됨)</span>
                                    <span class="expander-arrow" id="review-sentiment-arrow">▼</span>
                                </div>
                                <div class="expander-content" id="review-sentiment-expander">
                                    <div id="review-sentiment-filter"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="reviews-table-container"><table id="reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody></tbody></table></div>
                </div>
            </div>

        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>다빈도 평가 부서</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group">
                    <label for="network-year-filter">연도 (전체)</label>
                    <select id="network-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="min-collaboration-filter">평가 횟수</label>
                    <select id="min-collaboration-filter">
                        <option value="5">5회 이상</option>
                        <option value="10" selected>10회 이상</option>
                        <option value="30">30회 이상</option>
                    </select>
                </div>
            </div>
            <!-- 부문/부서/Unit 필터는 집계 데이터 사용으로 제거 -->
            <div style="display: none;">
                <select id="network-division-filter"><option value="전체">전체</option></select>
                <select id="network-department-filter"><option value="방사선종양팀">방사선종양팀</option></select>
                <select id="network-unit-filter"><option value="전체">전체</option></select>
            </div>
            
            <div class="subsection">
                <div id="collaboration-frequency-chart-container" class="chart-container"></div>
            </div>


        </div>

    </div>
    <script>
        // 부서별 데이터 구조
        const hybridData = {"aggregated": {"hospital_yearly": {"2022": {"존중배려": 67.14276157345465, "정보공유": 67.33654876741693, "명확처리": 67.26182500334986, "태도개선": 66.87172246873739, "전반만족": 66.08169541382537, "종합점수": 66.9457064563561, "응답수": 7481}, "2023": {"존중배려": 69.83673131112216, "정보공유": 69.63634101841102, "명확처리": 69.98963085856491, "태도개선": 69.31004330446369, "전반만족": 68.76658374792703, "종합점수": 69.49223280861641, "응답수": 12070}, "2024": {"존중배려": 74.488649134637, "정보공유": 73.94310771306499, "명확처리": 74.12310286677909, "태도개선": 73.35440894207971, "전반만족": 73.21970975362808, "종합점수": 73.80928354856822, "응답수": 8905}, "2025": {"존중배려": 77.27624375148774, "정보공유": 76.88712942016907, "명확처리": 77.01954009293459, "태도개선": 76.21536072623029, "전반만족": 76.12433075550268, "종합점수": 76.67731985731272, "응답수": 8410}}, "division_yearly": {"진료부문": {"2022": {"존중배려": 65.45150501672241, "정보공유": 67.07439678284182, "명확처리": 66.05527638190955, "태도개선": 66.2134944612286, "전반만족": 65.10538641686183, "종합점수": 65.96836789297659, "응답수": 2990}, "2023": {"존중배려": 68.65744773519164, "정보공유": 69.7546346782988, "명확처리": 69.44323144104804, "태도개선": 68.85111499781372, "전반만족": 68.0525283347864, "종합점수": 68.94009799651568, "응답수": 4592}, "2024": {"존중배려": 73.48090277777777, "정보공유": 73.87811233352635, "명확처리": 73.28985507246377, "태도개선": 72.88160185722577, "전반만족": 72.57457283521576, "종합점수": 73.20710358796296, "응답수": 3456}, "2025": {"존중배려": 76.21971736204576, "정보공유": 76.94378996970717, "명확처리": 76.2041091276524, "태도개선": 75.70219966159053, "전반만족": 75.49646583641871, "종합점수": 76.11265388496467, "응답수": 2973}}}, "division_comparison": {"2022": {"관리부문": {"존중배려": 71.23039806996381, "정보공유": 69.5166163141994, "명확처리": 70.14767932489451, "태도개선": 69.2506067961165, "전반만족": 69.17168674698796, "종합점수": 69.85550872968092, "응답수": 1661}, "커뮤니케이션실": {"존중배려": 71.4, "정보공유": 71.2, "명확처리": 69.6, "태도개선": 68.75, "전반만족": 68.359375, "종합점수": 70.37109375, "응답수": 128}, "진료부문": {"존중배려": 65.45150501672241, "정보공유": 67.07439678284182, "명확처리": 66.05527638190955, "태도개선": 66.2134944612286, "전반만족": 65.10538641686183, "종합점수": 65.96836789297659, "응답수": 2990}, "간호부문": {"존중배려": 66.6626036079961, "정보공유": 66.58946855192589, "명확처리": 66.66259168704157, "태도개선": 66.6421568627451, "전반만족": 65.72403705509508, "종합점수": 66.46411994149196, "응답수": 2051}, "기타부문": {"존중배려": 51.94805194805195, "정보공유": 55.51948051948052, "명확처리": 56.65584415584416, "태도개선": 52.75974025974026, "전반만족": 51.298701298701296, "종합점수": 53.63636363636363, "응답수": 154}, "연구부문": {"존중배려": 71.875, "정보공유": 66.31944444444444, "명확처리": 70.13888888888889, "태도개선": 67.36111111111111, "전반만족": 68.40277777777777, "종합점수": 68.81944444444444, "응답수": 72}, "기획부문": {"존중배려": 70.14925373134328, "정보공유": 69.02985074626865, "명확처리": 73.88059701492537, "태도개선": 69.31818181818181, "전반만족": 69.02985074626865, "종합점수": 70.3731343283582, "응답수": 67}, "디지털정보혁신본부": {"존중배려": 71.14485981308411, "정보공유": 69.48356807511738, "명확처리": 71.36150234741784, "태도개선": 69.31279620853081, "전반만족": 68.83720930232558, "종합점수": 69.97674418604652, "응답수": 215}, "교육부문": {"존중배려": 65.77380952380952, "정보공유": 65.47619047619048, "명확처리": 68.1547619047619, "태도개선": 66.96428571428571, "전반만족": 65.47619047619048, "종합점수": 66.36904761904762, "응답수": 84}, "국제사업실": {"존중배려": 63.559322033898304, "정보공유": 62.28813559322034, "명확처리": 63.559322033898304, "태도개선": 62.28813559322034, "전반만족": 59.32203389830509, "종합점수": 62.20338983050848, "응답수": 59}}, "2023": {"관리부문": {"존중배려": 72.31262327416174, "정보공유": 70.63465965143045, "명확처리": 71.5412421952021, "태도개선": 71.01221928665785, "전반만족": 70.81414473684211, "종합점수": 71.25054533508542, "응답수": 3044}, "커뮤니케이션실": {"존중배려": 71.69540229885058, "정보공유": 72.42857142857143, "명확처리": 70.85714285714286, "태도개선": 69.25287356321839, "전반만족": 69.71428571428571, "종합점수": 70.72857142857143, "응답수": 175}, "진료부문": {"존중배려": 68.65744773519164, "정보공유": 69.7546346782988, "명확처리": 69.44323144104804, "태도개선": 68.85111499781372, "전반만족": 68.0525283347864, "종합점수": 68.94009799651568, "응답수": 4592}, "간호부문": {"존중배려": 69.25772539025168, "정보공유": 68.89738687061823, "명확처리": 69.48869066581715, "태도개선": 69.10166240409207, "전반만족": 68.24410452517527, "종합점수": 68.96868152866242, "응답수": 3140}, "기타부문": {"존중배려": 45.91346153846154, "정보공유": 51.08173076923077, "명확처리": 52.41545893719807, "태도개선": 47.68292682926829, "전반만족": 46.875, "종합점수": 48.71995192307692, "응답수": 208}, "연구부문": {"존중배려": 74.37106918238993, "정보공유": 71.38364779874213, "명확처리": 72.32704402515724, "태도개선": 70.80645161290323, "전반만족": 72.0125786163522, "종합점수": 72.30345911949685, "응답수": 159}, "기획부문": {"존중배려": 68.97590361445783, "정보공유": 65.8132530120482, "명확처리": 69.42771084337349, "태도개선": 67.33128834355828, "전반만족": 66.41566265060241, "종합점수": 67.53012048192771, "응답수": 166}, "디지털정보혁신본부": {"존중배려": 77.82485875706215, "정보공유": 75.42372881355932, "명확처리": 75.28248587570621, "태도개선": 74.36079545454545, "전반만족": 75.14124293785311, "종합점수": 75.61440677966101, "응답수": 354}, "교육부문": {"존중배려": 77.64084507042253, "정보공유": 72.71126760563381, "명확처리": 75.52816901408451, "태도개선": 73.21428571428571, "전반만족": 75.17605633802818, "종합점수": 74.92957746478874, "응답수": 142}, "국제사업실": {"존중배려": 68.05555555555556, "정보공유": 69.44444444444444, "명확처리": 68.88888888888889, "태도개선": 67.13483146067416, "전반만족": 66.38888888888889, "종합점수": 68.05555555555556, "응답수": 90}}, "2024": {"관리부문": {"존중배려": 76.41147244805781, "정보공유": 74.47987336047038, "명확처리": 74.93231046931407, "태도개선": 73.9867941712204, "전반만족": 74.32034435885818, "종합점수": 74.82935047361298, "응답수": 2217}, "커뮤니케이션실": {"존중배려": 75.3623188405797, "정보공유": 75.18115942028986, "명확처리": 76.81159420289855, "태도개선": 74.27007299270073, "전반만족": 74.27007299270073, "종합점수": 75.20528985507246, "응답수": 138}, "진료부문": {"존중배려": 73.48090277777777, "정보공유": 73.87811233352635, "명확처리": 73.28985507246377, "태도개선": 72.88160185722577, "전반만족": 72.57457283521576, "종합점수": 73.20710358796296, "응답수": 3456}, "간호부문": {"존중배려": 73.94793926247289, "정보공유": 73.02688638334779, "명확처리": 73.77493495229835, "태도개선": 73.23529411764706, "전반만족": 72.9419410745234, "종합점수": 73.33820701602424, "응답수": 2309}, "기타부문": {"존중배려": 58.40163934426229, "정보공유": 63.31967213114754, "명확처리": 64.13934426229508, "태도개선": 60.65573770491803, "전반만족": 59.42622950819672, "종합점수": 61.18852459016394, "응답수": 122}, "연구부문": {"존중배려": 78.19148936170212, "정보공유": 76.59574468085107, "명확처리": 77.3936170212766, "태도개선": 74.73118279569893, "전반만족": 76.0752688172043, "종합점수": 76.48936170212765, "응답수": 94}, "기획부문": {"존중배려": 74.3801652892562, "정보공유": 71.90082644628099, "명확처리": 76.44628099173553, "태도개선": 70.83333333333333, "전반만족": 71.90082644628099, "종합점수": 73.14049586776859, "응답수": 121}, "디지털정보혁신본부": {"존중배려": 80.32646048109966, "정보공유": 80.58419243986255, "명확처리": 80.41237113402062, "태도개선": 79.89690721649484, "전반만족": 79.63917525773196, "종합점수": 80.17182130584193, "응답수": 291}, "교육부문": {"존중배려": 79.7872340425532, "정보공유": 78.72340425531915, "명확처리": 79.25531914893617, "태도개선": 78.72340425531915, "전반만족": 77.3936170212766, "종합점수": 78.77659574468085, "응답수": 94}, "국제사업실": {"존중배려": 71.03174603174604, "정보공유": 72.22222222222223, "명확처리": 71.42857142857143, "태도개선": 68.65079365079364, "전반만족": 67.06349206349206, "종합점수": 70.07936507936508, "응답수": 63}}, "2025": {"관리부문": {"존중배려": 79.58694659972615, "정보공유": 78.07498856881573, "명확처리": 78.49474645957058, "태도개선": 77.80192131747484, "전반만족": 77.92104062072113, "종합점수": 78.33732664233575, "응답수": 2192}, "커뮤니케이션실": {"존중배려": 79.52380952380952, "정보공유": 78.06603773584905, "명확처리": 78.73831775700934, "태도개선": 77.35849056603773, "전반만족": 76.6355140186916, "종합점수": 77.71420560747664, "응답수": 107}, "진료부문": {"존중배려": 76.21971736204576, "정보공유": 76.94378996970717, "명확처리": 76.2041091276524, "태도개선": 75.70219966159053, "전반만족": 75.49646583641871, "종합점수": 76.11265388496467, "응답수": 2973}, "간호부문": {"존중배려": 76.66596814752724, "정보공유": 76.21491411813993, "명확처리": 76.83900798654896, "태도개선": 75.89360807401178, "전반만족": 75.76487845766974, "종합점수": 76.25802763819095, "응답수": 2388}, "기타부문": {"존중배려": 57.7319587628866, "정보공유": 60.45918367346939, "명확처리": 61.98979591836735, "태도개선": 58.41836734693877, "전반만족": 57.90816326530612, "종합점수": 59.2219387755102, "응답수": 98}, "연구부문": {"존중배려": 80.3125, "정보공유": 78.4375, "명확처리": 80.3125, "태도개선": 76.26582278481013, "전반만족": 78.4375, "종합점수": 78.6875, "응답수": 80}, "기획부문": {"존중배려": 75.26315789473684, "정보공유": 75.52631578947368, "명확처리": 75.52631578947368, "태도개선": 74.21875, "전반만족": 72.65625, "종합점수": 74.32291666666667, "응답수": 96}, "디지털정보혁신본부": {"존중배려": 79.75409836065573, "정보공유": 77.71381578947368, "명확처리": 78.60655737704919, "태도개선": 77.88778877887789, "전반만족": 77.95081967213115, "종합점수": 78.3264918032787, "응답수": 305}, "교육부문": {"존중배려": 82.17821782178218, "정보공유": 79.95049504950495, "명확처리": 82.17821782178218, "태도개선": 79.95049504950495, "전반만족": 80.44554455445545, "종합점수": 80.94059405940594, "응답수": 101}, "국제사업실": {"존중배려": 75.71428571428571, "정보공유": 73.57142857142857, "명확처리": 73.92857142857143, "태도개선": 72.5, "전반만족": 71.42857142857143, "종합점수": 73.42857142857143, "응답수": 70}}}, "team_ranking": {"2022": [{"department": "어린이병원", "score": 87.5, "count": 2, "rank": 1}, {"department": "재활의학팀", "score": 86.6, "count": 59, "rank": 2}, {"department": "방사선종양팀", "score": 83.0, "count": 10, "rank": 3}, {"department": "심장혈관흉부외과", "score": 82.9, "count": 12, "rank": 4}, {"department": "소화기내시경팀", "score": 81.1, "count": 120, "rank": 5}, {"department": "건진운영팀", "score": 80.6, "count": 47, "rank": 6}, {"department": "특수검사팀", "score": 79.1, "count": 99, "rank": 7}, {"department": "심장병원", "score": 77.9, "count": 4, "rank": 8}, {"department": "핵의학팀", "score": 77.4, "count": 74, "rank": 9}, {"department": "심장검사팀", "score": 77.0, "count": 124, "rank": 10}, {"department": "영양팀", "score": 75.4, "count": 101, "rank": 11}, {"department": "운영지원팀", "score": 71.2, "count": 8, "rank": 12}, {"department": "병리팀", "score": 67.5, "count": 61, "rank": 13}, {"department": "진료협력팀", "score": 64.9, "count": 54, "rank": 14}, {"department": "영상의학팀", "score": 64.7, "count": 988, "rank": 15}, {"department": "대외협력팀", "score": 63.1, "count": 16, "rank": 16}, {"department": "진단검사의학팀", "score": 61.6, "count": 489, "rank": 17}, {"department": "약제팀", "score": 60.6, "count": 312, "rank": 18}, {"department": "PI팀", "score": 60.0, "count": 18, "rank": 19}, {"department": "감염관리팀", "score": 57.2, "count": 310, "rank": 20}, {"department": "진료지원팀", "score": 55.2, "count": 82, "rank": 21}], "2023": [{"department": "어린이병원", "score": 95.5, "count": 11, "rank": 1}, {"department": "재활의학팀", "score": 86.1, "count": 95, "rank": 2}, {"department": "심장혈관흉부외과", "score": 85.1, "count": 38, "rank": 3}, {"department": "소화기내시경팀", "score": 85.1, "count": 279, "rank": 4}, {"department": "운영지원팀", "score": 83.8, "count": 12, "rank": 5}, {"department": "심장병원", "score": 82.9, "count": 7, "rank": 6}, {"department": "심장검사팀", "score": 82.1, "count": 229, "rank": 7}, {"department": "영양팀", "score": 78.7, "count": 103, "rank": 8}, {"department": "핵의학팀", "score": 78.0, "count": 86, "rank": 9}, {"department": "특수검사팀", "score": 77.4, "count": 153, "rank": 10}, {"department": "진료협력팀", "score": 73.2, "count": 88, "rank": 11}, {"department": "방사선종양팀", "score": 70.5, "count": 21, "rank": 12}, {"department": "병리팀", "score": 68.9, "count": 95, "rank": 13}, {"department": "건진운영팀", "score": 68.6, "count": 113, "rank": 14}, {"department": "영상의학팀", "score": 67.1, "count": 1564, "rank": 15}, {"department": "대외협력팀", "score": 65.8, "count": 31, "rank": 16}, {"department": "약제팀", "score": 64.4, "count": 454, "rank": 17}, {"department": "진단검사의학팀", "score": 62.6, "count": 712, "rank": 18}, {"department": "감염관리팀", "score": 62.4, "count": 323, "rank": 19}, {"department": "진료지원팀", "score": 58.8, "count": 97, "rank": 20}, {"department": "PI팀", "score": 56.8, "count": 81, "rank": 21}], "2024": [{"department": "심장혈관흉부외과", "score": 92.1, "count": 19, "rank": 1}, {"department": "어린이병원", "score": 89.2, "count": 6, "rank": 2}, {"department": "심장병원", "score": 86.5, "count": 10, "rank": 3}, {"department": "건진운영팀", "score": 84.5, "count": 62, "rank": 4}, {"department": "재활의학팀", "score": 84.1, "count": 83, "rank": 5}, {"department": "심장검사팀", "score": 83.7, "count": 134, "rank": 6}, {"department": "운영지원팀", "score": 82.1, "count": 21, "rank": 7}, {"department": "특수검사팀", "score": 81.4, "count": 124, "rank": 8}, {"department": "영양팀", "score": 80.8, "count": 101, "rank": 9}, {"department": "소화기내시경팀", "score": 80.3, "count": 164, "rank": 10}, {"department": "병리팀", "score": 79.8, "count": 55, "rank": 11}, {"department": "진료협력팀", "score": 79.2, "count": 98, "rank": 12}, {"department": "방사성의약품제조소", "score": 77.5, "count": 2, "rank": 13}, {"department": "핵의학팀", "score": 75.9, "count": 98, "rank": 14}, {"department": "통합돌봄지원팀", "score": 74.4, "count": 8, "rank": 15}, {"department": "PI팀", "score": 74.1, "count": 49, "rank": 16}, {"department": "영상의학팀", "score": 72.5, "count": 1178, "rank": 17}, {"department": "방사선종양팀", "score": 72.5, "count": 22, "rank": 18}, {"department": "감염관리팀", "score": 71.1, "count": 236, "rank": 19}, {"department": "약제팀", "score": 70.2, "count": 350, "rank": 20}, {"department": "진료지원팀", "score": 67.0, "count": 93, "rank": 21}, {"department": "진단검사의학팀", "score": 64.2, "count": 520, "rank": 22}, {"department": "대외협력팀", "score": 60.1, "count": 23, "rank": 23}], "2025": [{"department": "심장병원", "score": 96.2, "count": 4, "rank": 1}, {"department": "어린이병원", "score": 93.8, "count": 8, "rank": 2}, {"department": "심장혈관흉부외과", "score": 89.4, "count": 18, "rank": 3}, {"department": "통합돌봄지원팀", "score": 88.8, "count": 12, "rank": 4}, {"department": "특수검사팀", "score": 86.4, "count": 145, "rank": 5}, {"department": "영양팀", "score": 84.9, "count": 85, "rank": 6}, {"department": "대외협력팀", "score": 84.8, "count": 27, "rank": 7}, {"department": "심장검사팀", "score": 84.5, "count": 120, "rank": 8}, {"department": "재활의학팀", "score": 83.4, "count": 80, "rank": 9}, {"department": "운영지원팀", "score": 83.1, "count": 16, "rank": 10}, {"department": "소화기내시경팀", "score": 82.7, "count": 142, "rank": 11}, {"department": "방사선종양팀", "score": 80.9, "count": 22, "rank": 12}, {"department": "핵의학팀", "score": 80.2, "count": 95, "rank": 13}, {"department": "병리팀", "score": 79.1, "count": 66, "rank": 14}, {"department": "감염관리팀", "score": 78.5, "count": 158, "rank": 15}, {"department": "진료협력팀", "score": 76.1, "count": 71, "rank": 16}, {"department": "건진운영팀", "score": 74.8, "count": 42, "rank": 17}, {"department": "PI팀", "score": 74.8, "count": 47, "rank": 18}, {"department": "영상의학팀", "score": 73.9, "count": 970, "rank": 19}, {"department": "약제팀", "score": 73.2, "count": 302, "rank": 20}, {"department": "진료지원팀", "score": 71.9, "count": 116, "rank": 21}, {"department": "진단검사의학팀", "score": 68.8, "count": 426, "rank": 22}, {"department": "방사성의약품제조소", "score": 25.0, "count": 1, "rank": 23}]}, "network_analysis": {"2022": {"collaboration_counts": {"암병원간호2팀 → 방사선종양팀": 4, "진료지원팀 → 방사선종양팀": 1, "내과간호2팀 → 방사선종양팀": 1, "핵의학팀 → 방사선종양팀": 1, "어린이병원간호팀 → 방사선종양팀": 3}, "total_evaluators": 5, "total_responses": 10}, "2023": {"collaboration_counts": {"암병원간호2팀 → 방사선종양팀": 9, "내과간호2팀 → 방사선종양팀": 1, "영상의학팀 → 방사선종양팀": 4, "의공팀 → 방사선종양팀": 1, "외래간호팀 → 방사선종양팀": 1, "핵의학팀 → 방사선종양팀": 1, "어린이병원간호팀 → 방사선종양팀": 2, "중환자간호팀 → 방사선종양팀": 1, "병리팀 → 방사선종양팀": 1}, "total_evaluators": 9, "total_responses": 21}, "2024": {"collaboration_counts": {"외래간호팀 → 방사선종양팀": 8, "어린이병원간호팀 → 방사선종양팀": 1, "재활의학팀 → 방사선종양팀": 3, "의공팀 → 방사선종양팀": 1, "암병원간호2팀 → 방사선종양팀": 3, "내과간호1팀 → 방사선종양팀": 1, "진단검사의학팀 → 방사선종양팀": 1, "의료정보관리팀 → 방사선종양팀": 1, "영상의학팀 → 방사선종양팀": 2, "외과간호1팀 → 방사선종양팀": 1}, "total_evaluators": 10, "total_responses": 22}, "2025": {"collaboration_counts": {"외래간호팀 → 방사선종양팀": 8, "암병원간호2팀 → 방사선종양팀": 1, "어린이병원간호팀 → 방사선종양팀": 2, "기획팀 → 방사선종양팀": 1, "의공팀 → 방사선종양팀": 2, "보안관리팀 → 방사선종양팀": 2, "중환자간호팀 → 방사선종양팀": 1, "응급간호팀 → 방사선종양팀": 1, "대외협력팀 → 방사선종양팀": 1, "영상의학팀 → 방사선종양팀": 2, "시설팀 → 방사선종양팀": 1}, "total_evaluators": 11, "total_responses": 22}}, "metadata": {"calculation_date": "2025-07-23T09:47:23.949109", "total_responses": 36866, "target_department": "방사선종양팀", "target_division": "진료부문", "security_level": "AGGREGATED_ONLY"}}, "rawData": [{"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "치료방 연결이 원활하지 않고 환자에게 방사선 시간 안내가 누락되는 경우가 있습니다.", "감정_분류": "부정", "핵심_키워드": ["치료방", "연결", "안내 누락", "환자"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "응대 시 적극적이고 신속한 피드백에 늘 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["응대", "피드백", "감사", "신속", "적극"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "환자의 갑작스러운 시간 변경 요청에 가끔 당황스러움을 느낍니다. 특히 재활 치료가 없는 시간대에는 괜찮지만, 재활 치료가 있는 경우에는 어려움이 있습니다.", "감정_분류": "부정", "핵심_키워드": ["환자 시간 변경", "당황", "재활 치료", "스케줄 관리"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 80.0, "정제된_텍스트": "당일 일정 조정", "감정_분류": "중립", "핵심_키워드": ["당일", "일정", "조정"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "진정제(향정신성) 약물을 직접 수령해야 하는 점이 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["진정제", "향정신성 약물", "수령 과정", "업무 효율"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 75.0, "정제된_텍스트": "병동 및 검사실 간 마약류/향정신성 의약품 이동을 최소화하는 방향으로 변화가 진행 중입니다. 하지만 방사선 검사 시에만 해당 약품이 이동하게 되어 파손 및 분실 위험이 발생하므로, 이에 대한 개선이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["마약류", "향정신성 의약품", "약품 이동", "파손", "분실 위험", "개선"]}, {"설문시행연도": "2022", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 75.0, "정제된_텍스트": "병동 간 또는 병동과 검사실 간 마약 및 향정신성 의약품 이송을 더 이상 하지 않는 방향으로 병원이 변화하고 있습니다. 하지만 방사선 검사 시에만 향정신성 의약품을 이송해야 하는 상황이 발생합니다. 이는 향정신성 의약품 분실 및 파손의 위험이 있어, 가능한 한 투약하는 장소에서 관리하는 것이 타당하다고 생각합니다.", "감정_분류": "부정", "핵심_키워드": ["마약", "향정신성 의약품", "이송", "안전", "업무 개선"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 65.0, "정제된_텍스트": "ONC 교수님과 상의된 내용임에도 RO 교수님과 추가로 의견을 확인하지 않고 지속적으로 안 된다는 답변만 받은 적이 있어 아쉬웠습니다.", "감정_분류": "부정", "핵심_키워드": ["의견 확인", "소통", "지속적인 답변", "아쉬움"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "팀 목표의 지향점 차이로 인해 현실적인 괴리가 발생하고 있습니다.", "감정_분류": "부정", "핵심_키워드": ["팀 목표", "지향점", "차이", "괴리"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "진료 후 일정 관련 정보는 담당 간호사에게 전화 대신 아산웍스로 보내주시면 업무 효율에 도움이 되겠습니다.", "감정_분류": "부정", "핵심_키워드": ["진료 일정", "전화 소통", "업무 효율", "아산웍스"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "늘 환자 일정과 검사 내용에 대해 잘 공유해 주십니다.", "감정_분류": "긍정", "핵심_키워드": ["환자 일정", "검사", "정보 공유"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 0.0, "종합점수": 45.0, "정제된_텍스트": "급하지 않은 업무에 대해 아산웍스 시스템을 통한 소통이 아닌 전화로 담당 간호사를 찾아 업무 지연이 발생하는 경우가 있습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 지연", "소통 방식", "전화", "아산웍스", "담당 간호사"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "X-ray 촬영 시 담당 간호사의 부재로 인해 환자 배액관 관리 및 상황 설명에 미흡한 점이 발생할 수 있으니 주의를 기울여 주셨으면 합니다. A-line 연결 해제나 배액관 정돈 미흡으로 인한 탈관 위험이 있어 환자 안전을 위해 중요합니다. 또한, X-ray 추가 촬영은 담당의 요청이나 상황 변화로 인해 반복적으로 필요할 수 있음을 이해해 주시기 바랍니다. 바쁜 상황에서 발생하는 간호사와의 소통 문제로 촬영이 지연될 수 있으며, 급한 경우 주로 전화로 연락하니 문자 중복은 드물다는 점도 이해 부탁드립니다. 반복 촬영은 환자 상태 악화나 긴급 시술과 관련하여 발생하므로, 바쁜 상황에서 이루어지는 것임을 알아주셨으면 합니다.", "감정_분류": "부정", "핵심_키워드": ["X-ray 촬영", "환자 안전", "소통", "업무 효율", "긴급 상황"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "간호요약정보를 바탕으로 한 불필요한 퇴원 관련 전화 문의가 발생했습니다. 해당 정보는 간호사 인수인계용이며 실시간으로 갱신되지 않습니다. 입원장 부재 문의가 있었으나 실제 입원장이 존재했으므로, 앞으로는 수진조회 탭을 통해 정보를 확인하도록 공지가 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["불필요한 문의", "간호요약정보", "수진조회", "업무 효율", "소통 개선"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 40.0, "정제된_텍스트": "입원환자의 방사선 외래 및 치료 일정 조율 과정에서 전화 통화로 인한 시간 소모가 큽니다. 환자 호출이나 일정 안내 시 네이버웍스 활용 또는 치료 일정 공유를 통해 업무 효율을 높이는 방안을 제안합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 효율", "치료 일정", "시간 소모", "소통 개선", "네이버웍스"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "협업이 원활하게 이루어지고 있습니다.", "감정_분류": "긍정", "핵심_키워드": ["협업", "원활", "효율"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "항상 만족스럽습니다.", "감정_분류": "긍정", "핵심_키워드": ["만족", "항상", "긍정적"]}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "환자 편의를 위해 노력해주신다.", "감정_분류": "긍정", "핵심_키워드": ["환자", "편의", "노력"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 60.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "방사선 치료 스케줄 및 준비사항에 대해 병동에 미리 연락해 주시는 점은 늘 감사합니다. 다만, 방사선 스케줄 처방의 잦은 변경으로 인해 업무에 큰 지장이 발생하고 있습니다. 처방이 변경될 때마다 시스템 팝업이 발생하고 기존 작업이 초기화되는 등 오류가 발생하여, 다른 환자 업무에도 영향을 미쳐 업무 마비가 초래될 정도였습니다. 이는 처방 입력 과정에서의 혼란이나, 시스템 운영 방식을 정확히 인지하지 못하여 발생한 문제로 보입니다. 앞으로는 잦은 처방 변경을 지양해 주시고, 불가피하게 여러 번 변경이 필요할 경우 미리 담당 간호사에게 상황을 전달해 주시기를 부탁드립니다.", "감정_분류": "부정", "핵심_키워드": ["방사선 스케줄", "처방 변경", "업무 지장", "시스템 오류", "사전 소통"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "CT sim 관련 일정 설명 및 변경 문의 시, 병동으로 연락할 때 담당 간호사가 지정되어 있다면 워크스테이션(웍스)을 통한 소통이 효율적일 것 같습니다. 현재는 반복적인 전화 문의로 인해 담당 간호사를 찾고 기다리는 데 많은 시간이 소요됩니다.", "감정_분류": "부정", "핵심_키워드": ["소통", "워크스테이션", "업무 효율", "시간 소요"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "방사선 전 항암치료 시행을 위한 시간 조율에 어려움이 있습니다. 마지막 CCRT 시행 시간이 너무 지연됩니다.", "감정_분류": "부정", "핵심_키워드": ["항암치료", "시간조율", "CCRT", "지연"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 25.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "e-MET로 관리하는 무선 모니터 부착 환자는 침대/카트 이송이 필요한데, 방사선 종양학과 외래에서는 휠체어 이송만 가능했습니다. 침대/카트 이송 시에도 외래 진료가 가능하도록 방안이 마련되면 좋겠습니다.", "감정_분류": "부정", "핵심_키워드": ["환자 이송", "외래 진료", "프로세스", "모니터 환자"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "CT 시뮬레이션 시 준비사항에 대해 담당 간호사에게 공유해 주시면 좋겠습니다.", "감정_분류": "중립", "핵심_키워드": ["CT 시뮬레이션", "준비사항", "정보 공유", "담당 간호사"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "검사 시 주의사항을 정확히 인계하지 않아 재검사가 필요했던 경우가 있었으나, 이후부터는 신경 써서 인계해 주셔서 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["주의사항", "인계", "재검사", "만족", "개선"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "전보다 환자 만족도 개선이 증진되었습니다.", "감정_분류": "긍정", "핵심_키워드": ["환자 만족도", "개선", "증진"]}, {"설문시행연도": "2024", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "호흡재활치료 환자의 부서 간 협업으로 치료 스케줄 공유 및 조정 업무가 이루어져, 환자의 미내원율 감소와 치료율 개선에 긍정적인 성과를 보였습니다.", "감정_분류": "긍정", "핵심_키워드": ["부서 협업", "치료 스케줄", "미내원율 감소", "치료율 개선", "긍정적 성과"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "담당간호사가 등록되어 있음에도 웍스(협업 툴)를 통한 소통이 아닌 전화 연락으로 인해, 담당간호사를 찾아 내용을 다시 설명하고 전달하는 과정에 어려움이 있습니다. 담당간호사 등록 시 치료 내용이나 외래 일정 등에 대해 웍스(협업 툴)를 활용한 소통이 이루어지면 좋을 것 같습니다. 병동 환자 간호 중에는 전화 응대가 어렵습니다.", "감정_분류": "부정", "핵심_키워드": ["소통", "협업_툴", "업무_효율", "전화_응대", "담당간호사"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "소아 환자를 이해하고 배려해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["소아 환자", "이해", "배려", "감사"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "인력 검토를 위한 자료 요청에 대해 빠르고 정확하게 회신해주셨고, 업무 관련 질문에도 친절하고 자세히 알려주셨습니다.", "감정_분류": "긍정", "핵심_키워드": ["자료 요청", "빠른 회신", "정확성", "친절", "업무 지원"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "업무 중 잘못된 부분에 대해 긍정적인 피드백을 주시고 항상 배려해 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["긍정적 피드백", "배려", "감사", "업무"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "진료 중 급하게 치료 일정 변경 문의 시 빠른 답변 해주시고 되도록이면 원하는 일정으로 배정해 주셔서 항상 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["치료 일정", "빠른 답변", "일정 배정", "감사"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "출입 관련 문의 전화에 친절하게 응대해 주십니다.", "감정_분류": "긍정", "핵심_키워드": ["친절", "응대", "전화문의", "출입"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 50.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 90.0, "정제된_텍스트": "방사선치료 일정 조정 시 이전보다 빠르게 처리되어 환자의 대기 시간이 줄었고, 그에 따른 불만이 감소했습니다.", "감정_분류": "긍정", "핵심_키워드": ["방사선치료", "일정 조정", "대기시간 감소", "불만 감소"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "많은 외래 선생님들이 계시지만, 특히 방사선외래 선생님들은 라운딩 중에 항상 인사해 주셔서 기분이 좋습니다.", "감정_분류": "긍정", "핵심_키워드": ["방사선외래", "인사", "라운딩", "긍정적 분위기"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 75.0, "전반만족": 25.0, "종합점수": 45.0, "정제된_텍스트": "검사 처방이 하루에도 수십 번 바뀌고, 퇴원 시 미접수된 검사 때문에 퇴원이 지연되는 일이 반복되고 있습니다. 협조 부탁드립니다.", "감정_분류": "부정", "핵심_키워드": ["검사 처방", "퇴원 지연", "업무 반복", "협조"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "맞춤 일정 조율 및 진행", "감정_분류": "긍정", "핵심_키워드": ["일정 조율", "일정 진행", "맞춤"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "항상 친절하게 해주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["친절", "감사"]}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료계획 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "진료부문", "피평가부서": "방사선종양팀", "피평가Unit": "치료 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}], "security": {"target_department": "방사선종양팀", "target_division": "진료부문", "data_scope": "방사선종양팀 관련 데이터만 포함", "security_level": "HIGH", "aggregated_sections": ["전체 연도별", "부문별 연도별", "부문 비교", "팀 순위"], "filtered_sections": ["부서 상세분석", "네트워크 분석"]}};
        const rawData = hybridData.rawData;  // 필터링된 부서 데이터만 포함
        const aggregatedData = hybridData.aggregated;  // 미리 계산된 집계 데이터
        const securityInfo = hybridData.security;
        
        const scoreCols = ['존중배려', '정보공유', '명확처리', '태도개선', '전반만족', '종합점수'];
        const allYears = [...new Set(rawData.map(item => item['설문시행연도']))].sort();
        // 부문 비교용: 집계 데이터에서 모든 부문 가져오기
        const allDivisions = Object.keys(aggregatedData.division_comparison).length > 0 
            ? [...new Set(Object.values(aggregatedData.division_comparison).flatMap(yearData => Object.keys(yearData)))].sort((a, b) => a.localeCompare(b, 'ko'))
            : ["진료부문"];
        const layoutFont = { size: 14 };
        
        // 보안 정보 콘솔 출력
        console.log('🔒 보안 정보:', securityInfo);
        console.log('📊 데이터 범위:', securityInfo.data_scope);

        const departmentUnitMap = rawData.reduce((acc, item) => {
            const dept = item['피평가부서'];
            const unit = item['피평가Unit'];
            if (dept && dept !== 'N/A' && unit && unit !== 'N/A') {
                if (!acc[dept]) { acc[dept] = new Set(); }
                acc[dept].add(unit);
            }
            return acc;
        }, {});
        for (const dept in departmentUnitMap) {
            departmentUnitMap[dept] = [...departmentUnitMap[dept]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function populateFilters() {
            // 연도 필터 설정
            const yearSelect = document.getElementById('year-filter');
            const years = [...new Set(rawData.map(item => item['설문시행연도']))].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
            yearSelect.innerHTML = ['전체', ...years].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.addEventListener('change', updateDashboard);
            
            // 부서 필터를 방사선종양팀으로 고정
            const deptSelect = document.getElementById('department-filter');
            deptSelect.innerHTML = `<option value="방사선종양팀">방사선종양팀</option>`;
            deptSelect.value = "방사선종양팀";
            deptSelect.addEventListener('change', updateUnitFilter);
            
            // Unit 필터 초기화
            updateUnitFilter();
        }

        function updateUnitFilter() {
            const deptSelect = document.getElementById('department-filter');
            const unitSelect = document.getElementById('unit-filter');
            const selectedDept = deptSelect.value;

            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];

            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            // Unit 필터 변경 시 차트 실시간 업데이트
            unitSelect.addEventListener('change', updateDashboard);
        }

        function setupDivisionChart() {
            const select = document.getElementById('division-chart-filter');
            // 고정값: 진료부문만 선택 가능
            select.innerHTML = `<option value="진료부문">진료부문</option>`;
            select.value = "진료부문";
            select.addEventListener('change', updateDivisionYearlyChart);
            createCheckboxFilter('division-score-filter', scoreCols, 'division-score', updateDivisionYearlyChart);
            // 초기 차트 표시
            updateDivisionYearlyChart();
        }
        
        function setupComparisonChart() {
            const yearSelect = document.getElementById('comparison-year-filter');
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1]; // Default to last year
            yearSelect.addEventListener('change', updateYearlyDivisionComparisonChart);
            createCheckboxFilter('comparison-division-filter', allDivisions, 'comparison-division', updateYearlyDivisionComparisonChart, true);
        }

        function getFilteredData() {
            let filteredData = [...rawData];
            const filters = { 'year-filter': '설문시행연도', 'department-filter': '피평가부서', 'unit-filter': '피평가Unit' };
            for (const [elementId, dataCol] of Object.entries(filters)) {
                const selectedValue = document.getElementById(elementId).value;
                if (selectedValue !== '전체') { filteredData = filteredData.filter(item => item[dataCol] == selectedValue); }
            }
            return filteredData;
        }

        function updateDashboard() {
            const filteredData = getFilteredData();
            updateMetrics(filteredData);
            updateDrilldownChart(filteredData);
            updateSentimentChart(filteredData);
            updateReviewsTable(filteredData);
            updateKeywordAnalysis(filteredData);
            updateYearlyComparisonChart();
            updateUnitComparisonChart();
        }
        
        function calculateAverages(data) {
            const averages = {};
            scoreCols.forEach(col => {
                const total = data.reduce((sum, item) => sum + (item[col] || 0), 0);
                averages[col] = data.length > 0 ? (total / data.length) : 0;
            });
            return averages;
        }

        function updateMetrics(data) {
            const container = document.getElementById('metrics-container');
            if (data.length === 0) { container.innerHTML = "<p style='text-align:center;'>선택된 조건에 해당하는 데이터가 없습니다.</p>"; return; }
            const averages = calculateAverages(data);
            container.innerHTML = `<div class="metric"><div class="metric-value">${data.length}</div><div class="metric-label">응답 수</div></div><div class="metric"><div class="metric-value">${averages['종합점수'].toFixed(1)}</div><div class="metric-label">종합점수</div></div>`;
        }
        
        function updateDrilldownChart(data) {
            const container = document.getElementById('drilldown-chart-container');
            if (!container) return;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (data.length === 0 || selectedScores.length === 0) { 
                const message = data.length > 0 ? '표시할 문항을 선택해주세요.' : '';
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: message, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const averages = calculateAverages(data);
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            const chartData = [{ x: selectedScores, y: selectedScores.map(col => averages[col].toFixed(1)), type: 'bar', text: selectedScores.map(col => averages[col].toFixed(1)), textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[0], line: { color: '#000000', width: 1 } }, hovertemplate: '%{x}: %{y}<extra></extra>' }];
            const selectedYear = document.getElementById('year-filter').value;
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            
            // 제목 생성
            let titleParts = [];
            if (selectedDept !== '전체') { titleParts.push(selectedDept); }
            if (selectedUnit !== '전체') { titleParts.push(selectedUnit); }
            
            const titlePrefix = titleParts.length > 0 ? titleParts.join(' > ') : '부서, Unit';
            const yearSuffix = selectedYear === '전체' ? ' (전체 연도)' : ` (${selectedYear})`;
            const title = `<b>${titlePrefix} 문항 점수${yearSuffix}</b>`;
            const layout = { title: title, yaxis: { title: '점수', range: [0, 100] }, font: layoutFont, hovermode: 'closest', margin: { l: 60, r: 60, t: 80, b: 60 } };
            Plotly.react(container, chartData, layout);
        }
        
        function updateHospitalYearlyChart() {
            const container = document.getElementById('hospital-yearly-chart-container');
            const selectedScores = Array.from(document.querySelectorAll('input[name="hospital-score"]:checked')).map(cb => cb.value);
            
            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 집계 데이터 사용
            const hospitalData = aggregatedData.hospital_yearly;
            const years = Object.keys(hospitalData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => hospitalData[year][col] ? hospitalData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => hospitalData[year]['응답수'] || 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: '<b>병원 전체 결과</b>',
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateDivisionYearlyChart() {
            const container = document.getElementById('division-yearly-chart-container');
            const selectedDivision = document.getElementById('division-chart-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="division-score"]:checked')).map(cb => cb.value);

            // 진료부문로 고정되어 있으므로 선택 확인 불필요

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문별 집계 데이터 사용
            const divisionData = aggregatedData.division_yearly[selectedDivision] || {};
            const years = Object.keys(divisionData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => divisionData[year] && divisionData[year][col] ? divisionData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => divisionData[year] ? divisionData[year]['응답수'] || 0 : 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: `<b>[${selectedDivision}] 결과</b>`,
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateYearlyDivisionComparisonChart() {
            const container = document.getElementById('comparison-chart-container');
            const selectedYear = document.getElementById('comparison-year-filter').value;
            const selectedDivisions = Array.from(document.querySelectorAll('input[name="comparison-division"]:checked')).map(cb => cb.value);

            if (selectedDivisions.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '비교할 부문을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문 비교 집계 데이터 사용 (모든 부문 포함)
            const comparisonData = aggregatedData.division_comparison[selectedYear] || {};
            
            const divisions = selectedDivisions.filter(div => comparisonData[div]).sort((a,b) => a.localeCompare(b, 'ko'));
            const avgScores = divisions.map(div => comparisonData[div]['종합점수'] ? comparisonData[div]['종합점수'].toFixed(1) : '0.0');
            const responseCounts = divisions.map(div => comparisonData[div]['응답수'] || 0);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = { x: divisions, y: avgScores, type: 'bar', text: avgScores, textposition: 'outside', textfont: { size: 14 }, marker: { color: '#FDC1B4', line: { color: '#000000', width: 1 } }, customdata: responseCounts, hovertemplate: '%{x}: %{y}점<br>응답수: %{customdata}건<extra></extra>' };
            
            const avgLine = {
                x: [divisions[0], divisions[divisions.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };
            
            const layout = {
                title: `<b>${selectedYear} 부문별 종합 점수</b>`,
                yaxis: { title: '점수', range: [0, 100] },
                font: layoutFont,
                height: 500,
                barmode: 'group',
                hovermode: 'closest',
                showlegend: false,
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };
            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateSentimentChart(data) {
            const container = document.getElementById('sentiment-chart-container');
            
            if (data.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류가 있는 데이터만 필터링
            const validSentimentData = data.filter(item => {
                const sentiment = item['감정_분류'];
                return sentiment && sentiment !== 'N/A' && sentiment !== '알 수 없음';
            });

            if (validSentimentData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '감정 분류 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류별 집계 (알 수 없음 제외)
            const sentimentCounts = {};
            validSentimentData.forEach(item => {
                const sentiment = item['감정_분류'];
                sentimentCounts[sentiment] = (sentimentCounts[sentiment] || 0) + 1;
            });

            // 원하는 순서로 감정 분류 고정
            const desiredOrder = ['긍정', '부정', '중립'];
            const sentiments = desiredOrder.filter(sentiment => sentimentCounts[sentiment] > 0);
            const counts = sentiments.map(sentiment => sentimentCounts[sentiment]);
            const total = counts.reduce((sum, count) => sum + count, 0);
            const percentages = counts.map(count => ((count / total) * 100).toFixed(1));

            // 색상 매핑
            const colorMap = {
                '긍정': '#72B0AB',
                '부정': '#FE9179', 
                '중립': '#FFF6F5',
                '알 수 없음': '#808080'
            };
            const colors = sentiments.map(sentiment => colorMap[sentiment] || '#808080');

            const trace = {
                x: sentiments,
                y: counts,
                type: 'bar',
                text: counts.map((count, idx) => `${count}건 (${percentages[idx]}%)`),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{x}: %{y}건 (%{text})<extra></extra>'
            };

            const layout = {
                title: '',
                height: 400,
                xaxis: { title: '감정 분류' },
                yaxis: { title: '응답 수', rangemode: 'tozero', range: [0, Math.max(...counts) * 1.15] },
                font: layoutFont,
                hovermode: 'closest',
                showlegend: false,
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };

            Plotly.react(container, [trace], layout);
        }


        function updateReviewsTable(data = null) {
            const tbody = document.querySelector("#reviews-table tbody");
            
            if (data === null) { data = getFilteredData(); }
            
            const selectedSentiments = Array.from(document.querySelectorAll('input[name="review-sentiment"]:checked')).map(cb => cb.value);
            
            let filteredData = data;
            if (selectedSentiments.length > 0 && !selectedSentiments.includes('전체')) {
                filteredData = data.filter(item => selectedSentiments.includes(item['감정_분류']));
            }
            
            const reviews = filteredData.map(item => ({ 
                year: item['설문시행연도'], 
                review: item['정제된_텍스트'],
                sentiment: item['감정_분류'] || '알 수 없음'
            })).filter(r => r.review && r.review !== 'N/A')
            .sort((a, b) => b.year - a.year)
            .slice(0, 40000); // 최대 40000개만 표시
            
            // 후기 개수 표시 업데이트
            const countDisplay = document.getElementById('reviews-count-display');
            if (countDisplay) {
                countDisplay.textContent = `(${reviews.length}건)`;
            }
            
            tbody.innerHTML = (reviews.length > 0) ? 
                reviews.map(r => `<tr><td>${r.year}</td><td>${r.review} <span style="color: #666; font-size: 0.9em;">[${r.sentiment}]</span></td></tr>`).join('') : 
                '<tr><td colspan="2">해당 조건의 후기가 없습니다.</td></tr>';
        }

        function updateKeywordAnalysis(data) {
            const positiveCounts = {};
            const negativeCounts = {};

            data.forEach(item => {
                const keywords = item['핵심_키워드'];
                if (keywords && Array.isArray(keywords) && keywords.length > 0) {
                    const sentiment = item['감정_분류'];
                    keywords.forEach(kw => {
                        if (sentiment === '긍정') {
                            positiveCounts[kw] = (positiveCounts[kw] || 0) + 1;
                        } else if (sentiment === '부정') {
                            negativeCounts[kw] = (negativeCounts[kw] || 0) + 1;
                        }
                    });
                }
            });

            const topPositive = Object.entries(positiveCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);
            const topNegative = Object.entries(negativeCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);

            const posChartContainer = document.getElementById('positive-keywords-chart');
            const negChartContainer = document.getElementById('negative-keywords-chart');

            if (posChartContainer) plotKeywordChart(posChartContainer, '긍정 키워드 Top 10', topPositive, '긍정');
            if (negChartContainer) plotKeywordChart(negChartContainer, '부정 키워드 Top 10', topNegative, '부정');
            
            displayKeywordReviews(null, null, true);
        }

        function plotKeywordChart(container, title, data, sentiment) {
            if (!container) return;
            if (data.length === 0) {
                Plotly.react(container, [], { title: `<b>${title}</b>`, height: 400, annotations: [{ text: '데이터 없음', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false }] });
                return;
            }

            const trace = {
                y: data.map(d => d[0]).reverse(),
                x: data.map(d => d[1]).reverse(),
                type: 'bar',
                orientation: 'h',
                marker: { color: sentiment === '긍정' ? '#72B0AB' : '#FE9179', line: { color: '#000000', width: 1 } },
                hovertemplate: '언급 횟수: %{x}<extra></extra>'
            };

            const layout = {
                title: `<b>${title}</b>`,
                height: 400,
                margin: { l: 120, r: 40, t: 80, b: 60 },
                xaxis: { title: '언급 횟수' },
                yaxis: { automargin: true }
            };

            Plotly.react(container, [trace], layout);
            container.removeAllListeners('plotly_click');
            container.on('plotly_click', (eventData) => {
                const keyword = eventData.points[0].y;
                displayKeywordReviews(keyword, sentiment);
            });
        }

        function displayKeywordReviews(keyword, sentiment, isInitial = false) {
            const container = document.getElementById('keyword-reviews-container');
            if (!container) return;
            
            if (isInitial) {
                container.innerHTML = `<h4>관련 리뷰</h4><p>위 그래프의 막대를 클릭하면 관련 리뷰를 확인할 수 있습니다.</p><div id="keyword-reviews-table-container"><table id="keyword-reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody><tr><td colspan="2" style="text-align:center;"></td></tr></tbody></table></div>`;
                return;
            }

            const filteredData = getFilteredData();
            
            const reviews = filteredData.filter(item => 
                item['감정_분류'] === sentiment && 
                Array.isArray(item['핵심_키워드']) && 
                item['핵심_키워드'].includes(keyword)
            );

            let content = `<h4>'${keyword}' (${sentiment}) 관련 리뷰 (${reviews.length}건)</h4>`;
            if (reviews.length > 0) {
                content += `<div id="keyword-reviews-table-container"><table id="keyword-reviews-table">
                    <thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody>`;
                content += reviews.slice(0, 40000).map(r => `<tr><td>${r['설문시행연도']}</td><td>${r['정제된_텍스트']}</td></tr>`).join(''); // 최대 40000개만 표시
                content += `</tbody></table></div>`;
            } else {
                content += '<p>관련 리뷰가 없습니다.</p>';
            }
            container.innerHTML = content;
        }

        function setupTeamRankingChart() {
            const yearSelect = document.getElementById('team-ranking-year-filter');
            const divisionSelect = document.getElementById('team-ranking-division-filter');
            
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1];
            
            // 고정값: 진료부문만 선택 가능
            divisionSelect.innerHTML = `<option value="진료부문">진료부문</option>`;
            divisionSelect.value = "진료부문";
            
            yearSelect.addEventListener('change', updateTeamRankingChart);
            divisionSelect.addEventListener('change', updateTeamRankingChart);
            // 초기 차트 표시
            updateTeamRankingChart();
        }

        function updateTeamRankingChart() {
            const container = document.getElementById('team-ranking-chart-container');
            const selectedYear = document.getElementById('team-ranking-year-filter').value;
            const selectedDivision = document.getElementById('team-ranking-division-filter').value;

            // 진료부문로 고정되어 있으므로 선택 확인 불필요

            // 미리 계산된 팀 순위 집계 데이터 사용
            const teamRankingData = aggregatedData.team_ranking[selectedYear] || [];
            
            // 해당 부문에 속한 팀들만 필터링 (진료부문 소속 부서들)
            const teamRankings = teamRankingData.filter(team => {
                // 동적으로 해당 부문의 부서들을 포함
                return true; // 이미 집계 데이터에서 해당 부문만 포함되어 있음
            });

            if (teamRankings.length === 0) {
                Plotly.react(container, [], {
                    height: 600,
                    annotations: [{ text: '선택된 조건에 해당하는 부서 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 모든 부문 동일 색상 사용
            const departments = teamRankings.map(item => item.department);
            const scores = teamRankings.map(item => parseFloat(item.score));
            const colors = teamRankings.map(() => '#FDC1B4');
            const hoverTexts = teamRankings.map(item => `부서: ${item.department}<br>점수: ${item.score.toFixed(1)}<br>응답수: ${item.count}건`);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = {
                x: departments, y: scores, type: 'bar', text: scores.map(score => score.toFixed(1)),
                textposition: 'outside', textfont: { size: 12 }, marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{hovertext}<extra></extra>', hovertext: hoverTexts
            };

            const avgLine = {
                x: [departments[0], departments[departments.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };

            const layout = {
                title: `<b>${selectedYear} 팀별 종합점수</b>`, height: 600,
                xaxis: { title: '부서', tickangle: -45, automargin: true },
                yaxis: { title: '점수', range: [Math.min(...scores) - 5, Math.max(...scores) + 5] },
                font: layoutFont, hovermode: 'closest', showlegend: false,
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.02, xanchor: 'right', x: 1 },
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 100 }
            };

            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateYearlyComparisonChart() {
            const container = document.getElementById('yearly-comparison-chart-container');
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let targetData = [...rawData];
            if (selectedDept !== '전체') { targetData = targetData.filter(item => item['피평가부서'] === selectedDept); }
            if (selectedUnit !== '전체') { targetData = targetData.filter(item => item['피평가Unit'] === selectedUnit); }

            if (targetData.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const years = [...new Set(targetData.map(item => item['설문시행연도']))].sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => {
                    const yearData = targetData.filter(d => d['설문시행연도'] === year);
                    return yearData.length > 0 ? (yearData.reduce((sum, item) => sum + (item[col] || 0), 0) / yearData.length).toFixed(1) : 0;
                });
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => targetData.filter(d => d['설문시행연도'] === year).length);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            let titleText = '결과';
            if (selectedDept !== '전체' && selectedUnit !== '전체') { titleText = `[${selectedDept} > ${selectedUnit}] 결과`; }
            else if (selectedDept !== '전체') { titleText = `[${selectedDept}] 결과`; }
            else if (selectedUnit !== '전체') { titleText = `[${selectedUnit}] 결과`; }
            
            const layout = {
                title: `<b>${titleText}</b>`, barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            
            Plotly.react(container, traces, layout);
        }

        function setupUnitComparisonChart() {
            // Unit comparison chart uses main filters from detailed analysis section
            // No separate filters needed
        }

        function updateUnitComparisonChart() {
            const container = document.getElementById('unit-comparison-chart-container');
            const selectedDepartment = document.getElementById('department-filter').value;
            const selectedYear = document.getElementById('year-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedDepartment === '전체') {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: 'Unit 간 비교를 위해 부서를 선택해 주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let departmentData = rawData.filter(item => item['피평가부서'] === selectedDepartment);
            if (selectedYear !== '전체') { departmentData = departmentData.filter(item => item['설문시행연도'] === selectedYear); }

            const unitsInDepartment = [...new Set(departmentData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a, b) => String(a).localeCompare(String(b), 'ko'));

            if (unitsInDepartment.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 Unit이 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const traces = [];
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = unitsInDepartment.map(unit => {
                    const unitData = departmentData.filter(item => item['피평가Unit'] === unit);
                    return unitData.length > 0 ? (unitData.reduce((sum, item) => sum + (item[col] || 0), 0) / unitData.length).toFixed(1) : 0;
                });
                traces.push({ x: unitsInDepartment, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>Unit: %{x}<extra></extra>' });
            });

            const layout = {
                title: `<b>[${selectedDepartment}] Unit별 결과</b>`, barmode: 'group', height: 400,
                xaxis: { title: 'Unit' }, yaxis: { title: '점수', range: [0, 100] },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };

            Plotly.react(container, traces, layout);
        }

        function toggleExpander(expanderId) {
            const content = document.getElementById(expanderId);
            const arrow = document.getElementById(expanderId.replace('-expander', '-arrow'));
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                arrow.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                arrow.classList.add('expanded');
            }
        }

        function updateExpanderHeader(groupName, selectedCount, totalCount) {
            const headerId = groupName.replace('-filter', '-header');
            const headerSpan = document.querySelector(`#${headerId} span:first-child`);
            if (headerSpan) {
                if (groupName.includes('division-filter')) {
                    headerSpan.textContent = `부문 선택 (${selectedCount}개 선택됨)`;
                } else {
                    headerSpan.textContent = `문항 선택 (${selectedCount}개 선택됨)`;
                }
            }
        }

        function createCheckboxFilter(containerId, items, groupName, updateFunction, startChecked = true) {
            const container = document.getElementById(containerId);
            
            const selectAllDiv = document.createElement('div');
            selectAllDiv.className = 'checkbox-item';
            selectAllDiv.innerHTML = `<input type="checkbox" id="${groupName}-select-all" ${startChecked ? 'checked' : ''}><label for="${groupName}-select-all"><b>전체 선택</b></label>`;
            container.appendChild(selectAllDiv);
            
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'checkbox-item';
                itemDiv.innerHTML = `<input type="checkbox" id="${groupName}-${item}" name="${groupName}" value="${item}" ${startChecked ? 'checked' : ''}><label for="${groupName}-${item}">${item}</label>`;
                container.appendChild(itemDiv);
            });

            const selectAllCheckbox = container.querySelector(`#${groupName}-select-all`);
            const itemCheckboxes = container.querySelectorAll(`input[name="${groupName}"]`);

            function updateSelectAllState() {
                const allChecked = [...itemCheckboxes].every(cb => cb.checked);
                const someChecked = [...itemCheckboxes].some(cb => cb.checked);
                const checkedCount = [...itemCheckboxes].filter(cb => cb.checked).length;
                
                selectAllCheckbox.checked = allChecked;
                selectAllCheckbox.indeterminate = !allChecked && someChecked;
                
                updateExpanderHeader(containerId, checkedCount, items.length);
            }

            selectAllCheckbox.addEventListener('change', (e) => {
                itemCheckboxes.forEach(checkbox => { checkbox.checked = e.target.checked; });
                updateSelectAllState();
                updateFunction();
            });

            itemCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateSelectAllState();
                    updateFunction();
                });
            });

            updateSelectAllState();
        }

        // === 협업 네트워크 분석 기능 ===
        
        // 부문-부서-Unit 매핑 생성
        const divisionDepartmentMap = rawData.reduce((acc, item) => {
            const division = item['피평가부문'];
            const department = item['피평가부서'];
            if (division && division !== 'N/A' && department && department !== 'N/A') {
                if (!acc[division]) { acc[division] = new Set(); }
                acc[division].add(department);
            }
            return acc;
        }, {});
        for (const division in divisionDepartmentMap) {
            divisionDepartmentMap[division] = [...divisionDepartmentMap[division]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function setupNetworkAnalysis() {
            const yearSelect = document.getElementById('network-year-filter');
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const minCollabSelect = document.getElementById('min-collaboration-filter');
            
            // 연도 필터 설정
            yearSelect.innerHTML = ['전체', ...allYears].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            
            // 부문 필터 설정 - 고정값: 진료부문만 선택 가능
            divisionSelect.innerHTML = `<option value="진료부문">진료부문</option>`;
            divisionSelect.value = "진료부문";
            
            // 초기 부서, Unit 설정
            departmentSelect.innerHTML = '<option value="전체">전체</option>';
            unitSelect.innerHTML = '<option value="전체">전체</option>';
            
            // 이벤트 리스너 추가 (연도와 최소 횟수 필터만)
            yearSelect.addEventListener('change', updateNetworkAnalysis);
            minCollabSelect.addEventListener('change', updateNetworkAnalysis);
            
            // 초기 네트워크 분석 표시
            updateNetworkAnalysis();
        }

        function updateNetworkDepartments() {
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDivision = divisionSelect.value;
            
            // 부서 드롭다운을 방사선종양팀으로 고정
            departmentSelect.innerHTML = `<option value="방사선종양팀">방사선종양팀</option>`;
            departmentSelect.value = "방사선종양팀";
            
            // 부서 필터가 변경되었으므로, Unit 필터를 업데이트하고 분석을 새로고침합니다.
            updateNetworkUnits();
        }

        function updateNetworkUnits() {
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDept = departmentSelect.value;
            
            // Unit 드롭다운 업데이트
            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];
            
            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            updateNetworkAnalysis();
        }

        function getNetworkFilteredData() {
            let filteredData = [...rawData];
            
            const selectedYear = document.getElementById('network-year-filter').value;
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedYear !== '전체') { filteredData = filteredData.filter(item => String(item['설문시행연도']) === String(selectedYear)); }
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }
        
        function getNetworkFilteredDataWithoutYear() {
            let filteredData = [...rawData];
            
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }

        function updateNetworkAnalysis() {
            updateCollaborationFrequencyChart();
        }

        function updateCollaborationFrequencyChart() {
            const container = document.getElementById('collaboration-frequency-chart-container');
            const selectedYear = document.getElementById('network-year-filter').value;
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            // 집계된 네트워크 분석 데이터 사용
            let collaborationCounts = {};
            if (selectedYear === '전체') {
                // 모든 연도의 협업 횟수 합산
                Object.keys(aggregatedData.network_analysis || {}).forEach(year => {
                    const yearData = aggregatedData.network_analysis[year];
                    if (yearData && yearData.collaboration_counts) {
                        Object.entries(yearData.collaboration_counts).forEach(([relation, count]) => {
                            collaborationCounts[relation] = (collaborationCounts[relation] || 0) + count;
                        });
                    }
                });
            } else {
                // 특정 연도의 협업 횟수만 사용
                const yearData = aggregatedData.network_analysis && aggregatedData.network_analysis[selectedYear];
                if (yearData && yearData.collaboration_counts) {
                    collaborationCounts = yearData.collaboration_counts;
                }
            }
            
            // 데이터가 없는 경우 처리
            if (Object.keys(collaborationCounts).length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            // 최소 협업 횟수 이상인 관계만 필터링
            const filteredCollaborations = Object.entries(collaborationCounts)
                .filter(([_, count]) => count >= minCollabCount)
                .sort((a, b) => b[1] - a[1]);
            
            if (filteredCollaborations.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: `최소 ${minCollabCount}회 이상 협업한 관계가 없습니다.`, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            const trace = {
                y: filteredCollaborations.map(([key, _]) => key).reverse(),
                x: filteredCollaborations.map(([_, count]) => count).reverse(),
                type: 'bar',
                orientation: 'h',
                text: filteredCollaborations.map(([_, count]) => `${count}회`).reverse(),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: '#355E58', line: { color: '#000000', width: 1 } },
                hovertemplate: '협업 횟수: %{x}회<extra></extra>'
            };
            
            // 부서 수에 따라 동적 높이 계산 (막대당 최소 25px 보장)
            const barHeight = 25;
            const dynamicHeight = Math.max(400, filteredCollaborations.length * barHeight + 100);
            
            const layout = {
                title: '<b>부서 리스트</b>',
                height: dynamicHeight,
                margin: { l: 150, r: 40, t: 80, b: 60 },
                xaxis: { title: '협업 횟수' },
                yaxis: { 
                    automargin: true,
                    fixedrange: true,
                    categoryorder: 'total ascending'
                },
                font: layoutFont
            };
            
            Plotly.react(container, [trace], layout);
        }

        



        window.onload = () => { 
            populateFilters(); 
            createCheckboxFilter('hospital-score-filter', scoreCols, 'hospital-score', updateHospitalYearlyChart);
            createCheckboxFilter('drilldown-score-filter', scoreCols, 'drilldown-score', updateDashboard);
            createCheckboxFilter('review-sentiment-filter', ['긍정', '부정', '중립'], 'review-sentiment', updateReviewsTable, true);
            setupDivisionChart();
            setupComparisonChart();
            setupTeamRankingChart();
            setupUnitComparisonChart();
            setupNetworkAnalysis();
            updateDashboard(); 
            updateHospitalYearlyChart();
            updateDivisionYearlyChart();
            updateYearlyDivisionComparisonChart();
            updateTeamRankingChart();
            updateUnitComparisonChart();
            updateNetworkAnalysis();
        };
    </script>
</body>
</html>
    