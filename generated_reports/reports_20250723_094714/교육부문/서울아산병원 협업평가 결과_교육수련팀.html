
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>서울아산병원 협업 평가 결과 보고</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #343a40; font-size: 16px;}
        .container { max-width: 1400px; margin: auto; padding: 20px; }
        .header { background: linear-gradient(90deg, #4a69bd, #6a89cc); color: white; padding: 25px; text-align: center; border-radius: 0 0 10px 10px; }
        
        /* 자동 번호 매기기 CSS */
        .container { counter-reset: section-counter; }
        .section { counter-reset: subsection-counter; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .section h2::before { counter-increment: section-counter; content: counter(section-counter) ". "; color: #4a69bd; font-weight: bold; }
        .section h3::before { counter-increment: subsection-counter; content: counter(section-counter) "." counter(subsection-counter) " "; color: #6a89cc; font-weight: bold; }
        
        h1, h2, h3 { margin: 0; padding: 0; }
        h2 { color: #4a69bd; border-bottom: 3px solid #6a89cc; padding-bottom: 10px; margin-top: 20px; margin-bottom: 20px; }
        h3 { color: #555; margin-top: 30px; margin-bottom: 15px;}
        
        /* 파트 구분 스타일 */
        .part-divider { background: linear-gradient(90deg, #e9ecef, #6c757d, #e9ecef); height: 3px; margin: 40px 0; border-radius: 2px; }
        .part-title { text-align: center; color: #6c757d; font-size: 1.2em; font-weight: bold; margin: 30px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 5px solid #6a89cc; }
        
        .filters, .trend-filters { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-end; margin-bottom: 20px;}
        .filter-group { display: flex; flex-direction: column; }
        .filter-group label { margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        .filter-group select, .filter-group input { padding: 8px; border-radius: 5px; border: 1px solid #ced4da; min-width: 200px; }
        .expander-container { border: 1px solid #ced4da; border-radius: 5px; background-color: white; min-width: 200px; max-width: 280px; position: relative; }
        .expander-header { padding: 6px 8px; background-color: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 5px; user-select: none; font-size: 13px; }
        .expander-header:hover { background-color: #e9ecef; }
        .expander-arrow { transition: transform 0.3s ease; font-size: 11px; }
        .expander-arrow.expanded { transform: rotate(180deg); }
        .expander-content { padding: 4px; display: none; max-height: 200px; overflow-y: auto; position: absolute; top: 100%; left: 0; width: 100%; background-color: white; border: 1px solid #ced4da; border-top: none; border-radius: 0 0 5px 5px; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .expander-content.expanded { display: block; }
        .checkbox-item { display: flex; align-items: center; padding: 2px 0; height: auto; min-height: unset; }
        .checkbox-item input[type="checkbox"] { width: 16px; height: 16px; min-width: 16px; min-height: 16px; margin-right: 6px; box-sizing: border-box; }
        .checkbox-item:hover { background-color: #f8f9fa; }
        .checkbox-item label { cursor: pointer; font-weight: normal; font-size: 13px; line-height: 1.1; margin: 0; }
        #metrics-container { display: flex; gap: 30px; margin-top: 20px; text-align: center; justify-content: center; }
        .metric { background-color: #e9ecef; padding: 15px; border-radius: 8px; flex-grow: 1; }
        .metric-value { font-size: 2em; font-weight: bold; color: #4a69bd; }
        .metric-label { font-size: 0.9em; color: #6c757d; }
        #reviews-table-container, #keyword-reviews-table-container { max-height: 400px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #network-reviews-table-container { max-height: 300px; overflow-y: auto; margin-top: 20px; border: 1px solid #dee2e6; border-radius: 5px; }
        #reviews-table, #keyword-reviews-table, #network-reviews-table { width: 100%; border-collapse: collapse; }
        #reviews-table th, #reviews-table td, #keyword-reviews-table th, #keyword-reviews-table td, #network-reviews-table th, #network-reviews-table td { padding: 12px; border-bottom: 1px solid #dee2e6; text-align: left; }
        #reviews-table th, #keyword-reviews-table th, #network-reviews-table th { background-color: #f8f9fa; position: sticky; top: 0; }
        #reviews-table tr:last-child td, #keyword-reviews-table tr:last-child td, #network-reviews-table tr:last-child td { border-bottom: none; }
        .keyword-charts-container { display: flex; gap: 20px; }
        .keyword-chart { flex: 1; }
        
        /* 차트 컨테이너 스타일 */
        .chart-container { margin: 20px 0; }
        .subsection { margin: 30px 0; }
        
        /* 협업 빈도 차트 스크롤 컨테이너 */
        #collaboration-frequency-chart-container { max-height: 600px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 5px; }
        
    </style>
</head>
<body>
    <div class="header">
        <h1> 서울아산병원 협업 평가 결과 보고 - 교육수련팀 </h1>
        <p style="margin: 10px 0 0 0; opacity: 0.9;">설문 데이터: 2022년 ~ 2025년 상반기(2025년 7월 9일 기준) </p>
    </div>
    
    <!-- 안내 문구 섹션 -->
    <div style="max-width: 1400px; margin: 20px auto; padding: 0 20px;">
        <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            
            <div style="margin-bottom: 15px;">
                <strong style="color: #495057;">📊 평가 문항 설명:</strong>
                <ul style="margin: 8px 0 0 20px; color: #6c757d; font-size: 0.95em; line-height: 1.4;">
                    <li><strong>존중배려:</strong> ○○은 타 부서의 입장을 존중하고 배려하여 협력해주며, 협업 관련 의견을 경청해준다.</li>
                    <li><strong>정보공유:</strong> ○○은 업무상 필요한 정보에 대해 공유가 잘 이루어진다.</li>
                    <li><strong>명확처리:</strong> ○○은 업무에 대한 명확한 담당자가 있고 업무를 일관성있게 처리해준다.</li>
                    <li><strong>태도개선:</strong> ○○은 이전보다 업무 협력에 대한 태도나 의지가 개선되고 있다.</li>
                    <li><strong>전반만족:</strong> 전반적으로 ○○과의 협업에 대해 만족한다.</li>
                </ul>
            </div>
            
            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 12px;">
                <strong style="color: #856404;">⚠️ 통계적 해석 주의사항:</strong>
                <span style="color: #856404; font-size: 0.95em;">응답건수(표본수)가 30건 미만인 경우 통계적 해석에 유의하시기 바랍니다.</span>
            </div>
            
        </div>
    </div>
    
    <div class="container">
        
        
        <div class="section">
            <h2>병원 전체 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="hospital-score-header" onclick="toggleExpander('hospital-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="hospital-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="hospital-score-expander">
                            <div id="hospital-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="hospital-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>

        <div class="section">
            <h2>부문별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="comparison-year-filter">연도 선택</label>
                    <select id="comparison-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label>부문 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="comparison-division-header" onclick="toggleExpander('comparison-division-expander')">
                            <span>부문 선택 (0개 선택됨)</span>
                            <span class="expander-arrow" id="comparison-division-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="comparison-division-expander">
                            <div id="comparison-division-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="comparison-chart-container" class="chart-container"></div>
        </div>

        <div class="section">
            <h2>소속 부문 결과</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="division-chart-filter">부문 선택</label>
                    <select id="division-chart-filter"></select>
                </div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="division-score-header" onclick="toggleExpander('division-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="division-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="division-score-expander">
                            <div id="division-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="division-yearly-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>소속 부문 팀별 종합 점수</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="team-ranking-year-filter">연도 선택</label>
                    <select id="team-ranking-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="team-ranking-division-filter">부문 선택</label>
                    <select id="team-ranking-division-filter"></select>
                </div>
            </div>
            <div id="team-ranking-chart-container" class="chart-container"></div>
        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>부서/Unit 결과</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group"><label for="year-filter">연도 (전체)</label><select id="year-filter"></select></div>
                <div class="filter-group"><label for="department-filter">부서</label><select id="department-filter"></select></div>
                <div class="filter-group"><label for="unit-filter">Unit</label><select id="unit-filter"></select></div>
                <div class="filter-group">
                    <label>문항 선택</label>
                    <div class="expander-container">
                        <div class="expander-header" id="drilldown-score-header" onclick="toggleExpander('drilldown-score-expander')">
                            <span>문항 선택 (6개 선택됨)</span>
                            <span class="expander-arrow" id="drilldown-score-arrow">▼</span>
                        </div>
                        <div class="expander-content" id="drilldown-score-expander">
                            <div id="drilldown-score-filter"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 5.1 부서/Unit 결과 -->
            <div class="subsection">
                <h3>부서/Unit 결과</h3>
                <div id="metrics-container"></div>
                <div id="yearly-comparison-chart-container" class="chart-container"></div>
                
            </div>
            
            <!-- 5.2 부서 내 Unit 결과 -->
            <div class="subsection">
                <h3>부서 내 Unit 결과</h3>
                <div id="unit-comparison-chart-container" class="chart-container"></div>
            </div>
            
            <!-- 5.3 감정 분석 -->
            <div class="subsection">
                <h3>평가 부서 의견</h3>
                <div id="sentiment-chart-container" class="chart-container"></div>
                
                <!-- 협업 후기 -->
                <div style="margin-top: 30px;">
                    <h4>협업 후기 <span id="reviews-count-display" style="color: #666; font-size: 0.9em;"></span></h4>
                    <div class="filters">
                        <div class="filter-group">
                            <label>감정 분류 필터</label>
                            <div class="expander-container">
                                <div class="expander-header" id="review-sentiment-header" onclick="toggleExpander('review-sentiment-expander')">
                                    <span>감정 선택 (4개 선택됨)</span>
                                    <span class="expander-arrow" id="review-sentiment-arrow">▼</span>
                                </div>
                                <div class="expander-content" id="review-sentiment-expander">
                                    <div id="review-sentiment-filter"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="reviews-table-container"><table id="reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody></tbody></table></div>
                </div>
            </div>

        </div>

        <div class="part-divider"></div>
        
        
        <div class="section">
            <h2>다빈도 평가 부서</h2>
            
            <!-- 공통 필터 -->
            <div class="filters">
                <div class="filter-group">
                    <label for="network-year-filter">연도 (전체)</label>
                    <select id="network-year-filter"></select>
                </div>
                <div class="filter-group">
                    <label for="min-collaboration-filter">평가 횟수</label>
                    <select id="min-collaboration-filter">
                        <option value="5">5회 이상</option>
                        <option value="10" selected>10회 이상</option>
                        <option value="30">30회 이상</option>
                    </select>
                </div>
            </div>
            <!-- 부문/부서/Unit 필터는 집계 데이터 사용으로 제거 -->
            <div style="display: none;">
                <select id="network-division-filter"><option value="전체">전체</option></select>
                <select id="network-department-filter"><option value="교육수련팀">교육수련팀</option></select>
                <select id="network-unit-filter"><option value="전체">전체</option></select>
            </div>
            
            <div class="subsection">
                <div id="collaboration-frequency-chart-container" class="chart-container"></div>
            </div>


        </div>

    </div>
    <script>
        // 부서별 데이터 구조
        const hybridData = {"aggregated": {"hospital_yearly": {"2022": {"존중배려": 67.14276157345465, "정보공유": 67.33654876741693, "명확처리": 67.26182500334986, "태도개선": 66.87172246873739, "전반만족": 66.08169541382537, "종합점수": 66.9457064563561, "응답수": 7481}, "2023": {"존중배려": 69.83673131112216, "정보공유": 69.63634101841102, "명확처리": 69.98963085856491, "태도개선": 69.31004330446369, "전반만족": 68.76658374792703, "종합점수": 69.49223280861641, "응답수": 12070}, "2024": {"존중배려": 74.488649134637, "정보공유": 73.94310771306499, "명확처리": 74.12310286677909, "태도개선": 73.35440894207971, "전반만족": 73.21970975362808, "종합점수": 73.80928354856822, "응답수": 8905}, "2025": {"존중배려": 77.27624375148774, "정보공유": 76.88712942016907, "명확처리": 77.01954009293459, "태도개선": 76.21536072623029, "전반만족": 76.12433075550268, "종합점수": 76.67731985731272, "응답수": 8410}}, "division_yearly": {"교육부문": {"2022": {"존중배려": 65.77380952380952, "정보공유": 65.47619047619048, "명확처리": 68.1547619047619, "태도개선": 66.96428571428571, "전반만족": 65.47619047619048, "종합점수": 66.36904761904762, "응답수": 84}, "2023": {"존중배려": 77.64084507042253, "정보공유": 72.71126760563381, "명확처리": 75.52816901408451, "태도개선": 73.21428571428571, "전반만족": 75.17605633802818, "종합점수": 74.92957746478874, "응답수": 142}, "2024": {"존중배려": 79.7872340425532, "정보공유": 78.72340425531915, "명확처리": 79.25531914893617, "태도개선": 78.72340425531915, "전반만족": 77.3936170212766, "종합점수": 78.77659574468085, "응답수": 94}, "2025": {"존중배려": 82.17821782178218, "정보공유": 79.95049504950495, "명확처리": 82.17821782178218, "태도개선": 79.95049504950495, "전반만족": 80.44554455445545, "종합점수": 80.94059405940594, "응답수": 101}}}, "division_comparison": {"2022": {"관리부문": {"존중배려": 71.23039806996381, "정보공유": 69.5166163141994, "명확처리": 70.14767932489451, "태도개선": 69.2506067961165, "전반만족": 69.17168674698796, "종합점수": 69.85550872968092, "응답수": 1661}, "커뮤니케이션실": {"존중배려": 71.4, "정보공유": 71.2, "명확처리": 69.6, "태도개선": 68.75, "전반만족": 68.359375, "종합점수": 70.37109375, "응답수": 128}, "진료부문": {"존중배려": 65.45150501672241, "정보공유": 67.07439678284182, "명확처리": 66.05527638190955, "태도개선": 66.2134944612286, "전반만족": 65.10538641686183, "종합점수": 65.96836789297659, "응답수": 2990}, "간호부문": {"존중배려": 66.6626036079961, "정보공유": 66.58946855192589, "명확처리": 66.66259168704157, "태도개선": 66.6421568627451, "전반만족": 65.72403705509508, "종합점수": 66.46411994149196, "응답수": 2051}, "기타부문": {"존중배려": 51.94805194805195, "정보공유": 55.51948051948052, "명확처리": 56.65584415584416, "태도개선": 52.75974025974026, "전반만족": 51.298701298701296, "종합점수": 53.63636363636363, "응답수": 154}, "연구부문": {"존중배려": 71.875, "정보공유": 66.31944444444444, "명확처리": 70.13888888888889, "태도개선": 67.36111111111111, "전반만족": 68.40277777777777, "종합점수": 68.81944444444444, "응답수": 72}, "기획부문": {"존중배려": 70.14925373134328, "정보공유": 69.02985074626865, "명확처리": 73.88059701492537, "태도개선": 69.31818181818181, "전반만족": 69.02985074626865, "종합점수": 70.3731343283582, "응답수": 67}, "디지털정보혁신본부": {"존중배려": 71.14485981308411, "정보공유": 69.48356807511738, "명확처리": 71.36150234741784, "태도개선": 69.31279620853081, "전반만족": 68.83720930232558, "종합점수": 69.97674418604652, "응답수": 215}, "교육부문": {"존중배려": 65.77380952380952, "정보공유": 65.47619047619048, "명확처리": 68.1547619047619, "태도개선": 66.96428571428571, "전반만족": 65.47619047619048, "종합점수": 66.36904761904762, "응답수": 84}, "국제사업실": {"존중배려": 63.559322033898304, "정보공유": 62.28813559322034, "명확처리": 63.559322033898304, "태도개선": 62.28813559322034, "전반만족": 59.32203389830509, "종합점수": 62.20338983050848, "응답수": 59}}, "2023": {"관리부문": {"존중배려": 72.31262327416174, "정보공유": 70.63465965143045, "명확처리": 71.5412421952021, "태도개선": 71.01221928665785, "전반만족": 70.81414473684211, "종합점수": 71.25054533508542, "응답수": 3044}, "커뮤니케이션실": {"존중배려": 71.69540229885058, "정보공유": 72.42857142857143, "명확처리": 70.85714285714286, "태도개선": 69.25287356321839, "전반만족": 69.71428571428571, "종합점수": 70.72857142857143, "응답수": 175}, "진료부문": {"존중배려": 68.65744773519164, "정보공유": 69.7546346782988, "명확처리": 69.44323144104804, "태도개선": 68.85111499781372, "전반만족": 68.0525283347864, "종합점수": 68.94009799651568, "응답수": 4592}, "간호부문": {"존중배려": 69.25772539025168, "정보공유": 68.89738687061823, "명확처리": 69.48869066581715, "태도개선": 69.10166240409207, "전반만족": 68.24410452517527, "종합점수": 68.96868152866242, "응답수": 3140}, "기타부문": {"존중배려": 45.91346153846154, "정보공유": 51.08173076923077, "명확처리": 52.41545893719807, "태도개선": 47.68292682926829, "전반만족": 46.875, "종합점수": 48.71995192307692, "응답수": 208}, "연구부문": {"존중배려": 74.37106918238993, "정보공유": 71.38364779874213, "명확처리": 72.32704402515724, "태도개선": 70.80645161290323, "전반만족": 72.0125786163522, "종합점수": 72.30345911949685, "응답수": 159}, "기획부문": {"존중배려": 68.97590361445783, "정보공유": 65.8132530120482, "명확처리": 69.42771084337349, "태도개선": 67.33128834355828, "전반만족": 66.41566265060241, "종합점수": 67.53012048192771, "응답수": 166}, "디지털정보혁신본부": {"존중배려": 77.82485875706215, "정보공유": 75.42372881355932, "명확처리": 75.28248587570621, "태도개선": 74.36079545454545, "전반만족": 75.14124293785311, "종합점수": 75.61440677966101, "응답수": 354}, "교육부문": {"존중배려": 77.64084507042253, "정보공유": 72.71126760563381, "명확처리": 75.52816901408451, "태도개선": 73.21428571428571, "전반만족": 75.17605633802818, "종합점수": 74.92957746478874, "응답수": 142}, "국제사업실": {"존중배려": 68.05555555555556, "정보공유": 69.44444444444444, "명확처리": 68.88888888888889, "태도개선": 67.13483146067416, "전반만족": 66.38888888888889, "종합점수": 68.05555555555556, "응답수": 90}}, "2024": {"관리부문": {"존중배려": 76.41147244805781, "정보공유": 74.47987336047038, "명확처리": 74.93231046931407, "태도개선": 73.9867941712204, "전반만족": 74.32034435885818, "종합점수": 74.82935047361298, "응답수": 2217}, "커뮤니케이션실": {"존중배려": 75.3623188405797, "정보공유": 75.18115942028986, "명확처리": 76.81159420289855, "태도개선": 74.27007299270073, "전반만족": 74.27007299270073, "종합점수": 75.20528985507246, "응답수": 138}, "진료부문": {"존중배려": 73.48090277777777, "정보공유": 73.87811233352635, "명확처리": 73.28985507246377, "태도개선": 72.88160185722577, "전반만족": 72.57457283521576, "종합점수": 73.20710358796296, "응답수": 3456}, "간호부문": {"존중배려": 73.94793926247289, "정보공유": 73.02688638334779, "명확처리": 73.77493495229835, "태도개선": 73.23529411764706, "전반만족": 72.9419410745234, "종합점수": 73.33820701602424, "응답수": 2309}, "기타부문": {"존중배려": 58.40163934426229, "정보공유": 63.31967213114754, "명확처리": 64.13934426229508, "태도개선": 60.65573770491803, "전반만족": 59.42622950819672, "종합점수": 61.18852459016394, "응답수": 122}, "연구부문": {"존중배려": 78.19148936170212, "정보공유": 76.59574468085107, "명확처리": 77.3936170212766, "태도개선": 74.73118279569893, "전반만족": 76.0752688172043, "종합점수": 76.48936170212765, "응답수": 94}, "기획부문": {"존중배려": 74.3801652892562, "정보공유": 71.90082644628099, "명확처리": 76.44628099173553, "태도개선": 70.83333333333333, "전반만족": 71.90082644628099, "종합점수": 73.14049586776859, "응답수": 121}, "디지털정보혁신본부": {"존중배려": 80.32646048109966, "정보공유": 80.58419243986255, "명확처리": 80.41237113402062, "태도개선": 79.89690721649484, "전반만족": 79.63917525773196, "종합점수": 80.17182130584193, "응답수": 291}, "교육부문": {"존중배려": 79.7872340425532, "정보공유": 78.72340425531915, "명확처리": 79.25531914893617, "태도개선": 78.72340425531915, "전반만족": 77.3936170212766, "종합점수": 78.77659574468085, "응답수": 94}, "국제사업실": {"존중배려": 71.03174603174604, "정보공유": 72.22222222222223, "명확처리": 71.42857142857143, "태도개선": 68.65079365079364, "전반만족": 67.06349206349206, "종합점수": 70.07936507936508, "응답수": 63}}, "2025": {"관리부문": {"존중배려": 79.58694659972615, "정보공유": 78.07498856881573, "명확처리": 78.49474645957058, "태도개선": 77.80192131747484, "전반만족": 77.92104062072113, "종합점수": 78.33732664233575, "응답수": 2192}, "커뮤니케이션실": {"존중배려": 79.52380952380952, "정보공유": 78.06603773584905, "명확처리": 78.73831775700934, "태도개선": 77.35849056603773, "전반만족": 76.6355140186916, "종합점수": 77.71420560747664, "응답수": 107}, "진료부문": {"존중배려": 76.21971736204576, "정보공유": 76.94378996970717, "명확처리": 76.2041091276524, "태도개선": 75.70219966159053, "전반만족": 75.49646583641871, "종합점수": 76.11265388496467, "응답수": 2973}, "간호부문": {"존중배려": 76.66596814752724, "정보공유": 76.21491411813993, "명확처리": 76.83900798654896, "태도개선": 75.89360807401178, "전반만족": 75.76487845766974, "종합점수": 76.25802763819095, "응답수": 2388}, "기타부문": {"존중배려": 57.7319587628866, "정보공유": 60.45918367346939, "명확처리": 61.98979591836735, "태도개선": 58.41836734693877, "전반만족": 57.90816326530612, "종합점수": 59.2219387755102, "응답수": 98}, "연구부문": {"존중배려": 80.3125, "정보공유": 78.4375, "명확처리": 80.3125, "태도개선": 76.26582278481013, "전반만족": 78.4375, "종합점수": 78.6875, "응답수": 80}, "기획부문": {"존중배려": 75.26315789473684, "정보공유": 75.52631578947368, "명확처리": 75.52631578947368, "태도개선": 74.21875, "전반만족": 72.65625, "종합점수": 74.32291666666667, "응답수": 96}, "디지털정보혁신본부": {"존중배려": 79.75409836065573, "정보공유": 77.71381578947368, "명확처리": 78.60655737704919, "태도개선": 77.88778877887789, "전반만족": 77.95081967213115, "종합점수": 78.3264918032787, "응답수": 305}, "교육부문": {"존중배려": 82.17821782178218, "정보공유": 79.95049504950495, "명확처리": 82.17821782178218, "태도개선": 79.95049504950495, "전반만족": 80.44554455445545, "종합점수": 80.94059405940594, "응답수": 101}, "국제사업실": {"존중배려": 75.71428571428571, "정보공유": 73.57142857142857, "명확처리": 73.92857142857143, "태도개선": 72.5, "전반만족": 71.42857142857143, "종합점수": 73.42857142857143, "응답수": 70}}}, "team_ranking": {"2022": [{"department": "시뮬레이션센터", "score": 76.7, "count": 12, "rank": 1}, {"department": "아카데미운영팀", "score": 73.1, "count": 43, "rank": 2}, {"department": "교육수련팀", "score": 52.1, "count": 29, "rank": 3}], "2023": [{"department": "시뮬레이션센터", "score": 88.7, "count": 19, "rank": 1}, {"department": "아카데미운영팀", "score": 81.6, "count": 68, "rank": 2}, {"department": "교육수련팀", "score": 61.9, "count": 55, "rank": 3}], "2024": [{"department": "시뮬레이션센터", "score": 87.7, "count": 15, "rank": 1}, {"department": "아카데미운영팀", "score": 80.9, "count": 58, "rank": 2}, {"department": "교육수련팀", "score": 66.4, "count": 21, "rank": 3}], "2025": [{"department": "시뮬레이션센터", "score": 93.3, "count": 24, "rank": 1}, {"department": "아카데미운영팀", "score": 84.3, "count": 54, "rank": 2}, {"department": "교육수련팀", "score": 60.2, "count": 23, "rank": 3}]}, "network_analysis": {"2022": {"collaboration_counts": {"감염관리팀 → 교육수련팀": 3, "재무회계팀 → 교육수련팀": 1, "인사팀 → 교육수련팀": 1, "어린이병원간호팀 → 교육수련팀": 8, "암병원간호1팀 → 교육수련팀": 2, "기획팀 → 교육수련팀": 1, "운영지원팀 → 교육수련팀": 1, "시뮬레이션센터 → 교육수련팀": 2, "디자인ㆍ콘텐츠팀 → 교육수련팀": 2, "내과간호1팀 → 교육수련팀": 1, "적정진료팀 → 교육수련팀": 1, "진료지원팀 → 교육수련팀": 1, "외래간호팀 → 교육수련팀": 1, "내과간호2팀 → 교육수련팀": 1, "외과간호1팀 → 교육수련팀": 2, "건진운영팀 → 교육수련팀": 1}, "total_evaluators": 16, "total_responses": 29}, "2023": {"collaboration_counts": {"아카데미운영팀 → 교육수련팀": 3, "적정진료팀 → 교육수련팀": 1, "암병원간호1팀 → 교육수련팀": 1, "내과간호1팀 → 교육수련팀": 3, "외과간호2팀 → 교육수련팀": 1, "어린이병원간호팀 → 교육수련팀": 8, "연구기획팀 → 교육수련팀": 1, "건진운영팀 → 교육수련팀": 1, "IT서비스팀 → 교육수련팀": 1, "특수검사팀 → 교육수련팀": 1, "임상연구보호센터 → 교육수련팀": 1, "국제교류팀 → 교육수련팀": 4, "PI팀 → 교육수련팀": 2, "내과간호2팀 → 교육수련팀": 2, "암병원간호2팀 → 교육수련팀": 1, "인사팀 → 교육수련팀": 2, "AGS팀 → 교육수련팀": 4, "운영지원팀 → 교육수련팀": 2, "시뮬레이션센터 → 교육수련팀": 2, "디자인ㆍ콘텐츠팀 → 교육수련팀": 1, "재무회계팀 → 교육수련팀": 3, "심장병원간호팀 → 교육수련팀": 2, "수술간호팀 → 교육수련팀": 2, "IT전략팀 → 교육수련팀": 2, "기획팀 → 교육수련팀": 1, "간호교육행정팀 → 교육수련팀": 1, "보안관리팀 → 교육수련팀": 1, "총무팀 → 교육수련팀": 1}, "total_evaluators": 28, "total_responses": 55}, "2024": {"collaboration_counts": {"기획팀 → 교육수련팀": 2, "연구기획팀 → 교육수련팀": 2, "총무팀 → 교육수련팀": 1, "보안관리팀 → 교육수련팀": 1, "시뮬레이션센터 → 교육수련팀": 2, "간호교육행정팀 → 교육수련팀": 1, "경영분석팀 → 교육수련팀": 1, "아카데미운영팀 → 교육수련팀": 4, "재무회계팀 → 교육수련팀": 1, "적정진료팀 → 교육수련팀": 1, "AGS팀 → 교육수련팀": 1, "인사팀 → 교육수련팀": 2, "디자인ㆍ콘텐츠팀 → 교육수련팀": 1, "외과간호1팀 → 교육수련팀": 1}, "total_evaluators": 14, "total_responses": 21}, "2025": {"collaboration_counts": {"외래간호팀 → 교육수련팀": 1, "간호교육행정팀 → 교육수련팀": 3, "시뮬레이션센터 → 교육수련팀": 4, "운영지원팀 → 교육수련팀": 1, "기획팀 → 교육수련팀": 2, "디자인ㆍ콘텐츠팀 → 교육수련팀": 1, "연구지원팀 → 교육수련팀": 1, "인사팀 → 교육수련팀": 1, "보안관리팀 → 교육수련팀": 1, "AGS팀 → 교육수련팀": 3, "원무팀 → 교육수련팀": 2, "IT서비스팀 → 교육수련팀": 1, "적정진료팀 → 교육수련팀": 1, "재무회계팀 → 교육수련팀": 1}, "total_evaluators": 14, "total_responses": 23}}, "metadata": {"calculation_date": "2025-07-23T09:47:25.472898", "total_responses": 36866, "target_department": "교육수련팀", "target_division": "교육부문", "security_level": "AGGREGATED_ONLY"}}, "rawData": [{"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "실무 담당자 선생님들이 예전에 비해 적극적으로 업무해주시는 것 같습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["실무 담당자", "적극적", "업무", "감사"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "튜브 삽입 후 고정 시 담당 간호사를 호출하여 함께 고정해주십시오. 고정이 잘되지 않을 경우 자주 빠집니다. 인턴 선생님 호출 시 수술 중이어서 올 수 없는 상황이라면, 다른 인턴 선생님을 배정해주십시오.", "감정_분류": "부정", "핵심_키워드": ["튜브 고정", "간호사 협업", "인턴 배정", "업무 효율", "의료 절차"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 30.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 65.0, "정제된_텍스트": "모든 분들이 친절하시고 일도 열심히 해주시지만, 가끔 일부 인턴 선생님들께서 존중하지 않는다고 느껴질 때가 있습니다. 바쁘신 것은 이해하지만, 서로 존중하며 일했으면 좋겠습니다.", "감정_분류": "부정", "핵심_키워드": ["존중", "소통", "인턴", "협업"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "정규 인턴 선생님과 백업 인턴 선생님 모두 수술실 대기(keep)로 인해 업무 지연이 종종 발생합니다.", "감정_분류": "부정", "핵심_키워드": ["인턴", "수술실", "업무 지연", "대기"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 5.0, "정제된_텍스트": "담당자가 업무에 소극적인 태도를 보이는 것 같습니다.", "감정_분류": "부정", "핵심_키워드": ["담당자", "업무", "태도"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "의사소통이 원활하지 않거나 명확성이 부족합니다.", "감정_분류": "부정", "핵심_키워드": ["의사소통", "원활성", "명확성"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "전공의 인수인계 전날까지 스케줄 공유가 원활하지 않거나, 주말 오프 및 백업 시스템 운영에 개선이 필요한 경우가 많습니다.", "감정_분류": "부정", "핵심_키워드": ["전공의 스케줄", "스케줄 공유", "시스템 문제", "인수인계", "백업"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "문의 시 회신을 빠르고 정확하게 잘 해주시고, 협조 요청에 잘 응해주셨습니다.", "감정_분류": "긍정", "핵심_키워드": ["회신", "정확성", "협조", "응대"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 5.0, "정제된_텍스트": "업무 분담에 대한 불만이 있습니다.", "감정_분류": "부정", "핵심_키워드": ["업무", "분담", "불만"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "교육장 사용 문의 시 적극적으로 도움을 주고자 챙겨주고 확인해주셔서 진심으로 감사합니다. 교육장 신청서를 올리지 못한 실수에도 해당 장소를 사용할 수 있도록 도움을 주셔서 업무 수행에 감동받았습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["교육장", "도움", "업무수행", "감사", "감동"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 55.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 0.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "학술행사 부스 설치를 위해 전시실 책걸상을 직접 옮겨야 했던 점이 매우 부담스러웠습니다. 같은 병원 내에서 협조가 이루어지지 않고, 사전에 관련 업무에 대한 공지가 없어 도움 인력을 요청할 기회도 없었습니다. 행사 며칠 전에야 알게 되어 혼자 감당하기 어려웠고, 다른 동료에게 간신히 도움을 요청해야 했습니다. 이로 인해 행사를 진행하는 것보다 물리적 업무가 더 힘들고 기억에 남을 정도로 부담이 컸습니다.", "감정_분류": "부정", "핵심_키워드": ["행사 준비", "업무 부담", "소통 부족", "물리적 지원"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "대체로 좋으나, 일부 의료진의 협업 태도가 아쉽습니다. 특히 병동 간호사들이 환자와 담당의 사이에서 어려움을 겪습니다. 또한, 감염 관리에 대한 부족한 인식이 감염 취약 병동에 부담을 주고 있습니다. 어려움은 이해하나, 백업 당직 시간에 전화 응대가 필요합니다. 감사합니다.", "감정_분류": "부정", "핵심_키워드": ["협업", "감염관리", "업무 효율", "간호사 부담", "소통"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "진정 검사 시 모니터링을 담당할 인턴이 부족하여 업무 인력 충원이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["진정 검사", "인력 부족", "업무 효율", "모니터링"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "1) 인턴 선생님들께서는 중심정맥관 환아에게 항암 치료 시 '일회용 알코올 솜으로 6회 이상 문지르는' 소독 절차를 준수해 주십시오. 2) 인턴 선생님들께서 해야 할 업무를 요청했을 때, 불쾌감을 표현하거나 무례하게 응대하지 말아 주십시오. 예를 들어, 'EKG 촬영을 요청했을 때, 왜 찍냐고 되묻거나 대답 없이 전화를 끊는' 등의 행동은 지양해 주시고, 최소한의 예의를 지켜주시기 바랍니다. 3) 손 위생 누락 사례가 많습니다. 4) 격리 환자 진료 시 보호 장구(장갑, 가운 등)를 반드시 착용해 주십시오.", "감정_분류": "부정", "핵심_키워드": ["의료 절차", "환자 안전", "소통 방식", "업무 협력", "전문성"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "인턴 업무에 대한 명확한 규정과 재교육이 필요합니다. (예: 소아 객담 검사, 야간 코로나 검사)", "감정_분류": "부정", "핵심_키워드": ["인턴 업무", "규정", "재교육", "업무 개선"]}, {"설문시행연도": "2022", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 60.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 5.0, "정제된_텍스트": "매순간 만족스럽지 않습니다.", "감정_분류": "부정", "핵심_키워드": ["불만족", "지속적", "개선"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "의사 근태관리를 위해 전산화가 필요해 보입니다.", "감정_분류": "부정", "핵심_키워드": ["의사", "근태관리", "전산화"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 90.0, "정제된_텍스트": "인턴 선생님들이 업무를 매우 잘 수행해주셔서 업무 진행에 수월함이 있었습니다.", "감정_분류": "긍정", "핵심_키워드": ["인턴", "업무 수행", "업무 효율", "협업"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 0.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "정규 인턴 선생님들과의 소통은 원활하지만, 당직 선생님과의 소통 시 급한 상황임에도 불구하고 본당직(on-call) 및 백업(back-up) 인력에게 연락이 닿지 않아 3순위 담당자에게까지 연락이 이어지는 경우가 많습니다. 전화 연락 제도로 전환되었다면 그에 맞춰 소통을 신속히 하고 책임감을 가지고 임해야 한다고 생각합니다.", "감정_분류": "부정", "핵심_키워드": ["소통", "당직", "연락", "책임감", "업무 효율"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 0.0, "정보공유": 0.0, "명확처리": 0.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 0.0, "정제된_텍스트": "인턴의 처치 수행 능력이 부족하고, 감염 관리(손 위생 및 멸균 장갑 착용)가 미흡합니다. 드레싱 처치 후 환자와 보호자들의 재처치 요구가 잦습니다. 서울아산병원 교육수련실은 인턴 교육 수준을 재고할 필요가 있습니다.", "감정_분류": "부정", "핵심_키워드": ["인턴 역량", "감염 관리", "환자 만족도", "교육 개선"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "각 부서 주의사항 인계 방식에 대해 인턴 선생님들 간의 반복적인 문제 행동이 발생하고 있어 우려됩니다. 기본적인 태도 및 무균술 교육 강화를 요청합니다.", "감정_분류": "부정", "핵심_키워드": ["인턴", "업무 인계", "태도", "무균술", "교육"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "필요한 검사 일정이 겹칠 때 부정적인 어투와 한숨으로 전화를 끊는 경우가 있었습니다.", "감정_분류": "부정", "핵심_키워드": ["검사 일정", "부정적 어투", "전화 응대", "소통"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "행사 진행에 많은 도움 주셔서 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["행사", "도움", "감사"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "소아 진정 치료 모니터링 시 호흡수 누락으로 수가 처방 삭제가 빈번합니다. 진정 모니터링에 필요한 항목이 누락되지 않도록 개선이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["소아진정치료", "호흡수 누락", "수가 처방 삭제", "모니터링", "개선"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "매우 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족", "긍정", "협력"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 50.0, "정제된_텍스트": "교육장 내 음식물 반입 금지 규정에 대해 수정 가능성 및 합당한 이유를 알고 싶습니다.", "감정_분류": "부정", "핵심_키워드": ["교육장", "음식물 반입", "규정", "수정", "이유"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "특정 분과 업무에 어려움이 있습니다. 그 외 대부분의 부서원들은 업무 협의에 있어서 원활합니다.", "감정_분류": "중립", "핵심_키워드": ["업무 효율", "협의", "어려움", "원활함"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "지속적으로 발생하는 문제입니다. 특히 막달이 가까워질수록 호출에 대한 응대가 지연되는 경우가 많습니다. 또한, 사용한 물품을 본인들이 정리하지 않고 치료실에 방치하여 책임감 없는 근무 태도를 보입니다.", "감정_분류": "부정", "핵심_키워드": ["호출 응대", "물품 정리", "책임감", "근무 태도"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "인턴 선생님들의 기본적인 업무 수행 능력과 술기가 미흡하며, 경험 부족으로 인한 어려움을 겪는 경우가 많아 인턴 교육 프로그램의 강화가 필요하다고 생각됩니다. 또한, 격리 환자 접촉 시 적절한 보호구 착용이 이루어지지 않는 경우가 잦습니다. 이는 병동 내 손위생 및 보호구 착용 노력에도 불구하고, 여러 병동을 이동하는 인턴 선생님들의 감염 관리 미흡으로 인해 격리의 의미가 퇴색될 수 있다는 우려를 낳습니다.", "감정_분류": "부정", "핵심_키워드": ["인턴 교육", "업무 술기", "보호구 착용", "감염 관리", "환자 안전"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "인턴 선생님들이 진료과 요청에 따라 간단한 처방 변경 업무를 처리할 때 방법을 잘 모르는 경우가 많습니다. 업무 전 교육 또는 진료과와의 협의를 통해 인턴 선생님들이 업무를 원활히 수행할 수 있는 지원 체계를 마련해야 합니다. 간호사는 처방권이 없어 입력 방법을 알지 못하므로, 인턴 선생님들의 문의에 답변하기 어렵고 난감합니다. 또한, 인턴 선생님들이 처음 접하거나 모르는 업무를 보조할 수 있는 시스템 마련이 시급하며, 이들을 교육하고 감독할 간호 인력의 시간적 여유가 부족합니다.", "감정_분류": "부정", "핵심_키워드": ["인턴 교육", "업무 시스템", "처방 변경", "간호 인력 부족", "업무 효율"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "정확한 업무 범위를 잘 모르겠습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 범위", "불명확", "이해 부족"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "처방의의 EKG 처방을 인턴이 EKG(심전도실)로 변경하겠다고 유선 연락을 받았습니다. 이는 인턴 선생님의 업무 태도에 대한 단적인 예시이며, 특정 개인의 문제라기보다는 최근 인턴 선생님들의 전반적인 업무 태도와 관련된 것으로 보입니다.", "감정_분류": "부정", "핵심_키워드": ["인턴", "업무 태도", "처방 변경", "의료 지시", "소통"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "수정사항이 있어도 잘 반영하여 진행해주셨습니다.", "감정_분류": "긍정", "핵심_키워드": ["수정사항", "반영", "진행"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 100.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 20.0, "정제된_텍스트": "교육수련팀과의 업무 시 '담당이 아니다', '해당 업무를 할 수 없다', '해당 업무는 어렵다'와 같은 답변을 주로 듣게 됩니다. 공동의 목표를 가진 직원으로서 적극적인 협력을 기대합니다. 또한, 교육장소 문의 시 당황스럽거나 불편하게 느껴지지 않도록 좀 더 친절한 소통을 부탁드립니다.", "감정_분류": "부정", "핵심_키워드": ["교육수련팀", "협력", "소통", "업무처리", "불편"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "내부, 외부 의료진들의 LED 스크린 신규 도입(하드웨어)에 대한 만족도가 높으며, LED 스크린 운영 인력의 높은 숙련도와 매끄러운 진행이 돋보였습니다.", "감정_분류": "긍정", "핵심_키워드": ["LED 스크린", "만족도", "운영 인력", "숙련도", "매끄러운 진행"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "인턴 선생님의 업무 역량 문제로 현장에서 어려움이 많고 환자들의 불만 제기 및 진료의 질 저하가 발생하고 있습니다. 진료과에서 피드백을 시행함에도 불구하고 개선되지 않는 상황에서, 교육수련팀이 주도적으로 인력 관리에 적극적인 모습을 보여주시기를 바랍니다.", "감정_분류": "부정", "핵심_키워드": ["인턴 역량", "환자 불만", "진료 질", "인력 관리", "개선"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "협업하여 업무를 진행할 때 협조적인 태도가 부족했습니다.", "감정_분류": "부정", "핵심_키워드": ["협업", "업무", "협조"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "회복실 업무 중 진료과 인턴 선생님들과의 협업이 매우 중요합니다. 특히 올해는 인턴 선생님들이 수술 후 환자의 동맥관 제거 업무를 도맡아 해주시는 경우가 많습니다. 연락을 드리면 친절하고 신속하게 처리하러 와주시고, 본인 과의 업무가 아닌 타과 환자들도 나서서 처리해주셔서 감사합니다. 어려운 상황에서도 웃으면서 협업해주셔서 함께 일할 때 기분이 매우 좋습니다.", "감정_분류": "긍정", "핵심_키워드": ["협업", "인턴", "친절", "신속", "업무_처리"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "처방 관련 문의는 간호사보다 동료 의사에게 하는 것이 바람직합니다. 또한, 미숙한 업무에 대비한 백업 시스템 개선이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["처방", "문의", "백업 시스템", "업무 개선", "역할"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "당직 시간에 처방 변경과 관련하여 간호사에게 문의하는 경우가 있는데, 처방에 대한 교육을 강화해 주십시오. 석션 등 처치 행위를 처음 하는 경우, 백업 시스템이나 교육을 강화해 주십시오.", "감정_분류": "부정", "핵심_키워드": ["교육 강화", "처방 관리", "처치 능력", "백업 시스템"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["감사", "지속", "협력"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 0.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "요청 사항에 대한 회신 기한이 지켜지지 않고 있습니다. 협조 요청 시 협업적이지 않고 명령조로 느껴지는 업무 전달 방식이 있습니다. 업무 처리가 명확하지 않아 여러 차례 확인이 필요하며, 불명확한 안내 공지로 인해 담당 부서가 아닌 유관 부서에서 업무를 처리해야 하는 경우가 발생하고 있습니다.", "감정_분류": "부정", "핵심_키워드": ["회신 지연", "소통 방식", "업무 비효율", "불명확한 안내", "부서 간 혼선"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "담당자가 변경되어 이전 협의 내용을 알지 못하는 점이 아쉬웠습니다.", "감정_분류": "부정", "핵심_키워드": ["담당자 변경", "협의 내용", "정보 부족", "인수인계"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "전체적으로 만족합니다.", "감정_분류": "긍정", "핵심_키워드": ["만족", "전반적"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "근무 교대 시점에 일부 동료들이 매우 비협조적이거나 무례한 태도를 보였습니다. 본인의 업무 시간임에도 불구하고 업무를 다음 근무자에게 넘기거나, 불필요한 연락이라며 상황에 대한 불만을 강하게 표현하는 등 책임 전가적인 모습을 보였습니다.", "감정_분류": "부정", "핵심_키워드": ["비협조적인 태도", "업무 책임", "소통 문제"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "인턴 업무와 관련된 소통이 어렵고 복잡하며, 정확한 업무 범위가 명확하지 않은 것 같습니다.", "감정_분류": "부정", "핵심_키워드": ["인턴 업무", "소통", "업무 범위", "복잡성"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "응대 서비스가 만족스럽지 못했습니다.", "감정_분류": "부정", "핵심_키워드": ["응대", "만족도", "미흡"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "기한 내 처리 불가 시 사전 정보 공유를 잘 해줍니다.", "감정_분류": "긍정", "핵심_키워드": ["기한", "사전 정보 공유", "소통", "업무 처리"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "항상 신속하고 정확한 협조 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["신속", "정확", "협조", "감사"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 60.0, "정제된_텍스트": "과업별 역할분담을 명확히 할 필요가 있으며, 문제 해결 의지가 강합니다.", "감정_분류": "중립", "핵심_키워드": ["역할분담", "명확화", "문제해결", "의지"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 0.0, "전반만족": 25.0, "종합점수": 15.0, "정제된_텍스트": "인턴 선생님들이 업무 요청 시 경험 부족으로 인한 업무 지연이 발생하고 있습니다. 특히, 허브 소독 규정(일회용 알코올 솜으로 6회 이상 문지르기)과 멸균 드레싱 절차가 제대로 지켜지지 않고 있어 이에 대한 교육 강화가 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 지연", "규정 미준수", "멸균 드레싱", "교육 강화"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 25.0, "정제된_텍스트": "부서 간 협의가 필요한 부분을 독단적으로 결정했습니다.", "감정_분류": "부정", "핵심_키워드": ["부서 협의", "독단적 결정", "의사결정"]}, {"설문시행연도": "2023", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "친절한 안내, 빠른 일처리", "감정_분류": "긍정", "핵심_키워드": ["친절", "안내", "일처리", "신속"]}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 0.0, "태도개선": 25.0, "전반만족": 0.0, "종합점수": 15.0, "정제된_텍스트": "의사결정 지연으로 업무 진행에 어려움이 있으며, 공지사항 공유 부족으로 재확인 및 업무 처리 혼란이 발생합니다. 주말 및 공휴일 업무 연락도 있으며, 정보 공유가 원활하지 않고 업무 회신이 늦으며, 정리되지 않은 자료 제공으로 협력 부서의 재확인이 필요합니다.", "감정_분류": "부정", "핵심_키워드": ["의사결정 지연", "정보 공유", "업무 효율", "소통 부족", "자료 관리"]}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 75.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 50.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "바쁘신 와중에 빠르고 정확하게 기자재를 점검해주셔서 큰 도움 받았습니다. 감사합니다.", "감정_분류": "긍정", "핵심_키워드": ["기자재", "점검", "신속", "정확성", "도움"]}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 50.0, "명확처리": 0.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 85.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 65.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 45.0, "정제된_텍스트": "조금 더 친절한 태도로 응대해주시면 감사하겠습니다.", "감정_분류": "부정", "핵심_키워드": ["친절", "태도", "응대"]}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "콘텐츠 제작에 필요한 지원을 아낌없이 해주셔서 큰 도움을 받았습니다.", "감정_분류": "긍정", "핵심_키워드": ["콘텐츠 제작", "지원", "도움"]}, {"설문시행연도": "2024", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 80.0, "정제된_텍스트": "각 업무 시 실질적인 면에 도움이 됩니다.", "감정_분류": "긍정", "핵심_키워드": ["업무", "도움", "실질적"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 50.0, "종합점수": 40.0, "정제된_텍스트": "정보 공유 및 협업", "감정_분류": "중립", "핵심_키워드": ["정보 공유", "협업"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 30.0, "정제된_텍스트": "회의 시 논의된 사안에 대한 진행이 불명확합니다.", "감정_분류": "부정", "핵심_키워드": ["회의", "논의", "불명확", "진행"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "정보 공유가 원활하지 않고 업무 처리가 지연됩니다. 다른 부서의 업무 상황을 고려하지 않은 일방적인 결정과 통보, 협의 없는 진행이 있습니다. 업무 처리의 일관성이 부족하며 상황에 따라 변경되는 점이 아쉽습니다.", "감정_분류": "부정", "핵심_키워드": ["정보 공유", "업무 처리", "협의 부족", "일관성"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "의사직 교육지원을 담당하는 업무인 만큼, 진료 관련 업무에 대한 이해를 높이려는 노력을 부탁드립니다.", "감정_분류": "부정", "핵심_키워드": ["교육지원", "진료업무", "이해증진", "전문성"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "문의에 늘 진심으로 답변해 주십니다.", "감정_분류": "긍정", "핵심_키워드": ["문의", "진심", "답변"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 75.0, "종합점수": 70.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 75.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 75.0, "명확처리": 75.0, "태도개선": 75.0, "전반만족": 75.0, "종합점수": 75.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 25.0, "정보공유": 0.0, "명확처리": 50.0, "태도개선": 0.0, "전반만족": 0.0, "종합점수": 15.0, "정제된_텍스트": "바쁘다는 이유로 업무가 지연되거나 개선이 이루어지지 않고 있습니다.", "감정_분류": "부정", "핵심_키워드": ["업무 지연", "개선", "비효율"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 75.0, "전반만족": 25.0, "종합점수": 40.0, "정제된_텍스트": "의사직 교육 체계 성립의 주체는 교육 수련팀이 되어야 한다고 생각합니다. 교육 환경을 개선하기 위해 교육 요구 항목들이나 진료과 공통 필수 교육에 대한 체계를 구축하고, 그 교육 중 교육 부서에서 시행해야 하는 교육에 대한 제안을 해 주는 주체가 되어야 할 것 같습니다. 현재는 그 방식이 반대로 되고 있는 것은 아닌지 고민해 주셨으면 좋겠습니다. 간호부의 경우 간호교육행정팀이 주체가 되어 간호사들의 연차별 교육 체계를 가지고 있고, 교육 부서에서 시행해 주길 원하는 교육을 의뢰해오는 방식으로 하고 있습니다. 참고 부탁드립니다.", "감정_분류": "중립", "핵심_키워드": ["교육 체계", "교육 수련팀", "교육 환경 개선", "필수 교육", "간호부 사례"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 25.0, "정보공유": 0.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 20.0, "정제된_텍스트": "업무 개선 요청 시 필요성 인지가 미흡합니다.", "감정_분류": "부정", "핵심_키워드": ["업무 개선", "필요성", "인지"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 50.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 50.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "항상 친절히 응대해 주셔서 감사합니다. 항상 그리하셨듯이 자료 공유 잘 부탁드립니다.", "감정_분류": "긍정", "핵심_키워드": ["친절", "응대", "자료 공유", "감사"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 75.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 95.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 100.0, "정보공유": 100.0, "명확처리": 100.0, "태도개선": 100.0, "전반만족": 100.0, "종합점수": 100.0, "정제된_텍스트": "업무 요청 시 적극적으로 응대해 주시며, 보다 나은 방안을 먼저 제안해주셔서 감사드립니다.", "감정_분류": "긍정", "핵심_키워드": ["업무", "응대", "제안", "감사"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 75.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 55.0, "정제된_텍스트": "부서의 특성을 충분히 이해하지만, 변화에 더 적극적인 태도를 보여주기를 바랍니다.", "감정_분류": "부정", "핵심_키워드": ["부서", "변화", "적극적", "태도"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "N/A", "존중배려": 50.0, "정보공유": 50.0, "명확처리": 25.0, "태도개선": 25.0, "전반만족": 25.0, "종합점수": 35.0, "정제된_텍스트": "의정갈등 속에서 가장 어려운 부서라고 생각합니다. 다만, 1년이라는 시간이 지났으니 이제는 체계를 다시 정비해 나갈 필요가 있다고 봅니다.", "감정_분류": "부정", "핵심_키워드": ["의정갈등", "부서", "체계", "정비", "개선"]}, {"설문시행연도": "2025", "피평가부문": "교육부문", "피평가부서": "교육수련팀", "피평가Unit": "교육지원 Unit", "존중배려": 50.0, "정보공유": 25.0, "명확처리": 50.0, "태도개선": 50.0, "전반만족": 50.0, "종합점수": 45.0, "정제된_텍스트": "N/A", "감정_분류": null, "핵심_키워드": []}], "security": {"target_department": "교육수련팀", "target_division": "교육부문", "data_scope": "교육수련팀 관련 데이터만 포함", "security_level": "HIGH", "aggregated_sections": ["전체 연도별", "부문별 연도별", "부문 비교", "팀 순위"], "filtered_sections": ["부서 상세분석", "네트워크 분석"]}};
        const rawData = hybridData.rawData;  // 필터링된 부서 데이터만 포함
        const aggregatedData = hybridData.aggregated;  // 미리 계산된 집계 데이터
        const securityInfo = hybridData.security;
        
        const scoreCols = ['존중배려', '정보공유', '명확처리', '태도개선', '전반만족', '종합점수'];
        const allYears = [...new Set(rawData.map(item => item['설문시행연도']))].sort();
        // 부문 비교용: 집계 데이터에서 모든 부문 가져오기
        const allDivisions = Object.keys(aggregatedData.division_comparison).length > 0 
            ? [...new Set(Object.values(aggregatedData.division_comparison).flatMap(yearData => Object.keys(yearData)))].sort((a, b) => a.localeCompare(b, 'ko'))
            : ["교육부문"];
        const layoutFont = { size: 14 };
        
        // 보안 정보 콘솔 출력
        console.log('🔒 보안 정보:', securityInfo);
        console.log('📊 데이터 범위:', securityInfo.data_scope);

        const departmentUnitMap = rawData.reduce((acc, item) => {
            const dept = item['피평가부서'];
            const unit = item['피평가Unit'];
            if (dept && dept !== 'N/A' && unit && unit !== 'N/A') {
                if (!acc[dept]) { acc[dept] = new Set(); }
                acc[dept].add(unit);
            }
            return acc;
        }, {});
        for (const dept in departmentUnitMap) {
            departmentUnitMap[dept] = [...departmentUnitMap[dept]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function populateFilters() {
            // 연도 필터 설정
            const yearSelect = document.getElementById('year-filter');
            const years = [...new Set(rawData.map(item => item['설문시행연도']))].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
            yearSelect.innerHTML = ['전체', ...years].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.addEventListener('change', updateDashboard);
            
            // 부서 필터를 교육수련팀으로 고정
            const deptSelect = document.getElementById('department-filter');
            deptSelect.innerHTML = `<option value="교육수련팀">교육수련팀</option>`;
            deptSelect.value = "교육수련팀";
            deptSelect.addEventListener('change', updateUnitFilter);
            
            // Unit 필터 초기화
            updateUnitFilter();
        }

        function updateUnitFilter() {
            const deptSelect = document.getElementById('department-filter');
            const unitSelect = document.getElementById('unit-filter');
            const selectedDept = deptSelect.value;

            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];

            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            // Unit 필터 변경 시 차트 실시간 업데이트
            unitSelect.addEventListener('change', updateDashboard);
        }

        function setupDivisionChart() {
            const select = document.getElementById('division-chart-filter');
            // 고정값: 교육부문만 선택 가능
            select.innerHTML = `<option value="교육부문">교육부문</option>`;
            select.value = "교육부문";
            select.addEventListener('change', updateDivisionYearlyChart);
            createCheckboxFilter('division-score-filter', scoreCols, 'division-score', updateDivisionYearlyChart);
            // 초기 차트 표시
            updateDivisionYearlyChart();
        }
        
        function setupComparisonChart() {
            const yearSelect = document.getElementById('comparison-year-filter');
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1]; // Default to last year
            yearSelect.addEventListener('change', updateYearlyDivisionComparisonChart);
            createCheckboxFilter('comparison-division-filter', allDivisions, 'comparison-division', updateYearlyDivisionComparisonChart, true);
        }

        function getFilteredData() {
            let filteredData = [...rawData];
            const filters = { 'year-filter': '설문시행연도', 'department-filter': '피평가부서', 'unit-filter': '피평가Unit' };
            for (const [elementId, dataCol] of Object.entries(filters)) {
                const selectedValue = document.getElementById(elementId).value;
                if (selectedValue !== '전체') { filteredData = filteredData.filter(item => item[dataCol] == selectedValue); }
            }
            return filteredData;
        }

        function updateDashboard() {
            const filteredData = getFilteredData();
            updateMetrics(filteredData);
            updateDrilldownChart(filteredData);
            updateSentimentChart(filteredData);
            updateReviewsTable(filteredData);
            updateKeywordAnalysis(filteredData);
            updateYearlyComparisonChart();
            updateUnitComparisonChart();
        }
        
        function calculateAverages(data) {
            const averages = {};
            scoreCols.forEach(col => {
                const total = data.reduce((sum, item) => sum + (item[col] || 0), 0);
                averages[col] = data.length > 0 ? (total / data.length) : 0;
            });
            return averages;
        }

        function updateMetrics(data) {
            const container = document.getElementById('metrics-container');
            if (data.length === 0) { container.innerHTML = "<p style='text-align:center;'>선택된 조건에 해당하는 데이터가 없습니다.</p>"; return; }
            const averages = calculateAverages(data);
            container.innerHTML = `<div class="metric"><div class="metric-value">${data.length}</div><div class="metric-label">응답 수</div></div><div class="metric"><div class="metric-value">${averages['종합점수'].toFixed(1)}</div><div class="metric-label">종합점수</div></div>`;
        }
        
        function updateDrilldownChart(data) {
            const container = document.getElementById('drilldown-chart-container');
            if (!container) return;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (data.length === 0 || selectedScores.length === 0) { 
                const message = data.length > 0 ? '표시할 문항을 선택해주세요.' : '';
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: message, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const averages = calculateAverages(data);
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            const chartData = [{ x: selectedScores, y: selectedScores.map(col => averages[col].toFixed(1)), type: 'bar', text: selectedScores.map(col => averages[col].toFixed(1)), textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[0], line: { color: '#000000', width: 1 } }, hovertemplate: '%{x}: %{y}<extra></extra>' }];
            const selectedYear = document.getElementById('year-filter').value;
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            
            // 제목 생성
            let titleParts = [];
            if (selectedDept !== '전체') { titleParts.push(selectedDept); }
            if (selectedUnit !== '전체') { titleParts.push(selectedUnit); }
            
            const titlePrefix = titleParts.length > 0 ? titleParts.join(' > ') : '부서, Unit';
            const yearSuffix = selectedYear === '전체' ? ' (전체 연도)' : ` (${selectedYear})`;
            const title = `<b>${titlePrefix} 문항 점수${yearSuffix}</b>`;
            const layout = { title: title, yaxis: { title: '점수', range: [0, 100] }, font: layoutFont, hovermode: 'closest', margin: { l: 60, r: 60, t: 80, b: 60 } };
            Plotly.react(container, chartData, layout);
        }
        
        function updateHospitalYearlyChart() {
            const container = document.getElementById('hospital-yearly-chart-container');
            const selectedScores = Array.from(document.querySelectorAll('input[name="hospital-score"]:checked')).map(cb => cb.value);
            
            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 집계 데이터 사용
            const hospitalData = aggregatedData.hospital_yearly;
            const years = Object.keys(hospitalData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => hospitalData[year][col] ? hospitalData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => hospitalData[year]['응답수'] || 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: '<b>병원 전체 결과</b>',
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateDivisionYearlyChart() {
            const container = document.getElementById('division-yearly-chart-container');
            const selectedDivision = document.getElementById('division-chart-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="division-score"]:checked')).map(cb => cb.value);

            // 교육부문로 고정되어 있으므로 선택 확인 불필요

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문별 집계 데이터 사용
            const divisionData = aggregatedData.division_yearly[selectedDivision] || {};
            const years = Object.keys(divisionData).sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => divisionData[year] && divisionData[year][col] ? divisionData[year][col].toFixed(1) : '0.0');
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => divisionData[year] ? divisionData[year]['응답수'] || 0 : 0);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            const layout = {
                title: `<b>[${selectedDivision}] 결과</b>`,
                barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont,
                hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            Plotly.react(container, traces, layout);
        }

        function updateYearlyDivisionComparisonChart() {
            const container = document.getElementById('comparison-chart-container');
            const selectedYear = document.getElementById('comparison-year-filter').value;
            const selectedDivisions = Array.from(document.querySelectorAll('input[name="comparison-division"]:checked')).map(cb => cb.value);

            if (selectedDivisions.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '비교할 부문을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 미리 계산된 부문 비교 집계 데이터 사용 (모든 부문 포함)
            const comparisonData = aggregatedData.division_comparison[selectedYear] || {};
            
            const divisions = selectedDivisions.filter(div => comparisonData[div]).sort((a,b) => a.localeCompare(b, 'ko'));
            const avgScores = divisions.map(div => comparisonData[div]['종합점수'] ? comparisonData[div]['종합점수'].toFixed(1) : '0.0');
            const responseCounts = divisions.map(div => comparisonData[div]['응답수'] || 0);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = { x: divisions, y: avgScores, type: 'bar', text: avgScores, textposition: 'outside', textfont: { size: 14 }, marker: { color: '#FDC1B4', line: { color: '#000000', width: 1 } }, customdata: responseCounts, hovertemplate: '%{x}: %{y}점<br>응답수: %{customdata}건<extra></extra>' };
            
            const avgLine = {
                x: [divisions[0], divisions[divisions.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };
            
            const layout = {
                title: `<b>${selectedYear} 부문별 종합 점수</b>`,
                yaxis: { title: '점수', range: [0, 100] },
                font: layoutFont,
                height: 500,
                barmode: 'group',
                hovermode: 'closest',
                showlegend: false,
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };
            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateSentimentChart(data) {
            const container = document.getElementById('sentiment-chart-container');
            
            if (data.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류가 있는 데이터만 필터링
            const validSentimentData = data.filter(item => {
                const sentiment = item['감정_분류'];
                return sentiment && sentiment !== 'N/A' && sentiment !== '알 수 없음';
            });

            if (validSentimentData.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '감정 분류 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 감정 분류별 집계 (알 수 없음 제외)
            const sentimentCounts = {};
            validSentimentData.forEach(item => {
                const sentiment = item['감정_분류'];
                sentimentCounts[sentiment] = (sentimentCounts[sentiment] || 0) + 1;
            });

            // 원하는 순서로 감정 분류 고정
            const desiredOrder = ['긍정', '부정', '중립'];
            const sentiments = desiredOrder.filter(sentiment => sentimentCounts[sentiment] > 0);
            const counts = sentiments.map(sentiment => sentimentCounts[sentiment]);
            const total = counts.reduce((sum, count) => sum + count, 0);
            const percentages = counts.map(count => ((count / total) * 100).toFixed(1));

            // 색상 매핑
            const colorMap = {
                '긍정': '#72B0AB',
                '부정': '#FE9179', 
                '중립': '#FFF6F5',
                '알 수 없음': '#808080'
            };
            const colors = sentiments.map(sentiment => colorMap[sentiment] || '#808080');

            const trace = {
                x: sentiments,
                y: counts,
                type: 'bar',
                text: counts.map((count, idx) => `${count}건 (${percentages[idx]}%)`),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{x}: %{y}건 (%{text})<extra></extra>'
            };

            const layout = {
                title: '',
                height: 400,
                xaxis: { title: '감정 분류' },
                yaxis: { title: '응답 수', rangemode: 'tozero', range: [0, Math.max(...counts) * 1.15] },
                font: layoutFont,
                hovermode: 'closest',
                showlegend: false,
                margin: { l: 60, r: 60, t: 80, b: 60 }
            };

            Plotly.react(container, [trace], layout);
        }


        function updateReviewsTable(data = null) {
            const tbody = document.querySelector("#reviews-table tbody");
            
            if (data === null) { data = getFilteredData(); }
            
            const selectedSentiments = Array.from(document.querySelectorAll('input[name="review-sentiment"]:checked')).map(cb => cb.value);
            
            let filteredData = data;
            if (selectedSentiments.length > 0 && !selectedSentiments.includes('전체')) {
                filteredData = data.filter(item => selectedSentiments.includes(item['감정_분류']));
            }
            
            const reviews = filteredData.map(item => ({ 
                year: item['설문시행연도'], 
                review: item['정제된_텍스트'],
                sentiment: item['감정_분류'] || '알 수 없음'
            })).filter(r => r.review && r.review !== 'N/A')
            .sort((a, b) => b.year - a.year)
            .slice(0, 40000); // 최대 40000개만 표시
            
            // 후기 개수 표시 업데이트
            const countDisplay = document.getElementById('reviews-count-display');
            if (countDisplay) {
                countDisplay.textContent = `(${reviews.length}건)`;
            }
            
            tbody.innerHTML = (reviews.length > 0) ? 
                reviews.map(r => `<tr><td>${r.year}</td><td>${r.review} <span style="color: #666; font-size: 0.9em;">[${r.sentiment}]</span></td></tr>`).join('') : 
                '<tr><td colspan="2">해당 조건의 후기가 없습니다.</td></tr>';
        }

        function updateKeywordAnalysis(data) {
            const positiveCounts = {};
            const negativeCounts = {};

            data.forEach(item => {
                const keywords = item['핵심_키워드'];
                if (keywords && Array.isArray(keywords) && keywords.length > 0) {
                    const sentiment = item['감정_분류'];
                    keywords.forEach(kw => {
                        if (sentiment === '긍정') {
                            positiveCounts[kw] = (positiveCounts[kw] || 0) + 1;
                        } else if (sentiment === '부정') {
                            negativeCounts[kw] = (negativeCounts[kw] || 0) + 1;
                        }
                    });
                }
            });

            const topPositive = Object.entries(positiveCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);
            const topNegative = Object.entries(negativeCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);

            const posChartContainer = document.getElementById('positive-keywords-chart');
            const negChartContainer = document.getElementById('negative-keywords-chart');

            if (posChartContainer) plotKeywordChart(posChartContainer, '긍정 키워드 Top 10', topPositive, '긍정');
            if (negChartContainer) plotKeywordChart(negChartContainer, '부정 키워드 Top 10', topNegative, '부정');
            
            displayKeywordReviews(null, null, true);
        }

        function plotKeywordChart(container, title, data, sentiment) {
            if (!container) return;
            if (data.length === 0) {
                Plotly.react(container, [], { title: `<b>${title}</b>`, height: 400, annotations: [{ text: '데이터 없음', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false }] });
                return;
            }

            const trace = {
                y: data.map(d => d[0]).reverse(),
                x: data.map(d => d[1]).reverse(),
                type: 'bar',
                orientation: 'h',
                marker: { color: sentiment === '긍정' ? '#72B0AB' : '#FE9179', line: { color: '#000000', width: 1 } },
                hovertemplate: '언급 횟수: %{x}<extra></extra>'
            };

            const layout = {
                title: `<b>${title}</b>`,
                height: 400,
                margin: { l: 120, r: 40, t: 80, b: 60 },
                xaxis: { title: '언급 횟수' },
                yaxis: { automargin: true }
            };

            Plotly.react(container, [trace], layout);
            container.removeAllListeners('plotly_click');
            container.on('plotly_click', (eventData) => {
                const keyword = eventData.points[0].y;
                displayKeywordReviews(keyword, sentiment);
            });
        }

        function displayKeywordReviews(keyword, sentiment, isInitial = false) {
            const container = document.getElementById('keyword-reviews-container');
            if (!container) return;
            
            if (isInitial) {
                container.innerHTML = `<h4>관련 리뷰</h4><p>위 그래프의 막대를 클릭하면 관련 리뷰를 확인할 수 있습니다.</p><div id="keyword-reviews-table-container"><table id="keyword-reviews-table"><thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody><tr><td colspan="2" style="text-align:center;"></td></tr></tbody></table></div>`;
                return;
            }

            const filteredData = getFilteredData();
            
            const reviews = filteredData.filter(item => 
                item['감정_분류'] === sentiment && 
                Array.isArray(item['핵심_키워드']) && 
                item['핵심_키워드'].includes(keyword)
            );

            let content = `<h4>'${keyword}' (${sentiment}) 관련 리뷰 (${reviews.length}건)</h4>`;
            if (reviews.length > 0) {
                content += `<div id="keyword-reviews-table-container"><table id="keyword-reviews-table">
                    <thead><tr><th style="width: 100px;">연도</th><th>후기 내용</th></tr></thead><tbody>`;
                content += reviews.slice(0, 40000).map(r => `<tr><td>${r['설문시행연도']}</td><td>${r['정제된_텍스트']}</td></tr>`).join(''); // 최대 40000개만 표시
                content += `</tbody></table></div>`;
            } else {
                content += '<p>관련 리뷰가 없습니다.</p>';
            }
            container.innerHTML = content;
        }

        function setupTeamRankingChart() {
            const yearSelect = document.getElementById('team-ranking-year-filter');
            const divisionSelect = document.getElementById('team-ranking-division-filter');
            
            yearSelect.innerHTML = allYears.map(opt => `<option value="${opt}">${opt}</option>`).join('');
            yearSelect.value = allYears[allYears.length - 1];
            
            // 고정값: 교육부문만 선택 가능
            divisionSelect.innerHTML = `<option value="교육부문">교육부문</option>`;
            divisionSelect.value = "교육부문";
            
            yearSelect.addEventListener('change', updateTeamRankingChart);
            divisionSelect.addEventListener('change', updateTeamRankingChart);
            // 초기 차트 표시
            updateTeamRankingChart();
        }

        function updateTeamRankingChart() {
            const container = document.getElementById('team-ranking-chart-container');
            const selectedYear = document.getElementById('team-ranking-year-filter').value;
            const selectedDivision = document.getElementById('team-ranking-division-filter').value;

            // 교육부문로 고정되어 있으므로 선택 확인 불필요

            // 미리 계산된 팀 순위 집계 데이터 사용
            const teamRankingData = aggregatedData.team_ranking[selectedYear] || [];
            
            // 해당 부문에 속한 팀들만 필터링 (교육부문 소속 부서들)
            const teamRankings = teamRankingData.filter(team => {
                // 동적으로 해당 부문의 부서들을 포함
                return true; // 이미 집계 데이터에서 해당 부문만 포함되어 있음
            });

            if (teamRankings.length === 0) {
                Plotly.react(container, [], {
                    height: 600,
                    annotations: [{ text: '선택된 조건에 해당하는 부서 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            // 모든 부문 동일 색상 사용
            const departments = teamRankings.map(item => item.department);
            const scores = teamRankings.map(item => parseFloat(item.score));
            const colors = teamRankings.map(() => '#FDC1B4');
            const hoverTexts = teamRankings.map(item => `부서: ${item.department}<br>점수: ${item.score.toFixed(1)}<br>응답수: ${item.count}건`);

            // 미리 계산된 전체 평균 사용
            const yearlyOverallAverage = aggregatedData.hospital_yearly[selectedYear] ? aggregatedData.hospital_yearly[selectedYear]['종합점수'].toFixed(1) : '0.0';

            const trace = {
                x: departments, y: scores, type: 'bar', text: scores.map(score => score.toFixed(1)),
                textposition: 'outside', textfont: { size: 12 }, marker: { color: colors, line: { color: '#000000', width: 1 } },
                hovertemplate: '%{hovertext}<extra></extra>', hovertext: hoverTexts
            };

            const avgLine = {
                x: [departments[0], departments[departments.length - 1]], y: [yearlyOverallAverage, yearlyOverallAverage],
                type: 'scatter', mode: 'lines', line: { color: 'red', width: 2, dash: 'dash' },
                name: `${selectedYear} 종합 점수: ${yearlyOverallAverage}`, hoverinfo: 'skip'
            };

            const layout = {
                title: `<b>${selectedYear} 팀별 종합점수</b>`, height: 600,
                xaxis: { title: '부서', tickangle: -45, automargin: true },
                yaxis: { title: '점수', range: [Math.min(...scores) - 5, Math.max(...scores) + 5] },
                font: layoutFont, hovermode: 'closest', showlegend: false,
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.02, xanchor: 'right', x: 1 },
                annotations: [{
                    text: `${selectedYear} 종합 점수: ${yearlyOverallAverage}점`, xref: 'paper', yref: 'y',
                    x: 0.02, y: parseFloat(yearlyOverallAverage), showarrow: false,
                    font: { color: 'red', size: 12 }, bgcolor: 'rgba(255,255,255,0.8)',
                    bordercolor: 'red', borderwidth: 1
                }],
                margin: { l: 60, r: 60, t: 80, b: 100 }
            };

            Plotly.react(container, [trace, avgLine], layout);
        }

        function updateYearlyComparisonChart() {
            const container = document.getElementById('yearly-comparison-chart-container');
            const selectedDept = document.getElementById('department-filter').value;
            const selectedUnit = document.getElementById('unit-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let targetData = [...rawData];
            if (selectedDept !== '전체') { targetData = targetData.filter(item => item['피평가부서'] === selectedDept); }
            if (selectedUnit !== '전체') { targetData = targetData.filter(item => item['피평가Unit'] === selectedUnit); }

            if (targetData.length === 0) {
                Plotly.react(container, [], {
                    height: 500,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const years = [...new Set(targetData.map(item => item['설문시행연도']))].sort();
            const traces = [];

            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = years.map(year => {
                    const yearData = targetData.filter(d => d['설문시행연도'] === year);
                    return yearData.length > 0 ? (yearData.reduce((sum, item) => sum + (item[col] || 0), 0) / yearData.length).toFixed(1) : 0;
                });
                traces.push({ x: years, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>연도: %{x}<extra></extra>' });
            });
            
            const yearly_counts = years.map(year => targetData.filter(d => d['설문시행연도'] === year).length);
            traces.push({ x: years, y: yearly_counts, name: '응답수', type: 'scatter', mode: 'lines+markers+text', line: { shape: 'spline', smoothing: 0.3, width: 3, color: '#355e58' }, text: yearly_counts.map(count => `${count.toLocaleString()}건`), textposition: 'top center', textfont: { size: 12 }, yaxis: 'y2', hovertemplate: '응답수: %{y}건<br>연도: %{x}<extra></extra>' });

            let titleText = '결과';
            if (selectedDept !== '전체' && selectedUnit !== '전체') { titleText = `[${selectedDept} > ${selectedUnit}] 결과`; }
            else if (selectedDept !== '전체') { titleText = `[${selectedDept}] 결과`; }
            else if (selectedUnit !== '전체') { titleText = `[${selectedUnit}] 결과`; }
            
            const layout = {
                title: `<b>${titleText}</b>`, barmode: 'group', height: 500,
                xaxis: { type: 'category', title: '설문 연도' },
                yaxis: { title: '점수', range: [0, 100] },
                yaxis2: { title: '응답 수', overlaying: 'y', side: 'right', showgrid: false, rangemode: 'tozero', tickformat: 'd' },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };
            
            Plotly.react(container, traces, layout);
        }

        function setupUnitComparisonChart() {
            // Unit comparison chart uses main filters from detailed analysis section
            // No separate filters needed
        }

        function updateUnitComparisonChart() {
            const container = document.getElementById('unit-comparison-chart-container');
            const selectedDepartment = document.getElementById('department-filter').value;
            const selectedYear = document.getElementById('year-filter').value;
            const selectedScores = Array.from(document.querySelectorAll('input[name="drilldown-score"]:checked')).map(cb => cb.value);

            if (selectedDepartment === '전체') {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: 'Unit 간 비교를 위해 부서를 선택해 주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            if (selectedScores.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '표시할 문항을 선택해주세요.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            let departmentData = rawData.filter(item => item['피평가부서'] === selectedDepartment);
            if (selectedYear !== '전체') { departmentData = departmentData.filter(item => item['설문시행연도'] === selectedYear); }

            const unitsInDepartment = [...new Set(departmentData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a, b) => String(a).localeCompare(String(b), 'ko'));

            if (unitsInDepartment.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 Unit이 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }

            const traces = [];
            const barColors = ['#FFF6F5', '#72B0AB', '#BCDDDC', '#FFEDD1', '#FDC1B4', '#FE9179'];
            selectedScores.forEach((col, index) => {
                const y_values = unitsInDepartment.map(unit => {
                    const unitData = departmentData.filter(item => item['피평가Unit'] === unit);
                    return unitData.length > 0 ? (unitData.reduce((sum, item) => sum + (item[col] || 0), 0) / unitData.length).toFixed(1) : 0;
                });
                traces.push({ x: unitsInDepartment, y: y_values, name: col, type: 'bar', text: y_values, textposition: 'outside', textfont: { size: 14 }, marker: { color: barColors[index % barColors.length], line: { color: '#000000', width: 1 } }, hovertemplate: '%{fullData.name}: %{y}<br>Unit: %{x}<extra></extra>' });
            });

            const layout = {
                title: `<b>[${selectedDepartment}] Unit별 결과</b>`, barmode: 'group', height: 400,
                xaxis: { title: 'Unit' }, yaxis: { title: '점수', range: [0, 100] },
                legend: { orientation: 'h', yanchor: 'bottom', y: 1.05, xanchor: 'right', x: 1 },
                font: layoutFont, hovermode: 'closest',
                margin: { l: 60, r: 60, t: 120, b: 60 }
            };

            Plotly.react(container, traces, layout);
        }

        function toggleExpander(expanderId) {
            const content = document.getElementById(expanderId);
            const arrow = document.getElementById(expanderId.replace('-expander', '-arrow'));
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                arrow.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                arrow.classList.add('expanded');
            }
        }

        function updateExpanderHeader(groupName, selectedCount, totalCount) {
            const headerId = groupName.replace('-filter', '-header');
            const headerSpan = document.querySelector(`#${headerId} span:first-child`);
            if (headerSpan) {
                if (groupName.includes('division-filter')) {
                    headerSpan.textContent = `부문 선택 (${selectedCount}개 선택됨)`;
                } else {
                    headerSpan.textContent = `문항 선택 (${selectedCount}개 선택됨)`;
                }
            }
        }

        function createCheckboxFilter(containerId, items, groupName, updateFunction, startChecked = true) {
            const container = document.getElementById(containerId);
            
            const selectAllDiv = document.createElement('div');
            selectAllDiv.className = 'checkbox-item';
            selectAllDiv.innerHTML = `<input type="checkbox" id="${groupName}-select-all" ${startChecked ? 'checked' : ''}><label for="${groupName}-select-all"><b>전체 선택</b></label>`;
            container.appendChild(selectAllDiv);
            
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'checkbox-item';
                itemDiv.innerHTML = `<input type="checkbox" id="${groupName}-${item}" name="${groupName}" value="${item}" ${startChecked ? 'checked' : ''}><label for="${groupName}-${item}">${item}</label>`;
                container.appendChild(itemDiv);
            });

            const selectAllCheckbox = container.querySelector(`#${groupName}-select-all`);
            const itemCheckboxes = container.querySelectorAll(`input[name="${groupName}"]`);

            function updateSelectAllState() {
                const allChecked = [...itemCheckboxes].every(cb => cb.checked);
                const someChecked = [...itemCheckboxes].some(cb => cb.checked);
                const checkedCount = [...itemCheckboxes].filter(cb => cb.checked).length;
                
                selectAllCheckbox.checked = allChecked;
                selectAllCheckbox.indeterminate = !allChecked && someChecked;
                
                updateExpanderHeader(containerId, checkedCount, items.length);
            }

            selectAllCheckbox.addEventListener('change', (e) => {
                itemCheckboxes.forEach(checkbox => { checkbox.checked = e.target.checked; });
                updateSelectAllState();
                updateFunction();
            });

            itemCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    updateSelectAllState();
                    updateFunction();
                });
            });

            updateSelectAllState();
        }

        // === 협업 네트워크 분석 기능 ===
        
        // 부문-부서-Unit 매핑 생성
        const divisionDepartmentMap = rawData.reduce((acc, item) => {
            const division = item['피평가부문'];
            const department = item['피평가부서'];
            if (division && division !== 'N/A' && department && department !== 'N/A') {
                if (!acc[division]) { acc[division] = new Set(); }
                acc[division].add(department);
            }
            return acc;
        }, {});
        for (const division in divisionDepartmentMap) {
            divisionDepartmentMap[division] = [...divisionDepartmentMap[division]].sort((a, b) => String(a).localeCompare(String(b), 'ko'));
        }

        function setupNetworkAnalysis() {
            const yearSelect = document.getElementById('network-year-filter');
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const minCollabSelect = document.getElementById('min-collaboration-filter');
            
            // 연도 필터 설정
            yearSelect.innerHTML = ['전체', ...allYears].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            
            // 부문 필터 설정 - 고정값: 교육부문만 선택 가능
            divisionSelect.innerHTML = `<option value="교육부문">교육부문</option>`;
            divisionSelect.value = "교육부문";
            
            // 초기 부서, Unit 설정
            departmentSelect.innerHTML = '<option value="전체">전체</option>';
            unitSelect.innerHTML = '<option value="전체">전체</option>';
            
            // 이벤트 리스너 추가 (연도와 최소 횟수 필터만)
            yearSelect.addEventListener('change', updateNetworkAnalysis);
            minCollabSelect.addEventListener('change', updateNetworkAnalysis);
            
            // 초기 네트워크 분석 표시
            updateNetworkAnalysis();
        }

        function updateNetworkDepartments() {
            const divisionSelect = document.getElementById('network-division-filter');
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDivision = divisionSelect.value;
            
            // 부서 드롭다운을 교육수련팀으로 고정
            departmentSelect.innerHTML = `<option value="교육수련팀">교육수련팀</option>`;
            departmentSelect.value = "교육수련팀";
            
            // 부서 필터가 변경되었으므로, Unit 필터를 업데이트하고 분석을 새로고침합니다.
            updateNetworkUnits();
        }

        function updateNetworkUnits() {
            const departmentSelect = document.getElementById('network-department-filter');
            const unitSelect = document.getElementById('network-unit-filter');
            const selectedDept = departmentSelect.value;
            
            // Unit 드롭다운 업데이트
            const allUnits = [...new Set(rawData.map(item => item['피평가Unit']))].filter(u => u && u !== 'N/A').sort((a,b) => a.localeCompare(b, 'ko'));
            const units = (selectedDept === '전체' || !departmentUnitMap[selectedDept])
                ? allUnits
                : departmentUnitMap[selectedDept];
            
            unitSelect.innerHTML = ['전체', ...units].map(opt => `<option value="${opt}">${opt}</option>`).join('');
            unitSelect.value = '전체';
            
            updateNetworkAnalysis();
        }

        function getNetworkFilteredData() {
            let filteredData = [...rawData];
            
            const selectedYear = document.getElementById('network-year-filter').value;
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedYear !== '전체') { filteredData = filteredData.filter(item => String(item['설문시행연도']) === String(selectedYear)); }
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }
        
        function getNetworkFilteredDataWithoutYear() {
            let filteredData = [...rawData];
            
            const selectedDivision = document.getElementById('network-division-filter').value;
            const selectedDepartment = document.getElementById('network-department-filter').value;
            const selectedUnit = document.getElementById('network-unit-filter').value;
            
            if (selectedDivision !== '전체') { filteredData = filteredData.filter(item => item['피평가부문'] === selectedDivision); }
            if (selectedDepartment !== '전체') { filteredData = filteredData.filter(item => item['피평가부서'] === selectedDepartment); }
            if (selectedUnit !== '전체') { filteredData = filteredData.filter(item => item['피평가Unit'] === selectedUnit); }
            
            return filteredData;
        }

        function updateNetworkAnalysis() {
            updateCollaborationFrequencyChart();
        }

        function updateCollaborationFrequencyChart() {
            const container = document.getElementById('collaboration-frequency-chart-container');
            const selectedYear = document.getElementById('network-year-filter').value;
            const minCollabCount = parseInt(document.getElementById('min-collaboration-filter').value);
            
            // 집계된 네트워크 분석 데이터 사용
            let collaborationCounts = {};
            if (selectedYear === '전체') {
                // 모든 연도의 협업 횟수 합산
                Object.keys(aggregatedData.network_analysis || {}).forEach(year => {
                    const yearData = aggregatedData.network_analysis[year];
                    if (yearData && yearData.collaboration_counts) {
                        Object.entries(yearData.collaboration_counts).forEach(([relation, count]) => {
                            collaborationCounts[relation] = (collaborationCounts[relation] || 0) + count;
                        });
                    }
                });
            } else {
                // 특정 연도의 협업 횟수만 사용
                const yearData = aggregatedData.network_analysis && aggregatedData.network_analysis[selectedYear];
                if (yearData && yearData.collaboration_counts) {
                    collaborationCounts = yearData.collaboration_counts;
                }
            }
            
            // 데이터가 없는 경우 처리
            if (Object.keys(collaborationCounts).length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: '선택된 조건에 해당하는 데이터가 없습니다.', xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            // 최소 협업 횟수 이상인 관계만 필터링
            const filteredCollaborations = Object.entries(collaborationCounts)
                .filter(([_, count]) => count >= minCollabCount)
                .sort((a, b) => b[1] - a[1]);
            
            if (filteredCollaborations.length === 0) {
                Plotly.react(container, [], {
                    height: 400,
                    annotations: [{ text: `최소 ${minCollabCount}회 이상 협업한 관계가 없습니다.`, xref: 'paper', yref: 'paper', x: 0.5, y: 0.5, showarrow: false, font: {size: 16, color: '#888'} }],
                    xaxis: {visible: false}, yaxis: {visible: false}
                });
                return;
            }
            
            const trace = {
                y: filteredCollaborations.map(([key, _]) => key).reverse(),
                x: filteredCollaborations.map(([_, count]) => count).reverse(),
                type: 'bar',
                orientation: 'h',
                text: filteredCollaborations.map(([_, count]) => `${count}회`).reverse(),
                textposition: 'outside',
                textfont: { size: 12 },
                marker: { color: '#355E58', line: { color: '#000000', width: 1 } },
                hovertemplate: '협업 횟수: %{x}회<extra></extra>'
            };
            
            // 부서 수에 따라 동적 높이 계산 (막대당 최소 25px 보장)
            const barHeight = 25;
            const dynamicHeight = Math.max(400, filteredCollaborations.length * barHeight + 100);
            
            const layout = {
                title: '<b>부서 리스트</b>',
                height: dynamicHeight,
                margin: { l: 150, r: 40, t: 80, b: 60 },
                xaxis: { title: '협업 횟수' },
                yaxis: { 
                    automargin: true,
                    fixedrange: true,
                    categoryorder: 'total ascending'
                },
                font: layoutFont
            };
            
            Plotly.react(container, [trace], layout);
        }

        



        window.onload = () => { 
            populateFilters(); 
            createCheckboxFilter('hospital-score-filter', scoreCols, 'hospital-score', updateHospitalYearlyChart);
            createCheckboxFilter('drilldown-score-filter', scoreCols, 'drilldown-score', updateDashboard);
            createCheckboxFilter('review-sentiment-filter', ['긍정', '부정', '중립'], 'review-sentiment', updateReviewsTable, true);
            setupDivisionChart();
            setupComparisonChart();
            setupTeamRankingChart();
            setupUnitComparisonChart();
            setupNetworkAnalysis();
            updateDashboard(); 
            updateHospitalYearlyChart();
            updateDivisionYearlyChart();
            updateYearlyDivisionComparisonChart();
            updateTeamRankingChart();
            updateUnitComparisonChart();
            updateNetworkAnalysis();
        };
    </script>
</body>
</html>
    