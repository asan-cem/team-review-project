# 🏥 서울아산병원 협업평가 시스템 사용 가이드

## 📚 **목차**
1. [프로젝트 개요](#-프로젝트-개요)
2. [파일 구조 및 역할](#-파일-구조-및-역할)
3. [초보자를 위한 기본 사용법](#-초보자를-위한-기본-사용법)
4. [고급 사용법](#-고급-사용법)
5. [문제 해결 가이드](#-문제-해결-가이드)
6. [FAQ](#-자주-묻는-질문-faq)

---

## 🎯 **프로젝트 개요**

이 시스템은 서울아산병원의 협업평가 데이터를 분석하고 시각화하는 도구입니다.

### **주요 기능**
- 📊 엑셀 데이터를 자동으로 읽어서 분석
- 🤖 AI를 이용한 감정 분석 (긍정/부정/중립)
- 🔍 핵심 키워드 추출
- 📈 인터랙티브 대시보드 생성
- 📋 요약 보고서 생성

---

## 📁 **파일 구조 및 역할**

### **🔥 주요 실행 파일 (반드시 알아야 할 파일들)**

```
📂 team-review-project/
├── 🎯 main.py                              # 메인 데이터 분석 프로그램
├── 📊 build_dashboard_html_improved.py     # 대시보드 생성 프로그램 (개선된 버전)
├── 📊 build_dashboard_html.py              # 대시보드 생성 프로그램 (기존 버전)
├── 🚀 build_dashboard.sh                  # 편의 실행 스크립트
└── 📚 프로젝트_사용_가이드.md              # 이 가이드 파일
```

### **📋 데이터 파일**

```
📂 데이터 파일들/
├── 📄 설문조사_전처리데이터_20250620_0731.xlsx          # 원본 데이터
├── 📄 설문조사_전처리데이터_20250620_0731_processed.xlsx # 처리된 데이터
├── 📄 상호평가_요약_2025.xlsx                          # 요약 데이터
└── 📄 서울아산병원 협업평가 대시보드.html               # 생성된 대시보드
```

### **⚙️ 지원 모듈 파일들 (자동으로 동작)**

```
📂 시스템 파일들/ (건드리지 마세요!)
├── dashboard_config.py        # 설정 파일
├── data_processor.py          # 데이터 처리 모듈
├── dashboard_templates.py     # HTML 템플릿
├── dashboard_styles.py        # CSS 스타일
├── dashboard_javascript.py    # JavaScript 코드
├── security_utils.py          # 보안 기능
├── dashboard_builder.py       # 대시보드 빌더
└── test_improved_dashboard.py # 테스트 파일
```

---

## 👶 **초보자를 위한 기본 사용법**

### **🎯 1단계: main.py 사용하기 (데이터 분석)**

**이 프로그램은 언제 사용하나요?**
- 새로운 설문조사 데이터를 받았을 때
- AI 감정 분석을 수행하고 싶을 때
- 키워드 추출이 필요할 때

**사용법:**

#### **방법 1: 더블클릭으로 실행 (가장 쉬움)**
1. 파일 탐색기에서 `main.py` 파일을 찾습니다
2. 파일을 더블클릭합니다
3. 검은 창이 나타나며 프로그램이 실행됩니다

#### **방법 2: 명령어로 실행**
```bash
# 터미널/명령 프롬프트를 열고 다음 명령어 입력
python main.py
```

**실행 중 나타나는 화면:**
```
🚀 협업평가 데이터 분석 시작...
📊 데이터 로드 중... (38,730개 레코드)
🤖 AI 감정 분석 중... (이 과정은 시간이 걸릴 수 있습니다)
🔍 키워드 추출 중...
✅ 분석 완료! 결과가 저장되었습니다.
```

**결과물:**
- `설문조사_전처리데이터_20250620_0731_processed.xlsx` 파일이 생성됩니다
- 이 파일에는 감정 분석 결과와 키워드가 추가되어 있습니다

---

### **📊 2단계: 대시보드 생성하기**

**이 프로그램은 언제 사용하나요?**
- 웹 브라우저에서 볼 수 있는 시각화를 만들고 싶을 때
- 상호작용 가능한 차트를 만들고 싶을 때
- 프레젠테이션용 자료가 필요할 때

#### **방법 1: 편의 스크립트 사용 (가장 쉬움)**
1. 파일 탐색기에서 `build_dashboard.sh` 파일을 찾습니다
2. 파일을 더블클릭합니다
3. 메뉴가 나타나면 원하는 옵션을 선택합니다

```
🏥 서울아산병원 협업평가 대시보드 생성기
==========================================

사용할 버전을 선택하세요:
1) 기존 버전 (빠름, 기본 기능)
2) 개선된 버전 (안전함, 고급 기능)  ← 추천!
3) 개선된 버전 (상세 로그)
4) 두 버전 모두 실행하여 비교

선택 (1-4): 2
```

#### **방법 2: 직접 실행**
```bash
# 개선된 버전 실행 (추천)
python build_dashboard_html_improved.py

# 기존 버전 실행
python build_dashboard_html.py
```

**결과물:**
- `서울아산병원 협업평가 대시보드.html` 파일이 생성됩니다
- 이 파일을 웹 브라우저에서 열면 인터랙티브 대시보드를 볼 수 있습니다

---

## 🎯 **완전한 작업 순서 (처음부터 끝까지)**

### **📋 체크리스트**

#### **✅ 1단계: 준비 작업**
- [ ] 새로운 설문조사 엑셀 파일이 있는지 확인
- [ ] 파일 이름이 `설문조사_전처리데이터_YYYYMMDD_HHMM.xlsx` 형식인지 확인
- [ ] 프로젝트 폴더에 파일을 복사

#### **✅ 2단계: 데이터 분석 실행**
- [ ] `main.py` 실행
- [ ] 프로그램이 완료될 때까지 대기 (10-30분 소요 가능)
- [ ] `_processed.xlsx` 파일이 생성되었는지 확인

#### **✅ 3단계: 대시보드 생성**
- [ ] `build_dashboard.sh` 실행 또는 `build_dashboard_html_improved.py` 실행
- [ ] `서울아산병원 협업평가 대시보드.html` 파일이 생성되었는지 확인

#### **✅ 4단계: 결과 확인**
- [ ] HTML 파일을 웹 브라우저에서 열어 대시보드 확인
- [ ] 모든 차트가 정상적으로 표시되는지 확인
- [ ] 필요시 파일을 다른 사람에게 공유

---

## 🚨 **주의사항 및 팁**

### **⚠️ 꼭 지켜야 할 것들**

1. **파일 이름 변경 금지**
   - `main.py`, `build_dashboard_html_improved.py` 등의 파일 이름을 바꾸면 안 됩니다
   - 데이터 파일은 지정된 형식을 따라야 합니다

2. **실행 중 중단 금지**
   - 프로그램이 실행 중일 때 강제로 종료하지 마세요
   - 특히 `main.py`는 실행 시간이 길 수 있습니다

3. **인터넷 연결 필요**
   - AI 분석을 위해 인터넷 연결이 필요합니다
   - 대시보드 생성 시에도 일부 기능에 인터넷이 필요합니다

### **💡 유용한 팁**

1. **작업 전 백업**
   ```bash
   # 중요한 파일들을 백업 폴더에 복사
   cp *.xlsx backup/
   cp *.html backup/
   ```

2. **진행 상황 확인**
   - 프로그램 실행 중 검은 창의 메시지를 확인하세요
   - 에러 메시지가 나타나면 스크린샷을 찍어두세요

3. **결과 파일 관리**
   ```
   📂 results/
   ├── 2025-01-01_대시보드.html
   ├── 2025-01-15_대시보드.html
   └── 2025-02-01_대시보드.html
   ```

---

## 🔧 **고급 사용법**

### **🎛️ 설정 변경하기**

**파일 경로 변경:**
```python
# dashboard_config.py 파일에서 수정 가능
DATA_FILE = "새로운_데이터_파일.xlsx"
OUTPUT_FILE = "새로운_대시보드_이름.html"
```

**차트 색상 변경:**
```python
# dashboard_config.py 파일에서 수정 가능
SENTIMENT_COLORS = {
    '긍정': '#00ff00',  # 초록색
    '부정': '#ff0000',  # 빨간색
    '중립': '#0000ff'   # 파란색
}
```

### **🚀 명령어 옵션**

**main.py 고급 옵션:**
```bash
# 특정 파일만 처리
python main.py --input custom_data.xlsx

# 병렬 처리 수 조정
python main.py --workers 4

# 디버그 모드
python main.py --debug
```

**대시보드 생성 고급 옵션:**
```bash
# 입력/출력 파일 지정
python build_dashboard_html_improved.py --input data.xlsx --output dashboard.html

# 데이터 검증 건너뛰기 (빠른 생성)
python build_dashboard_html_improved.py --no-validation

# 상세 로그 출력
python build_dashboard_html_improved.py --verbose
```

---

## 🆘 **문제 해결 가이드**

### **❌ 자주 발생하는 문제들**

#### **1. "파일을 찾을 수 없습니다" 에러**
```
❌ 문제: FileNotFoundError: 설문조사_전처리데이터_20250620_0731.xlsx
```
**해결책:**
- 데이터 파일이 올바른 위치에 있는지 확인
- 파일 이름이 정확한지 확인
- 파일에 읽기 권한이 있는지 확인

#### **2. "메모리 부족" 에러**
```
❌ 문제: MemoryError: Unable to allocate array
```
**해결책:**
- 다른 프로그램들을 종료하고 다시 시도
- 데이터 파일이 너무 큰지 확인 (100MB 이상이면 분할 처리 필요)
- 컴퓨터를 재시작하고 다시 시도

#### **3. "인터넷 연결" 에러**
```
❌ 문제: ConnectionError: Failed to connect to AI service
```
**해결책:**
- 인터넷 연결 상태 확인
- 방화벽 설정 확인
- VPN 사용 중이라면 해제 후 재시도

#### **4. "권한" 에러**
```
❌ 문제: PermissionError: Access denied
```
**해결책:**
- 파일이 다른 프로그램에서 열려있지 않은지 확인
- 관리자 권한으로 실행
- 파일의 읽기/쓰기 권한 확인

### **🔍 로그 파일 확인하기**

문제가 발생하면 다음 파일들을 확인하세요:
```
📂 로그 파일들/
├── analysis.log          # main.py 실행 로그
├── full_processing.log   # 상세 처리 로그
└── analysis_output.log   # 출력 로그
```

---

## ❓ **자주 묻는 질문 (FAQ)**

### **Q1. 프로그램이 너무 오래 걸려요**
**A:** 정상입니다. 데이터 양에 따라 10분~1시간 정도 걸릴 수 있습니다.
- 3만개 이하: 10-20분
- 5만개 이하: 20-40분
- 10만개 이하: 40분-1시간

### **Q2. 대시보드가 제대로 안 보여요**
**A:** 다음을 확인해보세요:
1. 웹 브라우저가 최신 버전인지 확인
2. JavaScript가 활성화되어 있는지 확인
3. 인터넷 연결이 안정적인지 확인
4. 다른 브라우저에서 시도해보기

### **Q3. 새로운 데이터로 분석하려면?**
**A:** 
1. 새 엑셀 파일을 프로젝트 폴더에 복사
2. `dashboard_config.py`에서 `DATA_FILE` 변경
3. `main.py` 실행
4. 대시보드 생성

### **Q4. 결과를 다른 사람과 공유하려면?**
**A:**
- **HTML 파일**: 이메일로 전송 후 브라우저에서 열기
- **엑셀 파일**: 직접 공유 가능
- **스크린샷**: 대시보드를 캡처해서 공유

### **Q5. 에러가 나면 누구에게 연락해야 하나요?**
**A:**
1. 먼저 이 가이드의 문제 해결 섹션을 확인
2. 로그 파일을 확인하여 에러 메시지 파악
3. IT 담당자나 개발 담당자에게 연락
4. 에러 메시지와 로그 파일을 함께 제공

---

## 📞 **연락처 및 지원**

### **🆘 긴급 상황**
- 프로그램이 완전히 작동하지 않을 때
- 중요한 발표 전날에 문제가 생겼을 때

### **📋 일반 문의**
- 새로운 기능 요청
- 사용법 관련 질문
- 성능 개선 제안

---

## 📚 **부록: 용어 설명**

### **파일 형식**
- **`.py`**: 파이썬 프로그램 파일
- **`.xlsx`**: 엑셀 파일
- **`.html`**: 웹 페이지 파일
- **`.sh`**: 리눅스/맥 실행 스크립트
- **`.md`**: 마크다운 문서 파일

### **주요 용어**
- **AI 분석**: 인공지능을 이용한 자동 분석
- **감정 분석**: 텍스트에서 긍정/부정/중립 감정 파악
- **키워드 추출**: 중요한 단어들을 자동으로 찾아내는 기능
- **대시보드**: 데이터를 시각적으로 보여주는 웹 페이지
- **인터랙티브**: 사용자가 클릭하고 조작할 수 있는 기능

---

**🎉 이 가이드를 따라하시면 누구나 쉽게 협업평가 분석 시스템을 사용할 수 있습니다!**

**문제가 있으시면 언제든지 연락주세요! 📞**